//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  

//
// Precondition: 
// - Detailed description can be found from Quality Center's Project: CoreSW_CASW/Module Tests/SIM ATK TSY/SimAtkTSY_testtool
//
// Script description:

// Proactive command //
///////////////////////

// AlphaId (Optional)
// for user confirmation phase. Enter the text inside the quotes or as unicode hex digits.
// Example: AlphaId "abc" or AlphaId 61 62 63

// BearerList (Optional)
//	List of bearers in preference order. Following bearer can be used:
//		0	Use SMS.
//		1	Use a circuit switched connection.
//		2	Use USSD on GSM/WCDMA networks.
//		3	Use a packet switched connection.
// Example: Use CSD, if not available, use GPRS: BearerList 2 3

// BrowserId (Optional, default = 1)
//	Browser to use.
//		0	Initialisation value.
//		1	Object not present in the proactive command.
//		2	Default browser shall be used.
//		3	Object present but does not identified a known browser ID.
// Example: Use default browser: BrowserId 2

// BrowserSel (Optional, default = 1)
// 	How to launch the browser.
//		0	Command details do not specify the browser selection mode.
//		1	Launch browser if not already launched.
//		2	Use the existing browser (the browser shall not use the active existing secured session).
//		3	Close the existing browser session and launch new browser session.
// Example: Close existing and open new: BrowserSel 3

// IconId (Optional, default = IconId 0 0)
//  IconQualifier
//      0 NotSet
//      1 NoIconId
//      2 SelfExplanatory
//      3 NotSelfExplanatory
//  IconIdentifier
//      Id number
//  Example SelfExplanatory ID 5: IconId 2 5

// Text (Optional)
// Name/identity of the Gateway/Proxy. Enter the text inside the quotes or as unicode hex digits.
// Example: Text "abc" or Text 61 62 63

// Url (Optional)
// URL to display. Enter the text inside the quotes or as unicode hex digits.
// Example: Url "abc" or Url 61 62 63

// FileRef (Optional)
// List of provisioning file ids. Files listed aren't actually read from TSY, only the content is verified if provided.
// Enter the file ref ids in hexadecimal data.
// Example:  Prov. File Ref. 1: MF – DF_GSM – DF_Prov.data – EF_CSD3: FileRef 3F 00 7F 20 5F 20 4F 50


// Terminal Response //
///////////////////////

// GeneralResult
//  General result of the proactive command. Default command performed successfully.

// AdditionalInfo
//  Some error values of iGeneralResult require additional information,
//  which goes here. If iGeneralResult is LaunchBrowserError then
//	place a value from BrowserError in here.
        
// InfoType
//  Some error values for iGeneralResult (such as KLaunchBrowserError) require additional information, in which
//  case set iInfoType to MeProblem.


[Test]
title MOD_0023.001_SIM_ATK_TSY_[LAUNCH BROWSER - No session already launched]
create SimAtk simatk
create SimAtkNotify notify

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl
simatk Open SmsMessaging

// Load ISC XML -file
simatk LoadIscTests SimAtk_LaunchBrowser.xml

// Sequence 1.1 (LAUNCH BROWSER, connect to the default URL)
notify UseObjectAddress simatk ESatNotifyLaunchBrowserPCmd
simatk RunIscTestCase 23 101
waittestclass notify
simatk CheckProactiveCommand AlphaId "Default URL" Url ""
simatk SendTerminalResponse
simatk WaitForRequest

// Sequence 1.2 (LAUNCH BROWSER, connect to the specified URL, alpha identifier length=0)
notify UseObjectAddress simatk ESatNotifyLaunchBrowserPCmd
simatk RunIscTestCase 23 102
waittestclass notify
// Url: http://xxx.yyy.zzz
simatk CheckProactiveCommand AlphaId "" Url "http:\x2F\x2Fxxx.yyy.zzz"
simatk SendTerminalResponse
simatk WaitForRequest

// Sequence 1.3 (LAUNCH BROWSER, Browser identity, no alpha identifier)
notify UseObjectAddress simatk ESatNotifyLaunchBrowserPCmd
simatk RunIscTestCase 23 103
waittestclass notify
simatk CheckProactiveCommand Url "" BrowserId 2
simatk SendTerminalResponse
simatk WaitForRequest

// Sequence 1.4 (LAUNCH BROWSER, only GPRS bearer specified and gateway/proxy identity, GPRS supported by SS)
notify UseObjectAddress simatk ESatNotifyLaunchBrowserPCmd
simatk RunIscTestCase 23 104
waittestclass notify
simatk CheckProactiveCommand Url "" Text "abc.def.ghi" BearerList 3
simatk SendTerminalResponse
simatk WaitForRequest

// close all
simatk Close SmsMessaging
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete simatk
delete notify
[Endtest]

[Test]
title MOD_0023.002_SIM_ATK_TSY_[LAUNCH BROWSER - Interaction with current session]
create SimAtk simatk
create SimAtkNotify notify

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl
simatk Open SmsMessaging

// Load ISC XML -file
simatk LoadIscTests SimAtk_LaunchBrowser.xml

// Sequence 2.1 (LAUNCH BROWSER, use the existing browser, connect to the default URL)
notify UseObjectAddress simatk ESatNotifyLaunchBrowserPCmd
simatk RunIscTestCase 23 201
waittestclass notify
simatk CheckProactiveCommand AlphaId "Default URL" BrowserSel 2 Url ""
simatk SendTerminalResponse
simatk WaitForRequest

// Sequence 2.2 (LAUNCH BROWSER, close the existing browser session and launch new browser session, connect to the default URL)
notify UseObjectAddress simatk ESatNotifyLaunchBrowserPCmd
simatk RunIscTestCase 23 202
waittestclass notify
simatk CheckProactiveCommand AlphaId "Default URL" BrowserSel 3 Url ""
simatk SendTerminalResponse
simatk WaitForRequest

// Sequence 2.3 (LAUNCH BROWSER, if not already launched)
notify UseObjectAddress simatk ESatNotifyLaunchBrowserPCmd
simatk RunIscTestCase 23 203
waittestclass notify
simatk CheckProactiveCommand Url ""
simatk SendTerminalResponse GeneralResult LaunchBrowserError InfoType MeProblem AdditionalInfo BrowserUnavailable
simatk WaitForRequest

// close all
simatk Close SmsMessaging
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete simatk
delete notify
[Endtest]

[Test]
title MOD_0023.003_SIM_ATK_TSY_[LAUNCH BROWSER - UCS2 support]
create SimAtk simatk
create SimAtkNotify notify

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl
simatk Open SmsMessaging

// Load ISC XML -file
simatk LoadIscTests SimAtk_LaunchBrowser.xml

// Sequence 3.1 (LAUNCH BROWSER, use the existing browser, connect to the default URL)
notify UseObjectAddress simatk ESatNotifyLaunchBrowserPCmd
simatk RunIscTestCase 23 301
waittestclass notify
// AlphaId is "Hello" in Russian
simatk CheckProactiveCommand AlphaId 0417 0414 0420 0410 0412 0421 0422 0412 0423 0419 0422 0415 BrowserSel 2 Url ""
simatk SendTerminalResponse
simatk WaitForRequest

// close all
simatk Close SmsMessaging
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete simatk
delete notify
[Endtest]

[Test]
title MOD_0023.004_SIM_ATK_TSY_[LAUNCH BROWSER - icons support]
create SimAtk simatk
create SimAtkNotify notify

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl
simatk Open SmsMessaging

// Load ISC XML -file
simatk LoadIscTests SimAtk_LaunchBrowser.xml

// Sequence 4.1B (LAUNCH BROWSER, use the existing browser, icon not self explanatory, requested icon could not be displayed)
notify UseObjectAddress simatk ESatNotifyLaunchBrowserPCmd
simatk RunIscTestCase 23 401
waittestclass notify
simatk CheckProactiveCommand AlphaId "Not self explan." BrowserSel 2 Url "" IconId 3 1
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk WaitForRequest

// Sequence 4.2B (LAUNCH BROWSER, use the existing browser, icon self explanatory, requested icon could not be displayed)
notify UseObjectAddress simatk ESatNotifyLaunchBrowserPCmd
simatk RunIscTestCase 23 402
waittestclass notify
simatk CheckProactiveCommand AlphaId "Self explan." BrowserSel 2 Url "" IconId 2 1
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk WaitForRequest

// close all
simatk Close SmsMessaging
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete simatk
delete notify
[Endtest]