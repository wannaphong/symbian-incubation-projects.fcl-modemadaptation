<?xml version="1.0" encoding="utf-8"?> 

<!-- MOD_1013.001_SIM_ATK_TSY_[TLV validation - invalid simple tlv len] -->


<isc-test-control id="1013">


<!-- ******** -->
<!-- CHANNELS -->
<!-- ******** -->
<channels>
	<channel id="0x07"/>
</channels>


<!-- ****** -->
<!-- INPUTS -->
<!-- ****** -->
<inputs>

<!-- PROACTIVE COMMANDS -->
<!-- ****************** -->

    <input id="10001">
        <name>PROACTIVE COMMAND: DISPLAY TEXT 1.1.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,28,D0,24,81,03,01,21,80,82,80,81,02,8D,19,08,04,17,04,14,04,20,04,10,04,12,04,21,04,22,04,12,04,23,04,19,04,22,04,15,90,00</message>
    </input>
    
    <input id="10002">
        <name>PROACTIVE COMMAND: DISPLAY TEXT 1.2.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,28,D0,24,81,80,01,21,80,82,02,81,02,8D,19,08,04,17,04,14,04,20,04,10,04,12,04,21,04,22,04,12,04,23,04,19,04,22,04,15,90,00</message>
    </input>
    
    <input id="10003">
        <name>PROACTIVE COMMAND: DISPLAY TEXT 1.3.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,28,D0,24,81,03,01,21,80,82,02,81,02,8D,80,08,04,17,04,14,04,20,04,10,04,12,04,21,04,22,04,12,04,23,04,19,04,22,04,15,90,00</message>
    </input>
    
    <input id="10004">
        <name>PROACTIVE COMMAND: DISPLAY TEXT 1.4.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,28,D0,24,81,03,01,21,80,82,02,81,02,8D,20,08,04,17,04,14,04,20,04,10,04,12,04,21,04,22,04,12,04,23,04,19,04,22,04,15,90,00</message>
    </input>
    
    <input id="10005">
        <name>PROACTIVE COMMAND: DISPLAY TEXT 1.5.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,28,D0,24,81,05,01,21,80,82,04,81,02,8D,40,08,04,17,04,14,04,20,04,10,04,12,04,21,04,22,04,12,04,23,04,19,04,22,04,15,90,00</message>
    </input>
    
    <input id="10006">
        <name>PROACTIVE COMMAND: DISPLAY TEXT 1.6.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,29,D0,25,81,03,01,21,80,82,02,81,02,8D,81,7F,08,04,17,04,14,04,20,04,10,04,12,04,21,04,22,04,12,04,23,04,19,04,22,04,15,90,00</message>
    </input>
    
    <input id="10007">
        <name>PROACTIVE COMMAND: DISPLAY TEXT 1.7.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,29,D0,25,81,03,01,21,80,82,02,81,02,8D,81,80,08,04,17,04,14,04,20,04,10,04,12,04,21,04,22,04,12,04,23,04,19,04,22,04,15,90,00</message>
    </input>
    
    <input id="10008">
        <name>PROACTIVE COMMAND: DISPLAY TEXT 1.8.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,28,D0,24,81,03,01,21,80,82,02,81,02,8D,10,08,04,17,04,14,04,20,04,10,04,12,04,21,04,22,04,12,04,23,04,19,04,22,04,15,90,00</message>
    </input>
    
    <input id="10009">
        <name>PROACTIVE COMMAND: DISPLAY TEXT 1.9.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,20,D0,1C,81,04,01,23,00,AB,82,02,81,82,8D,0C,04,45,6E,74,65,72,20,31,32,33,34,35,91,02,05,05,90,00</message>
    </input>
    
    
<!-- SIM SESSION END -->
<!-- *************** -->
    <input id="90004">
        <name>ATK_SW_DATA_NTF: PROACTIVE SIM SESSION ENDED</name>
        <direction>sos</direction>
        <message>00,00,00,5A,00,00,78,34,00,13,00,00,90,00,00,00</message>
    </input>
    
</inputs>


<!-- ******* -->
<!-- OUTPUTS -->
<!-- ******* -->
<outputs>

<!-- TERMINAL RESPONSES -->
<!-- ****************** -->

    <output id="40001">
        <name>TERMINAL RESPONSE: DISPLAY TEXT 1.1.1</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,16,00,08,00,11,00,00,00,0C,81,03,01,21,80,82,02,82,81,83,01,32,00,00</message>
           <mask>00,00,00,FF,00,00,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,FF,FF</mask>
    </output>
    
    <output id="40002">
        <name>TERMINAL RESPONSE: DISPLAY TEXT 1.2.1</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,16,00,08,00,11,00,00,00,0C,00,00,00,00,00,82,02,82,81,83,01,32,00,00</message>
           <mask>00,00,00,FF,00,00,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,FF,FF</mask>
    </output>

</outputs>


<!-- ********** -->
<!-- TEST STEPS -->
<!-- ********** -->
<steps>


<!-- PROACTIVE COMMANDS -->
<!-- ****************** -->

    <step id="10001" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="10001"/>
    </step>
    
    <step id="10002" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="10002"/>
    </step>
    
    <step id="10003" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="10003"/>
    </step>
    
    <step id="10004" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="10004"/>
    </step>
    
    <step id="10005" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="10005"/>
    </step>
    
    <step id="10006" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="10006"/>
    </step>
    
    <step id="10007" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="10007"/>
    </step>
    
    <step id="10008" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="10008"/>
    </step>
    
    <step id="10009" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="10009"/>
    </step>

<!-- TERMINAL RESPONSES -->
<!-- ****************** -->

    <step id="40001" type="intercept">
        <name>Intercept TR</name>
        <channel id="0x07"/>
        <output-ref id="40001"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>
    
    <step id="40002" type="intercept">
        <name>Intercept TR</name>
        <channel id="0x07"/>
        <output-ref id="40002"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>

<!-- GENERAL STEPS -->
<!-- ************* -->

    <step id="90001" type="sync">
        <name>Sync with test env</name>
    </step>

    <step id="90002" type="open-channel">
        <name>Attach to channel 7</name>
        <channel id="0x07"/>
    </step>

    <step id="90003" type="close-channel">
        <name>Detach from channel 7</name>
        <channel id="0x07"/>
    </step>
    
    <step id="90004" type="simulate">
        <name>SIM session end</name>
        <channel id="0x07"/>
        <input-ref id="90004"/>
        <flags>0x40</flags>  <!-- Use stored transaction ID in simulated message -->
    </step>
    
</steps>


<!-- ********** -->
<!-- TEST CASES -->
<!-- ********** -->
<cases>

    <case id="101">
        <name>Sequence 1.1 (DISPLAY TEXT, invalid device identity len)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            <step-ref id="10001"/> <!-- Send PCMD -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="102">
        <name>Sequence 1.2 (DISPLAY TEXT, invalid command details len)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            <step-ref id="10002"/> <!-- Send PCMD -->
            <step-ref id="40002"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="103">
        <name>Sequence 1.3 (DISPLAY TEXT, invalid simple tlv len ( 1 byte))</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            <step-ref id="10003"/> <!-- Send PCMD -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="104">
        <name>Sequence 1.4 (DISPLAY TEXT, simple tlv lens doesn't match to the total proactive command len)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            <step-ref id="10004"/> <!-- Send PCMD -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="105">
        <name>Sequence 1.5 (DISPLAY TEXT, simple tlv lens doesn't match to the total proactive command len part2)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            <step-ref id="10005"/> <!-- Send PCMD -->
            <step-ref id="40002"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="106">
        <name>Sequence 1.6 (DISPLAY TEXT, invalid simple tlv len ( 2 byte))</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            <step-ref id="10006"/> <!-- Send PCMD -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="107">
        <name>Sequence 1.7 (DISPLAY TEXT, simple tlv lens doesn't match to the total proactive command len part3)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            <step-ref id="10007"/> <!-- Send PCMD -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="108">
        <name>Sequence 1.8 (DISPLAY TEXT, simple tlv lens doesn't match to the total proactive command len part4)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            <step-ref id="10008"/> <!-- Send PCMD -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
  
    <case id="109">
        <name>Sequence 1.9 (GET INPUT, Command details TLV has one extra byte)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            <step-ref id="10009"/> <!-- Send PCMD -->
            <step-ref id="40002"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>   

</cases>

</isc-test-control>