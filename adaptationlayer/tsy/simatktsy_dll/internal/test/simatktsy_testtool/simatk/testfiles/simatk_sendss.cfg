//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  

//
// Precondition: 
// - Detailed description can be found from Quality Center's Project: CoreSW_CASW/Module Tests/SIM ATK TSY/SimAtkTSY_testtool
//
// Script description:

// Proactive command //
///////////////////////

// AlphaId (Optional)
//  Enter the text inside the quotes or as unicode hex digits. Example: AlphaId "abc" or AlphaId 61 62 63

// Address
//  Enter the SS string inside the quotes
//  TypeOfNumber (Optional, default = 1, UnknownNumber)
//      0 TypeOfNumberNotSet, initialization value used within constructor(s).
//      1 UnknownNumber, the user or the network has no knowledge of the type of network.
//      2 InternationalNumber, international number.
//      3 NationalNumber, national number.
//      4 NetworkSpecificNumber, administration/service number specific to the serving network, 
//        e.g. used to access an operator.
//      5 DedicatedNumber, called dedicated access / short code in GSM/WCDMA. Corresponds to
//        TMobileTON::ESubscriberNumber in ETel MM API.
//      6 AlphanumericNumber, alphanumeric number.
//      7 EAbbreviatedNumber, abbreviated number. 
//  NumberingPlan (Optional, default = 1, UnknownNumberingPlan)
//      0 NumberingPlanNotSet, initialization value used within constructor(s).
//      1 UnknownNumberingPlan, the user or the network has no knowledge of the numbering plan.
//      2 IsdnNumberPlan, ISDN / telephony numbering plan.
//      3 DataNumberPlan, data numbering plan.
//      4 TelexNumberPlan, telex numbering plan.
//      5 ServiceCentreSpecificPlan1, The service centre specific plan is used to indicate a numbering
//        plan specific to External Short Message Entities attached to the SMS centre.
//      6 ServiceCentreSpecificPlan2, the service centre specific plan is used to indicate a numbering
//        plan specific to External Short Message Entities attached to the SMS centre.
//      7 NationalNumberPlan, national numbering plan.
//      8 PrivateNumberPlan, private numbering plan.
//      9 ERMESNumberPlan, ERMES numbering plan.   
// Example (String "*#31#", InternationalNumber, DataNumberPlan):
// Address "*#31#" 2 3

// IconId (Optional, default = IconId 0 0)
//  IconQualifier
//      0 NotSet
//      1 NoIconId
//      2 SelfExplanatory
//      3 NotSelfExplanatory
//  IconIdentifier
//      Id number
//  Example SelfExplanatory ID 5: IconId 2 5

// Terminal Response //
///////////////////////

// GeneralResult
//  General result of the proactive command. Default command performed successfully.

// GeneralResult2
//  General result of the proactive command. Default command performed successfully.

// AdditionalInfo
//  Enter the text inside the quotes or as unicode hex digits

// AdditionalInfo2
//  Enter the text inside the quotes or as unicode hex digits

// InfoType
// If the value of iGeneralResult requires additional information,
// set this to MeProblem (2).  Otherwise set to
// NoAdditionalInfo (1). Default no additional info.

// InfoType2
// If the value of iGeneralResult requires additional information,
// set this to MeProblem (2).  Otherwise set to
// NoAdditionalInfo (1). Default no additional info.

// UssdString
//  Enter the text inside the quotes or as unicode hex digits. Example: AlphaId "abc" or AlphaId 61 62 63


[Test]
title MOD_0012.001_SIM_ATK_TSY_[SEND SS - normal]

create SimAtk simatk
create SimAtkNotify notify

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl
simatk Open SmsMessaging

// Load ISC XML -file
simatk LoadIscTests SimAtk_SendSs.xml

// SEQ 1.1
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 101
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "**21*+01234567890123456789#" 2 2 AlphaId "Call Forward"
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse InfoType SendSsInfo AdditionalInfo 03 0A A0 1A 04 01 21 30 15 30 13 83 01 00 84 01 07 84 0B 91 10 32 54 76 98 10 32 54 76 98
simatk WaitForRequest

// SEQ 1.2
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 102
waittestclass notify
simatk CheckProactiveCommand Address "**21*+01234567890123456789#" 2 2 AlphaId "Call Forward"
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse GeneralResult SsReturnError InfoType SatNetworkErrorInfo AdditionalInfo 03 15
simatk WaitForRequest

// SEQ 1.3
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 103
waittestclass notify
simatk CheckProactiveCommand Address "**21*+01234567890123456789#" 2 2 AlphaId "Call Forward"
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse GeneralResult SsReturnError InfoType SatNetworkErrorInfo AdditionalInfo 03 00
simatk WaitForRequest

// SEQ 1.4
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 104
waittestclass notify
simatk CheckProactiveCommand Address "**21*+01234567890123456789012345678901234567*11#" 2 2 AlphaId "Call Forward"
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse InfoType SendSsInfo AdditionalInfo 03 0A A0 23 04 01 21 30 1E 30 1C 83 01 11 84 01 07 84 14 91 10 32 54 76 98 10 32 54 76 98 10 32 54 76 98 10 32 54 76
simatk WaitForRequest

// SEQ 1.5
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 105
waittestclass notify
// No address present in SS string (only service code), therefore TON/NPI set to Unknown/unknown (see 3GPP TS 22.030, 6.5.2 and ETSI TS 122 030)
simatk CheckProactiveCommand Address "*#31#" 0 0 AlphaId "Even if the Fixed Dialling Number service is enabled, the supplementary service control string included in the SEND SS proactive command shall not be checked against those of the FDN list. Upon receiving this command, the ME shall deci"
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse InfoType SendSsInfo AdditionalInfo 03 0E A4 06 04 01 06 0A 01 02
simatk WaitForRequest

// SEQ 1.6
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 106
waittestclass notify
simatk CheckProactiveCommand Address "**21*+01234567890123456789#" 2 2 AlphaId ""
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse InfoType SendSsInfo AdditionalInfo 03 0A A0 1A 04 01 21 30 15 30 13 83 01 00 84 01 07 84 0B 91 10 32 54 76 98 10 32 54 76 98
simatk WaitForRequest

// close all
simatk Close SmsMessaging
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete simatk
delete notify
[Endtest]

[Test]
title MOD_0012.002_SIM_ATK_TSY_[SEND SS - Icon support (sequence B)]

create SimAtk simatk
create SimAtkNotify notify

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl
simatk Open SmsMessaging

// Load ISC XML -file
simatk LoadIscTests SimAtk_SendSs.xml

// SEQ 2.1B
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 201
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "**21*+01234567890123456789*10#" 2 2 AlphaId "Basic Icon" IconId 2 1
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed InfoType SendSsInfo AdditionalInfo 03 0A A0 1A 04 01 21 30 15 30 13 83 01 00 84 01 07 89 0B 91 10 32 54 76 98 10 32 54 76 98
simatk WaitForRequest

// SEQ 2.2B
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 202
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "**21*+01234567890123456789*10#" 2 2 AlphaId "Colour Icon" IconId 2 2
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed InfoType SendSsInfo AdditionalInfo 03 0A A0 1A 04 01 21 30 15 30 13 83 01 00 84 01 07 89 0B 91 10 32 54 76 98 10 32 54 76 98
simatk WaitForRequest

// SEQ 2.3B
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 203
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "**21*+01234567890123456789*10#" 2 2 AlphaId "Basic Icon" IconId 3 1
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed InfoType SendSsInfo AdditionalInfo 03 0A A0 1A 04 01 21 30 15 30 13 83 01 00 84 01 07 89 0B 91 10 32 54 76 98 10 32 54 76 98
simatk WaitForRequest

// SEQ 2.4
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 204
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "**21*+01234567890123456789#" 2 2 IconId 3 1
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse GeneralResult CmdDataNotUnderstood
simatk WaitForRequest

// close all
simatk Close SmsMessaging
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete simatk
delete notify
[Endtest]

[Test]
title MOD_0012.003_SIM_ATK_TSY_[SEND SS - UCS2 support]

create SimAtk simatk
create SimAtkNotify notify

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl
simatk Open SmsMessaging

// Load ISC XML -file
simatk LoadIscTests SimAtk_SendSs.xml

// SEQ 3.1
notify UseObjectAddress simatk ESatNotifySendSsPCmd
simatk RunIscTestCase 12 301
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls, Alpha Id "Hello" in Russian
simatk CheckProactiveCommand Address "**21*+01234567890123456789*10#" 2 2 AlphaId 0417 0414 0420 0410 0412 0421 0422 0412 0423 0419 0422 0415
// First digit in Additional info is ISI operation, which is removed by SimAtkTsy.
simatk SendTerminalResponse InfoType SendSsInfo AdditionalInfo 03 0A A0 1A 04 01 21 30 15 30 13 83 01 00 84 01 07 84 0B 91 10 32 54 76 98 10 32 54 76 98
simatk WaitForRequest

// close all
simatk Close SmsMessaging
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete simatk
delete notify
[Endtest]
