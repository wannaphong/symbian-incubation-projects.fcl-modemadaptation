<?xml version="1.0" encoding="utf-8"?> 

<!-- MOD_0027.001_SIM_ATK_TSY_[SEND DATA] -->


<isc-test-control id="27">


<!-- ******** -->
<!-- CHANNELS -->
<!-- ******** -->
<channels>
	<channel id="0x07"/>
</channels>


<!-- ****** -->
<!-- INPUTS -->
<!-- ****** -->
<inputs>


<!-- PROACTIVE COMMANDS -->
<!-- ****************** -->

    <!-- USED BY: 27.22.4.30 -->
    <input id="10000">
        <name>PROACTIVE COMMAND: OPEN CHANNEL 1.1.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,46,D0,42,81,03,01,40,01,82,02,81,82,35,07,02,02,04,05,05,10,02,39,02,03,E8,47,0A,06,54,65,73,74,47,70,02,72,73,0D,08,F4,55,73,65,72,4C,6F,67,0D,08,F4,55,73,65,72,50,77,64,3C,03,01,AD,9C,3E,05,21,01,01,01,01,90,00</message>
    </input>

    <input id="10001">
        <name>PROACTIVE COMMAND: SEND DATA 1.1.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,17,D0,13,81,03,01,43,01,82,02,81,21,B6,08,00,01,02,03,04,05,06,07,90,00</message>
    </input>    

    <input id="10002">
        <name>PROACTIVE COMMAND: SEND DATA 1.2.1, 1.3.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,D9,D0,81,D4,81,03,01,43,00,82,02,81,21,B6,81,C8,00,01,02,03,04,05,06,07,08,09,0A,0B,0C,0D,0E,0F,10,11,12,13,14,15,16,17,18,19,1A,1B,1C,1D,1E,1F,20,21,22,23,24,25,26,27,28,29,2A,2B,2C,2D,2E,2F,30,31,32,33,34,35,36,37,38,39,3A,3B,3C,3D,3E,3F,40,41,42,43,44,45,46,47,48,49,4A,4B,4C,4D,4E,4F,50,51,52,53,54,55,56,57,58,59,5A,5B,5C,5D,5E,5F,60,61,62,63,64,65,66,67,68,69,6A,6B,6C,6D,6E,6F,70,71,72,73,74,75,76,77,78,79,7A,7B,7C,7D,7E,7F,80,81,82,83,84,85,86,87,88,89,8A,8B,8C,8D,8E,8F,90,91,92,93,94,95,96,97,98,99,9A,9B,9C,9D,9E,9F,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9,AA,AB,AC,AD,AE,AF,B0,B1,B2,B3,B4,B5,B6,B7,B8,B9,BA,BB,BC,BD,BE,BF,C0,C1,C2,C3,C4,C5,C6,C7,90,00</message>
    </input>

    <input id="10003">
        <name>PROACTIVE COMMAND: SEND DATA 1.2.2, 1.3.2</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,D9,D0,81,D4,81,03,01,43,00,82,02,81,21,B6,81,C8,C8,C9,CA,CB,CC,CD,CE,CF,D0,D1,D2,D3,D4,D5,D6,D7,D8,D9,DA,DB,DC,DD,DE,DF,E0,E1,E2,E3,E4,E5,E6,E7,E8,E9,EA,EB,EC,ED,EE,EF,F0,F1,F2,F3,F4,F5,F6,F7,F8,F9,FA,FB,FC,FD,FE,FF,00,01,02,03,04,05,06,07,08,09,0A,0B,0C,0D,0E,0F,10,11,12,13,14,15,16,17,18,19,1A,1B,1C,1D,1E,1F,20,21,22,23,24,25,26,27,28,29,2A,2B,2C,2D,2E,2F,30,31,32,33,34,35,36,37,38,39,3A,3B,3C,3D,3E,3F,40,41,42,43,44,45,46,47,48,49,4A,4B,4C,4D,4E,4F,50,51,52,53,54,55,56,57,58,59,5A,5B,5C,5D,5E,5F,60,61,62,63,64,65,66,67,68,69,6A,6B,6C,6D,6E,6F,70,71,72,73,74,75,76,77,78,79,7A,7B,7C,7D,7E,7F,80,81,82,83,84,85,86,87,88,89,8A,8B,8C,8D,8E,8F,90,00</message>
    </input>

    <input id="10004">
        <name>PROACTIVE COMMAND: SEND DATA 1.2.3</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,73,D0,6F,81,03,01,43,01,82,02,81,21,B6,64,90,91,92,93,94,95,96,97,98,99,9A,9B,9C,9D,9E,9F,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9,AA,AB,AC,AD,AE,AF,B0,B1,B2,B3,B4,B5,B6,B7,B8,B9,BA,BB,BC,BD,BE,BF,C0,C1,C2,C3,C4,C5,C6,C7,C8,C9,CA,CB,CC,CD,CE,CF,D0,D1,D2,D3,D4,D5,D6,D7,D8,D9,DA,DB,DC,DD,DE,DF,E0,E1,E2,E3,E4,E5,E6,E7,E8,E9,EA,EB,EC,ED,EE,EF,F0,F1,F2,F3,90,00</message>
    </input>

    <input id="10005">
        <name>PROACTIVE COMMAND: SEND DATA 1.3.3</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,D9,D0,81,D4,81,03,01,43,00,82,02,81,21,B6,81,C8,90,91,92,93,94,95,96,97,98,99,9A,9B,9C,9D,9E,9F,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9,AA,AB,AC,AD,AE,AF,B0,B1,B2,B3,B4,B5,B6,B7,B8,B9,BA,BB,BC,BD,BE,BF,C0,C1,C2,C3,C4,C5,C6,C7,C8,C9,CA,CB,CC,CD,CE,CF,D0,D1,D2,D3,D4,D5,D6,D7,D8,D9,DA,DB,DC,DD,DE,DF,E0,E1,E2,E3,E4,E5,E6,E7,E8,E9,EA,EB,EC,ED,EE,EF,F0,F1,F2,F3,F4,F5,F6,F7,F8,F9,FA,FB,FC,FD,FE,FF,00,01,02,03,04,05,06,07,08,09,0A,0B,0C,0D,0E,0F,10,11,12,13,14,15,16,17,18,19,1A,1B,1C,1D,1E,1F,20,21,22,23,24,25,26,27,28,29,2A,2B,2C,2D,2E,2F,30,31,32,33,34,35,36,37,38,39,3A,3B,3C,3D,3E,3F,40,41,42,43,44,45,46,47,48,49,4A,4B,4C,4D,4E,4F,50,51,52,53,54,55,56,57,90,00</message>
    </input>   

    <input id="10006">
        <name>PROACTIVE COMMAND: SEND DATA 1.3.4</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,D9,D0,81,D4,81,03,01,43,00,82,02,81,21,B6,81,C8,58,59,5A,5B,5C,5D,5E,5F,60,61,62,63,64,65,66,67,68,69,6A,6B,6C,6D,6E,6F,70,71,72,73,74,75,76,77,78,79,7A,7B,7C,7D,7E,7F,80,81,82,83,84,85,86,87,88,89,8A,8B,8C,8D,8E,8F,90,91,92,93,94,95,96,97,98,99,9A,9B,9C,9D,9E,9F,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9,AA,AB,AC,AD,AE,AF,B0,B1,B2,B3,B4,B5,B6,B7,B8,B9,BA,BB,BC,BD,BE,BF,C0,C1,C2,C3,C4,C5,C6,C7,C8,C9,CA,CB,CC,CD,CE,CF,D0,D1,D2,D3,D4,D5,D6,D7,D8,D9,DA,DB,DC,DD,DE,DF,E0,E1,E2,E3,E4,E5,E6,E7,E8,E9,EA,EB,EC,ED,EE,EF,F0,F1,F2,F3,F4,F5,F6,F7,F8,F9,FA,FB,FC,FD,FE,FF,00,01,02,03,04,05,06,07,08,09,0A,0B,0C,0D,0E,0F,10,11,12,13,14,15,16,17,18,19,1A,1B,1C,1D,1E,1F,90,00</message>
    </input>

    <input id="10007">
        <name>PROACTIVE COMMAND: SEND DATA 1.3.5</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,D9,D0,81,D4,81,03,01,43,01,82,02,81,21,B6,81,C8,20,21,22,23,24,25,26,27,28,29,2A,2B,2C,2D,2E,2F,30,31,32,33,34,35,36,37,38,39,3A,3B,3C,3D,3E,3F,40,41,42,43,44,45,46,47,48,49,4A,4B,4C,4D,4E,4F,50,51,52,53,54,55,56,57,58,59,5A,5B,5C,5D,5E,5F,60,61,62,63,64,65,66,67,68,69,6A,6B,6C,6D,6E,6F,70,71,72,73,74,75,76,77,78,79,7A,7B,7C,7D,7E,7F,80,81,82,83,84,85,86,87,88,89,8A,8B,8C,8D,8E,8F,90,91,92,93,94,95,96,97,98,99,9A,9B,9C,9D,9E,9F,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9,AA,AB,AC,AD,AE,AF,B0,B1,B2,B3,B4,B5,B6,B7,B8,B9,BA,BB,BC,BD,BE,BF,C0,C1,C2,C3,C4,C5,C6,C7,C8,C9,CA,CB,CC,CD,CE,CF,D0,D1,D2,D3,D4,D5,D6,D7,D8,D9,DA,DB,DC,DD,DE,DF,E0,E1,E2,E3,E4,E5,E6,E7,90,00</message>
    </input>  

    <input id="10008">
        <name>PROACTIVE COMMAND: SEND DATA 1.5.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,17,D0,13,81,03,01,43,01,82,02,81,22,B6,08,00,01,02,03,04,05,06,07,90,00</message>
    </input>
    
<!-- SIM SESSION END -->
<!-- *************** -->
    <input id="90004">
        <name>SIM Session End</name>
        <direction>sos</direction>
        <message>00,00,00,5A,00,00,78,34,00,13,00,00,90,00,00,00</message>
        <!-- Transaction Id's (9:th byte) must match with Terminal responses transaction id -->
    </input>

</inputs>


<!-- ******* -->
<!-- OUTPUTS -->
<!-- ******* -->
<outputs>
    
<!-- TERMINAL RESPONSES -->
<!-- ****************** -->

    <!-- USED BY: 27.22.4.30 -->
    <output id="40000">
        <name>TERMINAL RESPONSE: OPEN CHANNEL 1.1.1</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,26,00,08,00,11,00,00,00,1D,81,03,01,40,01,82,02,82,81,83,01,00,38,02,81,00,35,07,02,02,04,05,05,10,02,39,02,03,E8,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,7F,FF,FF,FF,7F,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,FF</mask>
    </output>
    
    <output id="40001">
        <name>TERMINAL RESPONSE: SEND DATA (Immediate mode)</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,1A,00,08,00,11,00,00,00,0F,81,03,01,43,01,82,02,82,81,83,01,00,B7,01,FF,00,00,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,7F,FF,FF,FF,FF,FF</mask>
    </output>   
    
    <output id="40002">
        <name>TERMINAL RESPONSE: SEND DATA (Store mode)</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,1A,00,08,00,11,00,00,00,0F,81,03,01,43,00,82,02,82,81,83,01,00,B7,01,FF,00,00,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,7F,FF,FF,FF,FF,FF</mask>
    </output>
    
    <output id="40003">
        <name>TERMINAL RESPONSE: SEND DATA (Store mode, 200 bytes available in send buffer)</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,1A,00,08,00,11,00,00,00,0F,81,03,01,43,00,82,02,82,81,83,01,00,B7,01,C8,00,00,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,7F,FF,FF,FF,FF,FF</mask>
    </output>
    
    <output id="40004">
        <name>TERMINAL RESPONSE: SEND DATA (Invalid channel number)</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,16,00,08,00,11,00,00,00,0D,81,03,01,43,01,82,02,82,81,83,02,3A,03,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,FF,FF</mask>
    </output>

</outputs>

<!-- ********** -->
<!-- TEST STEPS -->
<!-- ********** -->
<steps>


<!-- PROACTIVE COMMANDS -->
<!-- ****************** -->

<!-- USED BY: 27.22.4.30 -->
    <step id="10000" type="simulate">
        <name>PROACTIVE COMMAND: OPEN CHANNEL 1.1.1</name>
        <channel id="0x07"/>
        <input-ref id="10000"/>
    </step>

    <step id="10001" type="simulate">
        <name>PROACTIVE COMMAND: SEND DATA 1.1.1</name>
        <channel id="0x07"/>
        <input-ref id="10001"/>
    </step>

    <step id="10002" type="simulate">
        <name>PROACTIVE COMMAND: SEND DATA 1.2.1, 1.3.1</name>
        <channel id="0x07"/>
        <input-ref id="10002"/>
    </step>

    <step id="10003" type="simulate">
        <name>PROACTIVE COMMAND: SEND DATA 1.2.2, 1.3.2</name>
        <channel id="0x07"/>
        <input-ref id="10003"/>
    </step>

    <step id="10004" type="simulate">
        <name>PROACTIVE COMMAND: SEND DATA 1.2.3</name>
        <channel id="0x07"/>
        <input-ref id="10004"/>
    </step>    

    <step id="10005" type="simulate">
        <name>PROACTIVE COMMAND: SEND DATA 1.3.3</name>
        <channel id="0x07"/>
        <input-ref id="10005"/>
    </step>

    <step id="10006" type="simulate">
        <name>PROACTIVE COMMAND: SEND DATA 1.3.4</name>
        <channel id="0x07"/>
        <input-ref id="10006"/>
    </step>

    <step id="10007" type="simulate">
        <name>PROACTIVE COMMAND: SEND DATA 1.3.5</name>
        <channel id="0x07"/>
        <input-ref id="10007"/>
    </step>   

    <step id="10008" type="simulate">
        <name>PROACTIVE COMMAND: SEND DATA 1.5.1</name>
        <channel id="0x07"/>
        <input-ref id="10008"/>
    </step>
    
<!-- TERMINAL RESPONSES -->
<!-- ****************** -->

<!-- USED BY: 27.22.4.30 -->
    <step id="40000" type="intercept">
        <name>TERMINAL RESPONSE: OPEN CHANNEL  1.1.1</name>
        <channel id="0x07"/>
        <output-ref id="40000"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>

    <step id="40001" type="intercept">
        <name>TERMINAL RESPONSE: SEND DATA (Immediate mode)</name>
        <channel id="0x07"/>
        <output-ref id="40001"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>
     
    <step id="40002" type="intercept">
        <name>TERMINAL RESPONSE: SEND DATA (Store mode)</name>
        <channel id="0x07"/>
        <output-ref id="40002"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>
     
    <step id="40003" type="intercept">
        <name>TERMINAL RESPONSE: SEND DATA (Store mode, 200 bytes available in send buffer)</name>
        <channel id="0x07"/>
        <output-ref id="40003"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>
     
    <step id="40004" type="intercept">
        <name>TERMINAL RESPONSE: SEND DATA (Invalid channel number)</name>
        <channel id="0x07"/>
        <output-ref id="40004"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step> 
       
<!-- GENERAL STEPS -->
<!-- ************* -->

    <step id="90001" type="sync">
        <name>Sync with test env</name>
    </step>

    <step id="90002" type="open-channel">
        <name>Attach to channel 7</name>
        <channel id="0x07"/>
    </step>

    <step id="90003" type="close-channel">
        <name>Detach from channel 7</name>
        <channel id="0x07"/>
    </step>

    <step id="90004" type="simulate">
        <name>SIM session end</name>
        <channel id="0x07"/>
        <input-ref id="90004"/>
        <flags>0x40</flags>  <!-- Use stored transaction ID in simulated message -->        
    </step>

</steps>


<!-- ********** -->
<!-- TEST CASES -->
<!-- ********** -->
<cases>

<!-- 27.22.4.30	SEND DATA -->
    <case id="101">
        <name>Sequence 1.1 (SEND DATA, immediate mode)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10000"/> <!-- Send PCMD OPEN CHANNEL -->
            <step-ref id="40000"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90001"/> <!-- Synch -->
            
            <step-ref id="10001"/> <!-- Send PCMD SEND DATA -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
   
    <case id="102">
        <name>Sequence 1.2 (SEND DATA, Store mode)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10000"/> <!-- Send PCMD OPEN CHANNEL -->
            <step-ref id="40000"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90001"/> <!-- Synch -->
            
            <step-ref id="10002"/> <!-- Send PCMD SEND DATA -->
            <step-ref id="40002"/> <!-- Receive TR -->
            <step-ref id="90001"/> <!-- Synch -->
            
            <step-ref id="10003"/> <!-- Send PCMD SEND DATA -->
            <step-ref id="40002"/> <!-- Receive TR -->
            <step-ref id="90001"/> <!-- Synch -->
            
            <step-ref id="10004"/> <!-- Send PCMD SEND DATA -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->            
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
   
    <case id="103">
        <name>Sequence 1.3 (SEND DATA, Store mode, Tx buffer fully used)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10000"/> <!-- Send PCMD OPEN CHANNEL -->
            <step-ref id="40000"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90001"/> <!-- Synch -->
            
            <step-ref id="10002"/> <!-- Send PCMD SEND DATA -->
            <step-ref id="40002"/> <!-- Receive TR -->
            <step-ref id="90001"/> <!-- Synch -->
            
            <step-ref id="10003"/> <!-- Send PCMD SEND DATA -->
            <step-ref id="40002"/> <!-- Receive TR -->
            <step-ref id="90001"/> <!-- Synch -->
            
            <step-ref id="10005"/> <!-- Send PCMD SEND DATA -->
            <step-ref id="40002"/> <!-- Receive TR -->
            <step-ref id="90001"/> <!-- Synch -->
            
            <step-ref id="10006"/> <!-- Send PCMD SEND DATA -->
            <step-ref id="40003"/> <!-- Receive TR -->            
            <step-ref id="90001"/> <!-- Synch -->
            
            <step-ref id="10007"/> <!-- Send PCMD SEND DATA -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->            
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <!-- Sequence 1.4 (SEND DATA, 2 consecutive SEND DATA Store mode) -->
    <!-- Skipped. From SimAtkTsy point of view this sequence is similar to Seq3 if it's run twice in the row. -->
   
    <case id="105">
        <name>Sequence 1.5 (SEND DATA, immediate mode with a bad channel identifier)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10000"/> <!-- Send PCMD OPEN CHANNEL -->
            <step-ref id="40000"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90001"/> <!-- Synch -->
            
            <step-ref id="10008"/> <!-- Send PCMD SEND DATA -->
            <step-ref id="40004"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->            
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
</cases>

</isc-test-control>
