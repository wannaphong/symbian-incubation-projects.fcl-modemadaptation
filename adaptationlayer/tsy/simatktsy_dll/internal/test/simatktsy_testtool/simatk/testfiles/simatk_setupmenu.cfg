//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  
// Precondition: 
// - Detailed description can be found from Quality Center's Project: CoreSW_CASW/Module Tests/SIM ATK TSY/SimAtkTSY_testtool
//
// Script description:
//
// Proactive command //
///////////////////////

// AlphaId
//  Enter the text inside the quotes or as unicode hex digits. Example: AlphaId "abc" or AlphaId 61 62 63

// Help (Optional, default = Help 2)
//  0 EHelpNotSet, Initialization value used within constructor(s).
//  1 Help information available to the user.
//  2 No help information is available to the user.

// IconId (Optional, default = IconId 0 0)
//  IconQualifier
//      0 NotSet
//      1 NoIconId
//      2 SelfExplanatory
//      3 NotSelfExplanatory
//  IconIdentifier
//      Id number
//  Example SelfExplanatory ID 5: IconId 2 5

// IconListQualifier (Optional, default = NoIconId )
//  0 NotSet
//  1 NoIconId
//  2 SelfExplanatory
//  3 NotSelfExplanatory

// MenuContent (Optional, default = 1, KItems)
//  1 KItems, menu is made of items.
//  2 KItemNextActions, menu is made of items and item next actions.
//  4 KItemIconIds, Menu is made of items and item icon IDs.
// Note: These are flags. To indicate that the menu contains items, item next actions 
// and item icon ids, MenuContent would be 0x07.

// MenuItem
// Use one of following sequences for each menu item
//  MenuItem ItemString ItemId
// OR
//  MenuItem ItemString ItemId NextAction
// OR
//  MenuItem ItemString ItemId IconId
// OR
//  MenuItem ItemString ItemId NextAction IconId
// For example: MenuItem "Item 1" 0x01 MenuItem "Item 2" 0x02

// NumberOfItems
//  Number of items in menu

// Preference (Optional, default = NoSelectionPreference )
//  0 ESelectionPreferenceNotSet, Initialization value
//  1 ENoSelectionPreference, Use of soft keys is not required
//  2 ESoftKeyPreferred, Use soft keys where appropriate.

// RemoveMenu (Optional, default = False )
//  0 EFalse
//  1 ETrue
// Use this parameter if proactive command should remove the menu.
// If this parameter is used, all the all the other parameters are ignored.


// Terminal Response //
///////////////////////

// GeneralResult (Optional, default = Command performed successfully)
//  General result of the proactive command.

// AdditionalInfo (Optional, default = "" )
//  Enter the text inside the quotes or as unicode hex digits. Example: Text "abc" or Text 61 62 63

// InfoType (Optional, default = No Additional info)
//  If the value of iGeneralResult requires additional information, set this to MeProblem (2).
//  Otherwise set to NoAdditionalInfo (1).


// Envelope //
//////////////

// ItemId
//  Mandatory. Id of the selected item. For example: ItemId 1

// HelpRequest ( Optional, default = 2, EHelpNotRequested )
//  0 EHelpRequestNotSet, initialization value used within constructor(s).
//  1 EHelpRequested, the user/client has requested help.
//  2 EHelpNotRequested, The user/client has not requested help.

[Test]
title MOD_0009.001_SIM_ATK_TSY_[SET UP MENU and ENVELOPE MENU SELECTION - normal]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpMenu.xml


// SEQ 1.1
simatk RunIscTestCase 9 101

// First Set Up Menu
notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand AlphaId "Toolkit Menu" NumberOfItems 4 MenuItem "Item 1" 1 MenuItem "Item 2" 2 MenuItem "Item 3" 3 MenuItem "Item 4" 4
simatk SendTerminalResponse
simatk SendEnvelope ItemId 0x2

// Second Set Up Menu, REPLACE Old Menu
notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand AlphaId "Toolkit Menu" NumberOfItems 2 MenuItem "One" 11 MenuItem "Two" 12
simatk SendTerminalResponse
simatk SendEnvelope ItemId 0x12

// Third Set Up Menu, REMOVE Toolkit Menu
notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand RemoveMenu 1
simatk SendTerminalResponse

simatk WaitForRequest


// SEQ 1.2
simatk RunIscTestCase 9 102

// First Large Menu with many items

notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand AlphaId "LargeMenu1" NumberOfItems 30 MenuItem "Zero" 50 MenuItem "One" 4F MenuItem "Two" 4E MenuItem "Three" 4D MenuItem "Four" 4C MenuItem "Five" 4B MenuItem "Six" 4A MenuItem "Seven" 49 MenuItem "Eight" 48 MenuItem "Nine" 47 MenuItem "Alpha" 46 MenuItem "Bravo" 45 MenuItem "Charlie" 44 MenuItem "Delta" 43 MenuItem "Echo" 42 MenuItem "Fox-trot" 41 MenuItem "Black" 40 MenuItem "Brown" 3F MenuItem "Red" 3E MenuItem "Orange" 3D MenuItem "Yellow" 3C MenuItem "Green" 3B MenuItem "Blue" 3A MenuItem "Violet" 39 MenuItem "Grey" 38 MenuItem "White" 37 MenuItem "milli" 36 MenuItem "micro" 35 MenuItem "nano" 34 MenuItem "pico" 33
simatk SendTerminalResponse
simatk SendEnvelope ItemId 0x3D

notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand AlphaId "LargeMenu2" NumberOfItems 7 MenuItem "1 Call Forward Unconditional" FF MenuItem "2 Call Forward On User Busy" FE MenuItem "3 Call Forward On No Reply" FD MenuItem "4 Call Forward On User Not Reachable" FC MenuItem "5 Barring Of All Outgoing Calls" FB MenuItem "6 Barring Of All Outgoing Int Calls" FA MenuItem "7 CLI Presentation" F9 
simatk SendTerminalResponse
simatk SendEnvelope ItemId 0xFB

notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand NumberOfItems 1 MenuItem "Y" 1 AlphaId "The SIM shall supply a set of menu items, which shall be integrated with the menu system (or other MMI facility) in order to give the user the opportunity to choose one of these menu items at his own discretion. Each item comprises a sh"
simatk SendTerminalResponse
simatk SendEnvelope ItemId 0x1

simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0009.002_SIM_ATK_TSY_[SET UP MENU and ENVELOPE MENU SELECTION - help request support]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpMenu.xml


// SEQ 2.1
simatk RunIscTestCase 9 201

// First Set Up Menu
notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand Help 1 AlphaId "Toolkit Menu" NumberOfItems 4 MenuItem "Item 1" 1 MenuItem "Item 2" 2 MenuItem "Item 3" 3 MenuItem "Item 4" 4
simatk SendTerminalResponse
simatk SendEnvelope HelpRequest 1 ItemId 0x2

simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0009.003_SIM_ATK_TSY_[SET UP MENU and ENVELOPE MENU SELECTION - next action support]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpMenu.xml

// SEQ 3.1
simatk RunIscTestCase 9 301

// First Set Up Menu
notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
// Items & next actions
simatk CheckProactiveCommand MenuContent 3 AlphaId "Toolkit Menu" NumberOfItems 4 MenuItem "Item 1" 1 13 MenuItem "Item 2" 2 10 MenuItem "Item 3" 3 15 MenuItem "Item 4" 4 26
simatk SendTerminalResponse
simatk SendEnvelope ItemId 0x2

simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0009.004_SIM_ATK_TSY_[SET UP MENU and ENVELOPE MENU SELECTION - display of icons]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpMenu.xml

// SEQ 4.1a
simatk RunIscTestCase 9 4011

// First Set Up Menu
notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
// Items & icons
simatk CheckProactiveCommand MenuContent 5 AlphaId "Toolkit Menu" IconId 3 1 NumberOfItems 3 IconListQualifier 3 MenuItem "Item 1" 1 5 MenuItem "Item 2" 2 5 MenuItem "Item 3" 3 5
simatk SendTerminalResponse
simatk SendEnvelope ItemId 0x2

simatk WaitForRequest

// SEQ 4.1b
simatk RunIscTestCase 9 4012

// First Set Up Menu
notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
// Items & icons
simatk CheckProactiveCommand MenuContent 5 AlphaId "Toolkit Menu" IconId 3 1 NumberOfItems 3 IconListQualifier 3 MenuItem "Item 1" 1 5 MenuItem "Item 2" 2 5 MenuItem "Item 3" 3 5
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk SendEnvelope ItemId 0x2

simatk WaitForRequest

// SEQ 4.2a
simatk RunIscTestCase 9 4021

// First Set Up Menu
notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
// Items & icons
simatk CheckProactiveCommand MenuContent 5 AlphaId "Toolkit Menu" IconId 2 1 NumberOfItems 3 IconListQualifier 2 MenuItem "Item 1" 1 5 MenuItem "Item 2" 2 5 MenuItem "Item 3" 3 5
simatk SendTerminalResponse
simatk SendEnvelope ItemId 0x2

simatk WaitForRequest

// SEQ 4.2b
simatk RunIscTestCase 9 4022

// First Set Up Menu
notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
// Items & icons
simatk CheckProactiveCommand MenuContent 5 AlphaId "Toolkit Menu" IconId 2 1 NumberOfItems 3 IconListQualifier 2 MenuItem "Item 1" 1 5 MenuItem "Item 2" 2 5 MenuItem "Item 3" 3 5
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk SendEnvelope ItemId 0x2

simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0009.005_SIM_ATK_TSY_[SET UP MENU and ENVELOPE MENU SELECTION - soft keys support]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpMenu.xml

// SEQ 5.1
simatk RunIscTestCase 9 501

// First Set Up Menu
notify UseObjectAddress simatk ESatNotifySetUpMenuPCmd
simatk SyncIscTestCase
waittestclass notify
// Items & next actions
simatk CheckProactiveCommand Preference 2 AlphaId "Toolkit Menu" NumberOfItems 2 MenuItem "Item 1" 1 13 MenuItem "Item 2" 2 10
simatk SendTerminalResponse
simatk SendEnvelope ItemId 0x2

simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]
