//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  

// Proactive command //
///////////////////////

// Address
//  Enter the address string inside the quotes
//  TypeOfNumber (Optional, default = 1, UnknownNumber)
//      0 TypeOfNumberNotSet, initialization value used within constructor(s).
//      1 UnknownNumber, the user or the network has no knowledge of the type of network.
//      2 InternationalNumber, international number.
//      3 NationalNumber, national number.
//      4 NetworkSpecificNumber, administration/service number specific to the serving network, 
//        e.g. used to access an operator.
//      5 DedicatedNumber, called dedicated access / short code in GSM/WCDMA. Corresponds to
//        TMobileTON::ESubscriberNumber in ETel MM API.
//      6 AlphanumericNumber, alphanumeric number.
//      7 EAbbreviatedNumber, abbreviated number. 
//  NumberingPlan (Optional, default = 1, UnknownNumberingPlan)
//      0 NumberingPlanNotSet, initialization value used within constructor(s).
//      1 UnknownNumberingPlan, the user or the network has no knowledge of the numbering plan.
//      2 IsdnNumberPlan, ISDN / telephony numbering plan.
//      3 DataNumberPlan, data numbering plan.
//      4 TelexNumberPlan, telex numbering plan.
//      5 ServiceCentreSpecificPlan1, The service centre specific plan is used to indicate a numbering
//        plan specific to External Short Message Entities attached to the SMS centre.
//      6 ServiceCentreSpecificPlan2, the service centre specific plan is used to indicate a numbering
//        plan specific to External Short Message Entities attached to the SMS centre.
//      7 NationalNumberPlan, national numbering plan.
//      8 PrivateNumberPlan, private numbering plan.
//      9 ERMESNumberPlan, ERMES numbering plan.   
// Example (String "+012340123456p1p2", InternationalNumber, IsdnNumberPlan):
// Address "+012340123456p1p2" 2 2

// AlphaId (Optional)
//  AlphaId used in confirmation phase. Enter the text inside the quotes or as unicode hex digits.
//  Example: AlphaId "abc" or AlphaId 61 62 63

// AlphaIdCallSetUpPhase (Optional)
//  Enter the text inside the quotes or as unicode hex digits.
// Example: AlphaIdCallSetUpPhase "abc" or AlphaIdCallSetUpPhase 61 62 63

// CapabilityConfigParams (Optional)
//  Enter the parameters as hex digits.
//  Example: CapabilityConfigParams 61 62 63

// Duration (Optional, default = "No duration has been provided" )
//  TimeUnit, unit used to encode the duration
//      0 TimeUnitNotSet. Initialization value used within constructor(s).
//      1 No duration has been provided. The ME should default to general beep.
//      2 The duration is expressed in minutes.
//      3 The duration is expressed in seconds.
//      4 The duration is expressed in tenths of seconds.
//  NumOfUnits
//     Valid range is 1 to 255
//  Example 10 minutes: Duration 2 10

// IconId (Optional, default = IconId 0 0)
// IconId used in confirmation phase. 
//  IconQualifier
//      0 NotSet
//      1 NoIconId
//      2 SelfExplanatory
//      3 NotSelfExplanatory
//  IconIdentifier
//      Id number
//  Example SelfExplanatory ID 5: IconId 2 5

// IconIdCallSetUpPhase (Optional, default = IconIdCallSetUpPhase 0 0)
//  IconQualifier
//      0 NotSet
//      1 NoIconId
//      2 SelfExplanatory
//      3 NotSelfExplanatory
//  IconIdentifier
//      Id number
//  Example SelfExplanatory ID 5: IconIdCallSetUpPhase 2 5

// SubAddress (Optional)
//  Enter the subaddress inside the quotes or as unicode hex digits.
// Example: SubAddress "abc" or SubAddress 61 62 63

// Type (Optional, default = OnlyIfNotBusy)
//  0 SetUpCallTypeNotSet, value used in constructor.
//  1 OnlyIfNotBusy, only make the call if line is not busy.
//  2 OnlyIfNotBusyWithRedial, only make the call if line is not busy.
//    Redial if call cannot be made the first time.
//  3 HoldOtherCalls, put other calls on hold then make the call.
//  4 HoldOtherCallsWithRedial, put other calls on hold then make the call.
//    Redial if call cannot be made the first time.
//  5 DisconnectOtherCalls, disconnect other calls then make the call.
//  6 DisconnectOtherCallsWithRedial, disconnect other calls then make the call.
//    Redial if call cannot be made the first time.

// Terminal Response //
///////////////////////

// GeneralResult
//  General result of the proactive command. Default command performed successfully.

// GeneralResult2
//  General result of the proactive command. Default command performed successfully.

// AdditionalInfo
//  Enter the text inside the quotes or as unicode hex digits

// AdditionalInfo2
//  Enter the text inside the quotes or as unicode hex digits

// InfoType
// If the value of iGeneralResult requires additional information,
// set this to MeProblem (2).  Otherwise set to
// NoAdditionalInfo (1). Default no additional info.

// InfoType2
// If the value of iGeneralResult requires additional information,
// set this to MeProblem (2).  Otherwise set to
// NoAdditionalInfo (1). Default no additional info.

// UssdString
//  Enter the text inside the quotes or as unicode hex digits. Example: UssdString "abc" or UssdString 61 62 63


[Test]
title MOD_0014.001_SIM_ATK_TSY_[SET UP CALL - normal]

create SimAtk simatk
create SimAtkNotify notify

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl

// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpCall.xml

// SEQ 1.1
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 101
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 AlphaId "Not busy"
simatk SendTerminalResponse
simatk WaitForRequest


// SEQ 1.2
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 102
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 AlphaId "Not busy"
simatk SendTerminalResponse GeneralResult PCmdNotAcceptedByUser
simatk WaitForRequest

// SEQ 1.3
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 103
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 Type 2 AlphaId "Not busy with redial"
// AdditionalInfo contains Cause information element returned by the network
simatk SendTerminalResponse GeneralResult NetworkUnableToProcessCmd InfoType SatNetworkErrorInfo AdditionalInfo 91
simatk WaitForRequest

// SEQ 1.4
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 104
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 Type 3 AlphaId "On hold"
simatk SendTerminalResponse
simatk WaitForRequest

// SEQ 1.5
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 105
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 Type 5 AlphaId "Disconnect"
simatk SendTerminalResponse
simatk WaitForRequest

// SEQ 1.6
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 106
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 AlphaId "Not busy"
simatk SendTerminalResponse GeneralResult MeUnableToProcessCmd InfoType MeProblem AdditionalInfo MeBusyOnCall
simatk WaitForRequest

// SEQ 1.7
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 107
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 Type 3 AlphaId "On hold"
simatk SendTerminalResponse GeneralResult NetworkUnableToProcessCmd InfoType MeProblem AdditionalInfo NoSpecificMeProblem
simatk WaitForRequest

// SEQ 1.8
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 108
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 AlphaId "Capability config" CapabilityConfigParams 01 A0
simatk SendTerminalResponse
simatk WaitForRequest

// SEQ 1.9
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 109
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012345678901234567890123456789*#*#*#*#*#012345678901234567890123456789*#*#*#*#*#" 2 2 Type 2
simatk SendTerminalResponse
simatk WaitForRequest

// SEQ 1.10
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 110
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+01" 2 2 Type 2 AlphaId "Three types are defined: - set up a call, but only if not currently busy on another call; - set up a call, putting all other calls (if any) on hold; - set up a call, disconnecting all other calls (if any) first. For each of these types, "
simatk SendTerminalResponse
simatk WaitForRequest

// SEQ 1.11B
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 111
allownextresult -20
waittestclass notify
simatk WaitForRequest

// SEQ 1.12
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 112
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 Type 2 AlphaId "Duration" Duration 3 10
simatk SendTerminalResponse GeneralResult NetworkUnableToProcessCmd InfoType SatNetworkErrorInfo AdditionalInfo 91
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete simatk
delete notify
[Endtest]

[Test]
title MOD_0014.002_SIM_ATK_TSY_[SET UP CALL - second alpha identifier]

create SimAtk simatk
create SimAtkNotify notify

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl

// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpCall.xml

// SEQ 2.1
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 201
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 AlphaId "CONFIRMATION" AlphaIdCallSetUpPhase "CALL"
simatk SendTerminalResponse
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete simatk
delete notify
[Endtest]

[Test]
title MOD_0014.003_SIM_ATK_TSY_[SET UP CALL - display of icons (Sequence B)]

create SimAtk simatk
create SimAtkNotify notify

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl

// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpCall.xml

// SEQ 3.1B
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 301
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 AlphaId "Set up call Icon 3.1.1" IconId 3 1
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk WaitForRequest

// SEQ 3.2B
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 302
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 AlphaId "Set up call Icon 3.2.1" IconId 2 1
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk WaitForRequest

// SEQ 3.3B
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 303
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 AlphaId "Set up call Icon 3.3.1" IconId 3 2
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk WaitForRequest

// SEQ 3.4B
notify UseObjectAddress simatk ESatNotifySetUpCallPCmd
simatk RunIscTestCase 14 304
waittestclass notify
// SimAtkTsy adds '+'-sign to international calls
simatk CheckProactiveCommand Address "+012340123456p1p2" 2 2 AlphaId "Set up call Icon 3.4.1" IconId 2 1 AlphaIdCallSetUpPhase "Set up call Icon 3.4.2" IconIdCallSetUpPhase 2 1
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete simatk
delete notify
[Endtest]
