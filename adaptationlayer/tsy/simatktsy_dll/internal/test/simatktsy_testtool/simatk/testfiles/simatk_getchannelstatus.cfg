//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  

//
// Precondition: 
// - Detailed description can be found from Quality Center's Project: CoreSW_CASW/Module Tests/SIM ATK TSY/SimAtkTSY_testtool
//
// Script description (note: Open Channel and Setup Event List command's are used during the testing. Script descriptions
// for both commands can be found from corresponding config files):

// Proactive command //
///////////////////////

// No parameters

// Terminal Response //
///////////////////////

// GeneralResult (Optional, default = Success )
//  General result of the proactive command. Default command performed successfully.

// AdditionalInfo (Optional, default = "")
//  Additional information
        
// InfoType (Optional, default = NoAdditionalInfo )
//  Additional Info type

[Test]
title MOD_0028.001_SIM_ATK_TSY_[GET CHANNEL STATUS]

create SimAtk simatk
create SimAtkNotify channelStatus
create SimAtkNotify openChannel
create SimAtkNotify eventList

// open all
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl

// Load ISC XML -file
simatk LoadIscTests SimAtk_GetChannelStatus.xml

// Sequence 1.1 (GET STATUS, without any BIP channel opened)
//
channelStatus UseObjectAddress simatk ESatNotifyGetChannelStatusPCmd
simatk RunIscTestCase 28 101
waittestclass channelStatus
simatk CheckProactiveCommand
simatk SendTerminalResponse AdditionalInfo 0 0 InfoType ChannelStatusInfo
simatk WaitForRequest

// Sequence 1.2 (GET STATUS, with a BIP channel currently opened)
//
openChannel UseObjectAddress simatk ESatNotifyOpenChannelPCmd
channelStatus UseObjectAddress simatk ESatNotifyGetChannelStatusPCmd
simatk RunIscTestCase 28 102

waittestclass openChannel
simatk CheckProactiveCommand CommandType ESatNotifyOpenChannelPCmd Bearer 2 BearerParams 02 04 05 05 10 02 BufferSize 1000 AccessName "\x06TestGp\x02rs" UserLogin "UserLog" UserPassword "UserPwd" SimMeInterface 2 44444 DestinationAddress "01.01.01.01"
simatk SendTerminalResponse CommandType ESatNotifyOpenChannelPCmd BearerParams 00 04 05 05 10 02 BufferSize 1000 AdditionalInfo 81 0 InfoType ChannelStatusInfo

simatk SyncIscTestCase
waittestclass channelStatus
simatk CheckProactiveCommand CommandType  ESatNotifyGetChannelStatusPCmd
simatk SendTerminalResponse CommandType ESatNotifyGetChannelStatusPCmd AdditionalInfo 81 0 InfoType ChannelStatusInfo

simatk WaitForRequest

// Sequence 1.3 (GET STATUS, after a link dropped)
//
eventList UseObjectAddress simatk ESatNotifySetUpEventListPCmd
openChannel UseObjectAddress simatk ESatNotifyOpenChannelPCmd
channelStatus UseObjectAddress simatk ESatNotifyGetChannelStatusPCmd
simatk RunIscTestCase 28 103

waittestclass eventList
// Channel status
simatk CheckProactiveCommand CommandType ESatNotifySetUpEventListPCmd Events 0x400
simatk SendTerminalResponse CommandType ESatNotifySetUpEventListPCmd SessionEnd 0

waittestclass openChannel
simatk CheckProactiveCommand CommandType ESatNotifyOpenChannelPCmd Bearer 2 BearerParams 02 04 05 05 10 02 BufferSize 1000 AccessName "\x06TestGp\x02rs" UserLogin "UserLog" UserPassword "UserPwd" SimMeInterface 2 44444 DestinationAddress "01.01.01.01"
simatk SendTerminalResponse CommandType ESatNotifyOpenChannelPCmd BearerParams 00 04 05 05 10 02 BufferSize 1000 AdditionalInfo 81 0 InfoType ChannelStatusInfo

simatk SyncIscTestCase

// EVENT DOWNLOAD - Data available 1.1.1
// Channel 1, link dropped
simatk SendEnvelope CommandType ESatNotifySetUpEventListPCmd Events 0x400 ChannelStatus 01 05 SessionEnd 0

waittestclass channelStatus
simatk CheckProactiveCommand CommandType  ESatNotifyGetChannelStatusPCmd
simatk SendTerminalResponse CommandType ESatNotifyGetChannelStatusPCmd AdditionalInfo 0 0 InfoType ChannelStatusInfo

simatk WaitForRequest
// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete channelStatus
delete openChannel
delete eventList
delete simatk
[Endtest]
