<?xml version="1.0" encoding="utf-8"?> 

<!-- MOD_0028.001_SIM_ATK_TSY_[GET CHANNEL STATUS] -->


<isc-test-control id="28">


<!-- ******** -->
<!-- CHANNELS -->
<!-- ******** -->
<channels>
	<channel id="0x07"/>
</channels>


<!-- ****** -->
<!-- INPUTS -->
<!-- ****** -->
<inputs>


<!-- PROACTIVE COMMANDS -->
<!-- ****************** -->

    <input id="00001">
        <name>PROACTIVE COMMAND: OPEN CHANNEL 1.1.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,46,D0,42,81,03,01,40,01,82,02,81,82,35,07,02,02,04,05,05,10,02,39,02,03,E8,47,0A,06,54,65,73,74,47,70,02,72,73,0D,08,F4,55,73,65,72,4C,6F,67,0D,08,F4,55,73,65,72,50,77,64,3C,03,01,AD,9C,3E,05,21,01,01,01,01,90,00</message>
    </input>

    <input id="00003">
        <name>PROACTIVE COMMAND: SET UP EVENT LIST 1.1.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,10,D0,0C,81,03,01,05,00,82,02,81,82,99,01,0A,90,00</message>
    </input>
    
    <input id="10001">
        <name>PROACTIVE COMMAND: GET STATUS 1.1.1, 1.2.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,0D,D0,09,81,03,01,44,00,82,02,81,82,90,00</message>
    </input>
    
<!-- SIM SESSION END -->
<!-- *************** -->
    <input id="90004">
        <name>SIM Session End</name>
        <direction>sos</direction>
        <message>00,00,00,5A,00,00,78,34,00,13,00,00,90,00,00,00</message>
        <!-- Transaction Id's (9:th byte) must match with Terminal responses transaction id -->
    </input>

</inputs>


<!-- ******* -->
<!-- OUTPUTS -->
<!-- ******* -->
<outputs>
    
<!-- TERMINAL RESPONSES -->
<!-- ****************** -->

    <output id="00002">
        <name>TERMINAL RESPONSE: OPEN CHANNEL 1.1.1B</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,26,00,08,00,11,00,00,00,1D,81,03,01,40,01,82,02,82,81,83,01,00,38,02,81,00,35,07,02,00,04,05,05,10,02,39,02,03,E8,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,7F,FF,FF,FF,7F,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,FF</mask>
    </output>

    <output id="00004">
        <name>TERMINAL RESPONSE: SET UP EVENT LIST 1.1.1</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,16,00,08,00,11,00,00,00,0C,81,03,01,05,00,82,02,82,81,83,01,00,00,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,FF,FF</mask>
    </output>

    <output id="40001">
        <name>TERMINAL RESPONSE: GET STATUS 1.1.1B</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,1A,00,08,00,11,00,00,00,10,81,03,01,44,00,82,02,82,81,83,01,00,B8,02,00,00,00,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,7F,FF,FF,FF,FF,FF</mask>
    </output>

    <output id="40002">
        <name>TERMINAL RESPONSE: GET STATUS 1.2.1A</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,1A,00,08,00,11,00,00,00,10,81,03,01,44,00,82,02,82,81,83,01,00,B8,02,81,00,00,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,7F,FF,FF,FF,FF,FF</mask>
    </output>
    
<!-- ENVELOPES -->
<!-- ********* -->

    <output id="60001">
        <name>ENVELOPE EVENT DOWNLOAD: CHANNEL STATUS 1.3.1</name>
        <direction>dos</direction>
        <message>00,00,00,5A,00,16,00,00,C5,12,00,0D,D6,0B,99,01,0A,82,02,82,81,B8,02,01,05,00,00,00</message>
           <mask>00,00,00,FF,00,FF,00,00,00,FF,FF,FF,FF,FF,7F,FF,FF,7F,FF,FF,FF,7F,FF,FF,FF,FF,FF,FF</mask>
    </output>    
 
</outputs>

<!-- ********** -->
<!-- TEST STEPS -->
<!-- ********** -->
<steps>


<!-- PROACTIVE COMMANDS -->
<!-- ****************** -->

    <step id="00001" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="00001"/>
    </step>

    <step id="00003" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="00003"/>
    </step>

    <step id="10001" type="simulate">
        <name>Send PCMD</name>
        <channel id="0x07"/>
        <input-ref id="10001"/>
    </step>
    
<!-- TERMINAL RESPONSES -->
<!-- ****************** -->

    <step id="00002" type="intercept">
        <name>Intercept TR</name>
        <channel id="0x07"/>
        <output-ref id="00002"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>

    <step id="00004" type="intercept">
        <name>Intercept TR</name>
        <channel id="0x07"/>
        <output-ref id="00004"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>

    <step id="40001" type="intercept">
        <name>Intercept TR</name>
        <channel id="0x07"/>
        <output-ref id="40001"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>

    <step id="40002" type="intercept">
        <name>Intercept TR</name>
        <channel id="0x07"/>
        <output-ref id="40002"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>

<!-- ENVELOPES -->
<!-- ********* -->

    <step id="60001" type="intercept">
        <name>Intercept envelope</name>
        <channel id="0x07"/>
        <output-ref id="60001"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>
    
<!-- GENERAL STEPS -->
<!-- ************* -->

    <step id="90001" type="sync">
        <name>Sync with test env</name>
    </step>

    <step id="90002" type="open-channel">
        <name>Attach to channel 7</name>
        <channel id="0x07"/>
    </step>

    <step id="90003" type="close-channel">
        <name>Detach from channel 7</name>
        <channel id="0x07"/>
    </step>

    <step id="90004" type="simulate">
        <name>SIM session end</name>
        <channel id="0x07"/>
        <input-ref id="90004"/>
        <flags>0x40</flags>  <!-- Use stored transaction ID in simulated message -->        
    </step>

</steps>


<!-- ********** -->
<!-- TEST CASES -->
<!-- ********** -->
<cases>

<!-- 27.22.4.31	GET CHANNEL STATUS -->
    <case id="101">
        <name>Sequence 1.1 (GET STATUS, without any BIP channel opened)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            <step-ref id="10001"/> <!-- Send PCMD -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>

    <case id="102">
        <name>Sequence 1.2 (GET STATUS, with a BIP channel currently opened)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->

            <step-ref id="00001"/> <!-- Send OPEN CHANNEL PCMD -->
            <step-ref id="00002"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90001"/> <!-- Synch --> 
            
            <step-ref id="10001"/> <!-- Send PCMD -->
            <step-ref id="40002"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>

    <case id="103">
        <name>Sequence 1.3 (GET STATUS, after a link dropped)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->

            <step-ref id="00003"/> <!-- Send SET UP EVENT LIST PCMD -->
            <step-ref id="00004"/> <!-- Receive TR -->

            <step-ref id="00001"/> <!-- Send OPEN CHANNEL PCMD -->
            <step-ref id="00002"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90001"/> <!-- Synch test case -->

            <step-ref id="60001"/> <!-- Receive ENVELOPE -->
            
            <step-ref id="10001"/> <!-- Send GET CHANNEL STATUS PCMD -->
            <step-ref id="40001"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>

</cases>

</isc-test-control>
