<?xml version="1.0" encoding="utf-8"?> 

<!-- MOD_0021.001_SIM_ATK_TSY_[SEND DTMF - Normal] -->
<!-- MOD_0021.002_SIM_ATK_TSY_[SEND DTMF - Display of icons] -->
<!-- MOD_0021.003_SIM_ATK_TSY_[SEND DTMF - UCS2 support] -->


<isc-test-control id="21">


<!-- ******** -->
<!-- CHANNELS -->
<!-- ******** -->
<channels>
	<channel id="0x07"/>
</channels>


<!-- ****** -->
<!-- INPUTS -->
<!-- ****** -->
<inputs>


<!-- PROACTIVE COMMANDS -->
<!-- ****************** -->

    <input id="10101">
        <name>PROACTIVE COMMAND: SEND DTMF 1.1.1, 1.4.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,11,D0,0D,81,03,01,14,00,82,02,81,83,AC,02,C1,F2,90,00</message>
    </input>

    <input id="10102">
        <name>PROACTIVE COMMAND: SEND DTMF 1.2.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,1F,D0,1B,81,03,01,14,00,82,02,81,83,85,09,53,65,6E,64,20,44,54,4D,46,AC,05,21,43,65,87,09,90,00</message>
    </input>

    <input id="10103">
        <name>PROACTIVE COMMAND: SEND DTMF 1.3.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,17,D0,13,81,03,01,14,00,82,02,81,83,85,00,AC,06,C1,CC,CC,CC,CC,2C,90,00</message>
    </input>

    <input id="10201">
        <name>PROACTIVE COMMAND: SEND DTMF 2.1.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,21,D0,1D,81,03,01,14,00,82,02,81,83,85,0A,42,61,73,69,63,20,49,63,6F,6E,AC,02,C1,F2,9E,02,00,01,90,00</message>
    </input>

    <input id="10202">
        <name>PROACTIVE COMMAND: SEND DTMF 2.2.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,22,D0,1E,81,03,01,14,00,82,02,81,83,85,0B,43,6F,6C,6F,75,72,20,49,63,6F,6E,AC,02,C1,F2,9E,02,00,02,90,00</message>
    </input> 

    <input id="10203">
        <name>PROACTIVE COMMAND: SEND DTMF 2.3.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,20,D0,1C,81,03,01,14,00,82,02,81,83,85,09,53,65,6E,64,20,44,54,4D,46,AC,02,C1,F2,9E,02,01,01,90,00</message>
    </input>

    <input id="10301">
        <name>PROACTIVE COMMAND: SEND DTMF 3.1.1</name>
        <direction>sos</direction>
        <message>15,28,00,5A,00,00,08,00,00,10,00,55,00,2C,D0,28,81,03,01,14,00,82,02,81,83,85,19,80,04,17,04,14,04,20,04,10,04,12,04,21,04,22,04,12,04,23,04,19,04,22,04,15,AC,02,C1,F2,90,00</message>
    </input>
                
<!-- SIM SESSION END -->
<!-- *************** -->
    <input id="90004">
        <name>SIM Session End</name>
        <direction>sos</direction>
        <message>00,00,00,5A,00,00,78,34,00,13,00,00,90,00,00,00</message>
        <!-- Transaction Id's (9:th byte) must match with Terminal responses transaction id -->
    </input>

</inputs>


<!-- ******* -->
<!-- OUTPUTS -->
<!-- ******* -->
<outputs>
    
<!-- TERMINAL RESPONSES -->
<!-- ****************** -->

    <output id="40101">
        <name>TERMINAL RESPONSE: SEND DTMF 1.1.1, 1.2.1, 1.3.1, 2.1.1A, 2.2.1A, 2.3.1A, 3.1.1</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,16,00,08,00,11,00,00,00,0C,81,03,01,14,00,82,02,82,81,83,01,00,00,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,FF,FF</mask>
    </output>

    <output id="40104">
        <name>TERMINAL RESPONSE: SEND DTMF 1.4.1</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,16,00,08,00,11,00,00,00,0D,81,03,01,14,00,82,02,82,81,83,02,20,07,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,FF,FF</mask>
    </output>

    <output id="40201">
        <name>TERMINAL RESPONSE: SEND DTMF 2.1.1B, 2.2.1B, 2.3.1B</name>
        <direction>dos</direction>
        <message>1D,00,10,5A,00,16,00,08,00,11,00,00,00,0C,81,03,01,14,00,82,02,82,81,83,01,04,00,00</message>
           <mask>00,00,00,FF,00,FF,00,00,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,7F,FF,FF,FF,7F,FF,FF,FF,FF</mask>
    </output>
    
</outputs>

<!-- ********** -->
<!-- TEST STEPS -->
<!-- ********** -->
<steps>


<!-- PROACTIVE COMMANDS -->
<!-- ****************** -->

    <step id="10101" type="simulate">
        <name>PROACTIVE COMMAND: SEND DTMF 1.1.1, 1.4.1</name>
        <channel id="0x07"/>
        <input-ref id="10101"/>
    </step>
 
    <step id="10102" type="simulate">
        <name>PROACTIVE COMMAND: SEND DTMF 1.2.1</name>
        <channel id="0x07"/>
        <input-ref id="10102"/>
    </step>
 
    <step id="10103" type="simulate">
        <name>PROACTIVE COMMAND: SEND DTMF 1.3.1</name>
        <channel id="0x07"/>
        <input-ref id="10103"/>
    </step>

    <step id="10201" type="simulate">
        <name>PROACTIVE COMMAND: SEND DTMF 2.1.1</name>
        <channel id="0x07"/>
        <input-ref id="10201"/>
    </step>

    <step id="10202" type="simulate">
        <name>PROACTIVE COMMAND: SEND DTMF 2.2.1</name>
        <channel id="0x07"/>
        <input-ref id="10202"/>
    </step>

    <step id="10203" type="simulate">
        <name>PROACTIVE COMMAND: SEND DTMF 2.3.1</name>
        <channel id="0x07"/>
        <input-ref id="10203"/>
    </step>

    <step id="10301" type="simulate">
        <name>PROACTIVE COMMAND: SEND DTMF 3.1.1</name>
        <channel id="0x07"/>
        <input-ref id="10301"/>
    </step>
    
<!-- TERMINAL RESPONSES -->
<!-- ****************** -->

    <step id="40101" type="intercept">
        <name>TERMINAL RESPONSE: SEND DTMF 1.1.1, 1.2.1, 1.3.1, 2.1.1A, 2.2.1A, 2.3.1A, 3.1.1</name>
        <channel id="0x07"/>
        <output-ref id="40101"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>

    <step id="40104" type="intercept">
        <name>TERMINAL RESPONSE: SEND DTMF 1.4.1</name>
        <channel id="0x07"/>
        <output-ref id="40104"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>

    <step id="40201" type="intercept">
        <name>TERMINAL RESPONSE: SEND DTMF 2.1.1B, 2.2.1B, 2.3.1B</name>
        <channel id="0x07"/>
        <output-ref id="40201"/>
        <flags>0x40</flags>  <!-- Store transaction ID from intercepted message -->
    </step>
           
<!-- GENERAL STEPS -->
<!-- ************* -->

    <step id="90001" type="sync">
        <name>Sync with test env</name>
    </step>

    <step id="90002" type="open-channel">
        <name>Attach to channel 7</name>
        <channel id="0x07"/>
    </step>

    <step id="90003" type="close-channel">
        <name>Detach from channel 7</name>
        <channel id="0x07"/>
    </step>

    <step id="90004" type="simulate">
        <name>SIM session end</name>
        <channel id="0x07"/>
        <input-ref id="90004"/>
        <flags>0x40</flags>  <!-- Use stored transaction ID in simulated message -->        
    </step>

</steps>


<!-- ********** -->
<!-- TEST CASES -->
<!-- ********** -->
<cases>

<!-- 27.22.4.24.1   SEND DTMF (Normal) -->

    <case id="101">
        <name>Sequence 1.1 (SEND DTMF, normal)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10101"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40101"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="102">
        <name>Sequence 1.2 (SEND DTMF, containing alpha identifier)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10102"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40101"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="103">
        <name>Sequence 1.3 (SEND DTMF, containing alpha identifier with null data object)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10103"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40101"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="104">
        <name>Sequence 1.4 (SEND DTMF, mobile is not in a speech call)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10101"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40104"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
<!-- 27.22.4.24.2	SEND DTMF (Display of icons) -->
    
    <case id="2011">
        <name>Sequence 2.1A (SEND DTMF, BASIC ICON self explanatory, successful)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10201"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40101"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="2012">
        <name>Sequence 2.1B (SEND DTMF, BASIC ICON self explanatory, requested icon could not be displayed)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10201"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40201"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="2021">
        <name>Sequence 2.2A (SEND DTMF, COLOUR-ICON self explanatory, successful)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10202"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40101"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="2022">
        <name>Sequence 2.2B (SEND DTMF, COLOUR-ICON self explanatory, requested icon could not be displayed)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10202"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40201"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
    <case id="2031">
        <name>Sequence 2.3A (SEND DTMF, Alpha identifier and BASIC-ICON, not self-explanatory, successful)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10203"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40101"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>

    <case id="2032">
        <name>Sequence 2.3B (SEND DTMF, Alpha identifier and BASIC-ICON, not self-explanatory, requested icon could not be displayed)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10203"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40201"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
<!-- 27.22.4.24.3	SEND DTMF (UCS2 support) -->

    <case id="301">
        <name>Sequence 3.1 (SEND DTMF, successful, UCS2 text)</name>
        <timeout>10</timeout>
        <test-steps>
            <step-ref id="90002"/> <!-- Attach to channel 7 -->
            
            <step-ref id="10301"/> <!-- Send PCMD SEND DTMF -->
            <step-ref id="40101"/> <!-- Receive TR -->
            <step-ref id="90004"/> <!-- SimSessionEnd -->
            
            <step-ref id="90003"/> <!-- Detach from channel 7 -->
        </test-steps>
    </case>
    
</cases>

</isc-test-control>
