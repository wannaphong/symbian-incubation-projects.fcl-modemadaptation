//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  

//
// Precondition: 
// - Detailed description can be found from Quality Center's Project: CoreSW_CASW/Module Tests/SIM ATK TSY/SimAtkTSY_testtool
//
// Script description:
//
// Proactive command //
///////////////////////

// Text
//  Enter the text inside the quotes or as unicode hex digits. Example: Text "abc" or Text 61 62 63

// CodingScheme (default 2, 16bit UCS2)
//  Specifies whether the text is 7-bit packed, 7-bit unpacked (i.e. 8-bit) or UCS-2 16-bit
//		0 7bit Packed
//		1 7bit Unpacked
//		2 16bit UCS2

// Type (default 1, UpdateIdleModeText)
//  This determines the type of the command
//		0 SetUpIdleModeTextTypeNotSet, Initialization value
//		1 UpdateIdleModeText
//		2 RemoveExistingIdleModeText

// IconId
//  IconQualifier
//      0 NotSet
//      1 NoIconId
//      2 SelfExplanatory
//      3 NotSelfExplanatory
//  IconIdentifier
//      Id number
//  Example SelfExplanatory ID 5: IconId 2 5
        
// Terminal Response //
///////////////////////

// GeneralResult
//  General result of the proactive command. Default command performed successfully.

// AdditionalInfo
//  Contains additional information associated with certain error codes set in GeneralResult. 
//  If the value in iGeneralResult does not require any information then leave this field empty (default).

// InfoType
//  If the value of GeneralResult requires additional information, set this to MeProblem.  Otherwise set to
//  NoAdditionalInfo (default)

[Test]
title MOD_0020.001_SIM_ATK_TSY_[SET UP IDLE MODE TEXT - normal]

create SimAtk simatk
create SimAtkNotify notify
create SimAtkNotify notify2
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl

// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpIdleModeText.xml


// SEQ 1.1
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 101
waittestclass notify
simatk CheckProactiveCommand Text "Idle Mode Text"
simatk SendTerminalResponse
simatk WaitForRequest


// SEQ 1.2
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 102
waittestclass notify
simatk CheckProactiveCommand Text "Idle Mode Text"
simatk SendTerminalResponse

notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand Text "Toolkit Test"
simatk SendTerminalResponse
simatk WaitForRequest


// SEQ 1.3
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 103
waittestclass notify
simatk CheckProactiveCommand Text "Idle Mode Text"
simatk SendTerminalResponse

notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand Type 2
simatk SendTerminalResponse
simatk WaitForRequest


// SEQ 1.4
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 104
waittestclass notify
simatk CheckProactiveCommand CommandType ESatNotifySetUpIdleModeTextPCmd Text "Idle Mode Text"
simatk SendTerminalResponse CommandType ESatNotifySetUpIdleModeTextPCmd

notify UseObjectAddress simatk DisplayText
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand CommandType ESatNotifyDisplayTextPCmd Text "Toolkit Test 1"
simatk SendTerminalResponse CommandType ESatNotifyDisplayTextPCmd SessionEnd 0

notify UseObjectAddress simatk PlayTone
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand CommandType PlayTone Tone 1 AlphaId "Dial Tone" Duration 3 5
simatk SendTerminalResponse CommandType PlayTone

simatk WaitForRequest


// SEQ 1.5
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 105
waittestclass notify
simatk CheckProactiveCommand Text "Idle Mode Text"
simatk SendTerminalResponse
// Simulate power off by shutting down and reopening the SAT
simatk Close SAT
simatk Close DefaultPhone
simatk Open DefaultPhone
simatk Open SAT
simatk SyncIscTestCase
simatk WaitForRequest


// SEQ 1.6
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 106
waittestclass notify
simatk CheckProactiveCommand Text "Idle Mode Text"
simatk SendTerminalResponse

notify UseObjectAddress simatk ESatNotifyRefreshRequiredParam
notify2 UseObjectAddress simatk ESatNotifyRefreshPCmd
simatk SyncIscTestCase
waittestclass notify // RefreshRequiredParam
simatk CheckProactiveCommand CommandType ESatNotifyRefreshRequiredParam RefreshType 4
simatk SendTerminalResponse CommandType ESatNotifyRefreshRequiredParam
waittestclass notify2 // Refresh
simatk SendTerminalResponse CommandType ESatNotifyRefreshPCmd
simatk WaitForRequest


// SEQ 1.7
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 107
waittestclass notify
simatk CheckProactiveCommand Text "The SIM shall supply a text string, which shall be displayed by the ME as an idle mode text if the ME is able to do it.The presentation style is left as an implementation decision to the ME manufacturer. The idle mode text shall be displayed in a manner that ensures that ne"
simatk SendTerminalResponse
simatk WaitForRequest


// close all
simatk Close IscControl
simatk Close SAT
simatk Close DefaultPhone
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete notify2
delete simatk
[Endtest]



[Test]
title MOD_0020.002_SIM_ATK_TSY_[SET UP IDLE MODE TEXT - icon support]

create SimAtk simatk
create SimAtkNotify notify
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl

// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpIdleModeText.xml


// SEQ 2.1a
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 2011
waittestclass notify
simatk CheckProactiveCommand Text "Idle text" IconId 2 1
simatk SendTerminalResponse
simatk WaitForRequest

// SEQ 2.1b
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 2012
waittestclass notify
simatk CheckProactiveCommand Text "Idle text" IconId 2 1
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk WaitForRequest

// SEQ 2.2a
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 2021
waittestclass notify
simatk CheckProactiveCommand Text "Idle text" IconId 3 1
simatk SendTerminalResponse
simatk WaitForRequest

// SEQ 2.2b
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 2022
waittestclass notify
simatk CheckProactiveCommand Text "Idle text" IconId 3 1
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk WaitForRequest

// SEQ 2.3a
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 2031
waittestclass notify
simatk CheckProactiveCommand Text "Idle text" IconId 2 2
simatk SendTerminalResponse
simatk WaitForRequest

// SEQ 2.3b
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 2032
waittestclass notify
simatk CheckProactiveCommand Text "Idle text" IconId 2 2
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed
simatk WaitForRequest

// SEQ 2.4
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 204
waittestclass notify
// Type is remove text, might be cause problem if intention is to update icon only idle mode text.
simatk CheckProactiveCommand Type 2 Text "" IconId 3 1
simatk SendTerminalResponse GeneralResult CmdDataNotUnderstood
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Close DefaultPhone
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]



[Test]
title MOD_0020.003_SIM_ATK_TSY_[SET UP IDLE MODE TEXT - UCS2 support]

create SimAtk simatk
create SimAtkNotify notify
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open IscControl

// Load ISC XML -file
simatk LoadIscTests SimAtk_SetUpIdleModeText.xml


// SEQ 3.1
notify UseObjectAddress simatk ESatNotifySetUpIdleModeTextPCmd
simatk RunIscTestCase 20 301
waittestclass notify
// Hello in Russian
simatk CheckProactiveCommand Text 0417 0414 0420 0410 0412 0421 0422 0412 0423 0419 0422 0415
simatk SendTerminalResponse
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Close DefaultPhone
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]
