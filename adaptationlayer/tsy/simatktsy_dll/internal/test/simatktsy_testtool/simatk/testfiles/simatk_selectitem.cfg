//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  

//
// Precondition: 
// - Detailed description can be found from Quality Center's Project: CoreSW_CASW/Module Tests/SIM ATK TSY/SimAtkTSY_testtool
//
// Script description:

// Proactive command //
///////////////////////

// AlphaId
//  Enter the text inside the quotes or as unicode hex digits. Example: AlphaId "abc" or AlphaId 61 62 63

// DefaultItemId (Optional)
//  ID of the default menu item. Example: DefaultItemId FF

// Help (Optional, default = Help 2)
//  0 EHelpNotSet, Initialization value used within constructor(s).
//  1 Help information available to the user.
//  2 No help information is available to the user.

// IconId (Optional, default = IconId 0 0)
//  IconQualifier
//      0 NotSet
//      1 NoIconId
//      2 SelfExplanatory
//      3 NotSelfExplanatory
//  IconIdentifier
//      Id number
//  Example SelfExplanatory ID 5: IconId 2 5

// IconListQualifier (Optional, default = NoIconId )
//  0 NotSet
//  1 NoIconId
//  2 SelfExplanatory
//  3 NotSelfExplanatory

// MenuContent (Optional, default = 1, KItems)
//  1 KItems, menu is made of items.
//  2 KItemNextActions, menu is made of items and item next actions.
//  4 KItemIconIds, Menu is made of items and item icon IDs.
// Note: These are flags. To indicate that the menu contains items, item next actions 
// and item icon ids, MenuContent would be 0x07.

// MenuItem
// Use one of following sequences for each menu item
//  MenuItem ItemString ItemId
// OR
//  MenuItem ItemString ItemId NextAction
// OR
//  MenuItem ItemString ItemId IconId
// OR
//  MenuItem ItemString ItemId NextAction IconId
// For example: MenuItem "Item 1" 1 MenuItem "Item 2" 2

// NumberOfItems
//  Number of items in menu

// Preference (Optional, default = 1, NoSelectionPreference )
//  0 ESelectionPreferenceNotSet, Initialization value
//  1 ENoSelectionPreference, Use of soft keys is not required
//  2 ESoftKeyPreferred, Use soft keys where appropriate.

// PresentationType (Optional, default = 1, ENotSpecified)
//  0 EPresentationTypeNotSet, value used in constructor.
//  1 ENotSpecified, menu content type not specified
//  2 EDataValues, the menu contains a choice of data values
//  3 ENavigationOptions, the menu contains a choice of navigation options

// RemoveMenu (Optional, default = False )
//  0 EFalse
//  1 ETrue
// Use this parameter if proactive command should remove the menu.
// If this parameter is used, all the all the other parameters are ignored.


// Terminal Response //
///////////////////////

// GeneralResult (Optional, default = Command performed successfully)
//  General result of the proactive command.

// AdditionalInfo (Optional, default = "" )
//  Enter the text inside the quotes or as unicode hex digits. Example: Text "abc" or Text 61 62 63

// InfoType (Optional, default = No Additional info)
//  Set to ItemIdentifier (40) when returning the user's choice. Some error values of
//  GeneralResult require additional information, in  which case set this to MeProblem (2).
//  Otherwise set to NoAdditionalInfo (1)


[Test]
title MOD_0010.001_SIM_ATK_TSY_[SELECT ITEM - mandatory features for ME supporting SELECT ITEM]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SelectItem.xml


// SEQ 1.1
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 101
waittestclass notify
simatk CheckProactiveCommand AlphaId "Toolkit Select" NumberOfItems 4 MenuItem "Item 1" 1 MenuItem "Item 2" 2 MenuItem "Item 3" 3 MenuItem "Item 4" 4
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo 2
simatk WaitForRequest

// SEQ 1.2
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 102
waittestclass notify
simatk CheckProactiveCommand AlphaId "LargeMenu1" NumberOfItems 30 MenuItem "Zero" 50 MenuItem "One" 4F MenuItem "Two" 4E MenuItem "Three" 4D MenuItem "Four" 4C MenuItem "Five" 4B MenuItem "Six" 4A MenuItem "Seven" 49 MenuItem "Eight" 48 MenuItem "Nine" 47 MenuItem "Alpha" 46 MenuItem "Bravo" 45 MenuItem "Charlie" 44 MenuItem "Delta" 43 MenuItem "Echo" 42 MenuItem "Fox-trot" 41 MenuItem "Black" 40 MenuItem "Brown" 3F MenuItem "Red" 3E MenuItem "Orange" 3D MenuItem "Yellow" 3C MenuItem "Green" 3B MenuItem "Blue" 3A MenuItem "Violet" 39 MenuItem "Grey" 38 MenuItem "White" 37 MenuItem "milli" 36 MenuItem "micro" 35 MenuItem "nano" 34 MenuItem "pico" 33
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo 3D
simatk WaitForRequest

// SEQ 1.3
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 103
waittestclass notify
simatk CheckProactiveCommand AlphaId "LargeMenu2" NumberOfItems 7 MenuItem "Call Forwarding Unconditional" FF MenuItem "Call Forwarding On User Busy" FE MenuItem "Call Forwarding On No Reply" FD MenuItem "Call Forwarding On User Not Reachable" FC MenuItem "Barring Of All Outgoing Calls" FB MenuItem "Barring Of All Outgoing International Calls" FA MenuItem "CLI Presentation" F9
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo FB
simatk WaitForRequest

// SEQ 1.4
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 104
waittestclass notify
simatk CheckProactiveCommand AlphaId "Select Item" NumberOfItems 2 MenuItem "One" 11 MenuItem "Two" 12
simatk SendTerminalResponse GeneralResult BackwardModeRequestedByUser

notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk SyncIscTestCase
waittestclass notify
simatk CheckProactiveCommand AlphaId "Select Item" NumberOfItems 2 MenuItem "One" 11 MenuItem "Two" 12
simatk SendTerminalResponse GeneralResult SessionTerminatedByUser
simatk WaitForRequest

// SEQ 1.5
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 105
waittestclass notify
simatk CheckProactiveCommand NumberOfItems 1 MenuItem "Y" 1 AlphaId "The SIM shall supply a set of items from which the user may choose one. Each item comprises a short identifier (used to indicate the selection) and a text string. Optionally the SIM may include an alpha identifier. The alpha identifier i"
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo 1
simatk WaitForRequest

// SEQ 1.6
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 106
waittestclass notify
simatk CheckProactiveCommand AlphaId "0LargeMenu" NumberOfItems 7 MenuItem "1 Call Forward Unconditional" FF MenuItem "2 Call Forward On User Busy" FE MenuItem "3 Call Forward On No Reply" FD MenuItem "4 Call Forward On User Not Reachable" FC MenuItem "5 Barring Of All Outgoing Calls" FB MenuItem "6 Barring Of All Outgoing Int Calls" FA MenuItem "7 CLI Presentation" F9
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo FB
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0010.002_SIM_ATK_TSY_[SELECT ITEM - next action support]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SelectItem.xml

// SEQ 2.1
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 201
waittestclass notify
// menu contains items and next actions
simatk CheckProactiveCommand AlphaId "Toolkit Select" MenuContent 3 NumberOfItems 3 MenuItem "Item 1" 1 13 MenuItem "Item 2" 2 10 MenuItem "Item 3" 3 26
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo 2
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0010.003_SIM_ATK_TSY_[SELECT ITEM - default item support]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SelectItem.xml

// SEQ 3.1
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 301
waittestclass notify
// menu contains items and next actions
simatk CheckProactiveCommand DefaultItemId 2 AlphaId "Toolkit Select" NumberOfItems 3 MenuItem "Item 1" 1 MenuItem "Item 2" 2 MenuItem "Item 3" 3
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo 3
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0010.004_SIM_ATK_TSY_[SELECT ITEM - help request support]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SelectItem.xml

// SEQ 4.1
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 401
waittestclass notify
simatk CheckProactiveCommand Help 1 AlphaId "Toolkit Select" NumberOfItems 3 MenuItem "Item 1" 1 MenuItem "Item 2" 2 MenuItem "Item 3" 3
simatk SendTerminalResponse GeneralResult HelpRequestedByUser InfoType ItemIdentifier AdditionalInfo 1
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0010.005_SIM_ATK_TSY_[SELECT ITEM - icons support]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SelectItem.xml

// SEQ 5.1a
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 5011
waittestclass notify
// menu contains items and icons
simatk CheckProactiveCommand IconId 3 1 MenuContent 5 IconListQualifier 3 AlphaId "Toolkit Select" NumberOfItems 3 MenuItem "Item 1" 1 5 MenuItem "Item 2" 2 5 MenuItem "Item 3" 3 5
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo 1
simatk WaitForRequest

// SEQ 5.1b
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 5012
waittestclass notify
// menu contains items and icons
simatk CheckProactiveCommand IconId 3 1 MenuContent 5 IconListQualifier 3 AlphaId "Toolkit Select" NumberOfItems 3 MenuItem "Item 1" 1 5 MenuItem "Item 2" 2 5 MenuItem "Item 3" 3 5
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed InfoType ItemIdentifier AdditionalInfo 1
simatk WaitForRequest

// SEQ 5.2a
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 5021
waittestclass notify
// menu contains items and icons
simatk CheckProactiveCommand IconId 2 1 MenuContent 5 IconListQualifier 2 AlphaId "Toolkit Select" NumberOfItems 3 MenuItem "Item 1" 1 5 MenuItem "Item 2" 2 5 MenuItem "Item 3" 3 5
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo 1
simatk WaitForRequest

// SEQ 5.2b
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 5022
waittestclass notify
// menu contains items and icons
simatk CheckProactiveCommand IconId 2 1 MenuContent 5 IconListQualifier 2 AlphaId "Toolkit Select" NumberOfItems 3 MenuItem "Item 1" 1 5 MenuItem "Item 2" 2 5 MenuItem "Item 3" 3 5
simatk SendTerminalResponse GeneralResult SuccessRequestedIconNotDisplayed InfoType ItemIdentifier AdditionalInfo 1
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0010.006_SIM_ATK_TSY_[SELECT ITEM - presentation style]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SelectItem.xml

// SEQ 6.1
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 601
waittestclass notify
simatk CheckProactiveCommand PresentationType 3 AlphaId "Toolkit Select" NumberOfItems 3 MenuItem "Item 1" 1 MenuItem "Item 2" 2 MenuItem "Item 3" 3
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo 1
simatk WaitForRequest

// SEQ 6.2
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 602
waittestclass notify
simatk CheckProactiveCommand PresentationType 2 AlphaId "Toolkit Select" NumberOfItems 3 MenuItem "Item 1" 1 MenuItem "Item 2" 2 MenuItem "Item 3" 3
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo 1
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0010.007_SIM_ATK_TSY_[SELECT ITEM - soft keys support]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SelectItem.xml

// SEQ 7.1
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 701
waittestclass notify
simatk CheckProactiveCommand Preference 2 AlphaId "Toolkit Select" NumberOfItems 2 MenuItem "Item 1" 1 MenuItem "Item 2" 2
simatk SendTerminalResponse InfoType ItemIdentifier AdditionalInfo 1
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]

[Test]
title MOD_0010.008_SIM_ATK_TSY_[SELECT ITEM - support of no response from user)]

create SimAtk simatk
create SimAtkNotify notify

// connecting to ETel server
simatk Connect RTelServer
// Load TSY module
simatk Load PhoneTsy.tsy
// open phone module
simatk Open DefaultPhone
// Open SAT API
simatk Open SAT

// Open ISC Test control
simatk Open IscControl
// Load ISC XML -file
simatk LoadIscTests SimAtk_SelectItem.xml

// SEQ 8.1
notify UseObjectAddress simatk ESatNotifySelectItemPCmd
simatk RunIscTestCase 10 801
waittestclass notify
simatk CheckProactiveCommand AlphaId "<TIME-OUT>" NumberOfItems 3 MenuItem "Item 1" 1 MenuItem "Item 2" 2 MenuItem "Item 3" 3
simatk SendTerminalResponse GeneralResult NoResponseFromUser
simatk WaitForRequest

// close all
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notify
delete simatk
[Endtest]
