//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  

//
// Precondition: 
// - Detailed description can be found from Quality Center's Project: CoreSW_CASW/Module Tests/SIM ATK TSY/SimAtkTSY_testtool
//
// Script description:
//

// Following design descisions of SIM_ATK_TSY are followed when these test cases 
// were created:
// - NotifyMoSmControlRequest is only completed when SIM provides an AlphaID
// - In out of network coverage situtaution SMS sending is allowed without 
//   asking from SIM.

// MO SMS Control Result //
///////////////

// ControlResult
//  0 EControlResultNotSet, Initialization value used within constructor(s)
//  1 EAllowedNoModification
//  2 ENotAllowed
//  3 EAllowedWithModifications

// AlphaId
//  Enter the text inside the quotes or as unicode hex digits. Example: Text "abc" or Text 61 62 63

[Test]
title MOD_0033.001_SIM_ATK_TSY_[MO SHORT MESSAGE CONTROL BY SIM]

create SimAtk simatk
create SimAtkNotify notifySendSm

// Open ETel and related services
simatk Connect RTelServer
simatk Load PhoneTsy.tsy
simatk Open DefaultPhone
simatk Open SAT
simatk Open SmsMessaging

// For ISI-message simulation and analysis
simatk Open IscControl
simatk LoadIscTests SimAtk_MoSmsControl.xml

// Seq 1.1, allowed, no modifications
print "Start Seq1.1"
// Send notify
notifySendSm UseObjectAddress simatk ESatNotifySendSmPCmd
simatk RunIscTestCase 33 101
waittestclass notifySendSm
simatk CheckProactiveCommand Address "112233445566778" 2 2 AlphaId "Send SM" SmsTpdu 01 00 09 91 10 32 54 76 F8 40 F4 0C 54 65 73 74 20 4D 65 73 73 61 67 65
simatk SendTerminalResponse
simatk WaitForRequest

// Seq 1.2 skipped as it is same as 1.1 from MO SMS control point of view

// Seq 1.3, Not allowed case
// Send notify
notifySendSm UseObjectAddress simatk ESatNotifySendSmPCmd
simatk RunIscTestCase 33 102
waittestclass notifySendSm
simatk CheckProactiveCommand Address "112233445566778" 2 2 AlphaId "Send SM" SmsTpdu 01 00 09 91 10 32 54 76 F8 40 F4 0C 54 65 73 74 20 4D 65 73 73 61 67 65 SmsResult -8301
simatk SendTerminalResponse GeneralResult 39 InfoType MeProblem AdditionalInfo 01
simatk WaitForRequest

// Seq 1.4 skipped as it is same as 1.3 from MO SMS control point of view

// Seq 1.5, Allowed with modifications
// Send notify
notifySendSm UseObjectAddress simatk ESatNotifySendSmPCmd
simatk RunIscTestCase 33 103
waittestclass notifySendSm
simatk CheckProactiveCommand Address "112233445566778" 2 2 AlphaId "Send SM" SmsTpdu 01 00 09 91 10 32 54 76 F8 40 F4 0C 54 65 73 74 20 4D 65 73 73 61 67 65 SmsResult -8302
simatk SendTerminalResponse
simatk WaitForRequest

// Seq 1.6 skipped as it is same as 1.5 from MO SMS control point of view

// Seq 1.7, Allowed, "90 00" no modifications
// Send notify
notifySendSm UseObjectAddress simatk ESatNotifySendSmPCmd
simatk RunIscTestCase 33 104
waittestclass notifySendSm
simatk CheckProactiveCommand Address "112233445566778" 2 2 AlphaId "Send SM" SmsTpdu 01 00 09 91 10 32 54 76 F8 40 F4 0C 54 65 73 74 20 4D 65 73 73 61 67 65
simatk SendTerminalResponse 
simatk WaitForRequest

// close all
simatk Close SmsMessaging
simatk Close IscControl
simatk Close SAT
simatk Unload PhoneTsy.tsy
simatk Close RTelServer
delete notifySendSm
delete simatk
[Endtest]
