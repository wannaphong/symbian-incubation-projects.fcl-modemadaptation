//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  
//*


// MOD_0007.001_1_NokiaTSY_[HW IsBlocked]
//
// Verify that Security Code, PIN1 or PIN2 is not Blocked.
//
// Precondition:
// - The phone have to supports an overall phone device lock which can be
//   enabled or disabled. If enabled, user must enter phone password before
//   the phone can be used.
//
// Script description:
// - IsBlocked:
//    1st parameter: code ID
//    2nd parameter: expected result
//
[Test]
title MOD_0007.001_1_NokiaTSY_[HW IsBlocked]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomIsBlockedIPC
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC ECustomIsBlockedIPC
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC ECustomIsBlockedIPC
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo

test IsBlocked KSecCodeSecurity EFalse
allownextresult 0
waittestclass test // ECustomIsBlockedIPC

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

test IsBlocked KSecCodePin EFalse
allownextresult 0
waittestclass test // ECustomIsBlockedIPC

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

test IsBlocked KSecCodePin2 EFalse
allownextresult 0
waittestclass test // ECustomIsBlockedIPC

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.002_1_NokiaTSY_[HW DeliverCode]
//
// Verify that security code "1234" is properly delivered to the phone.
//
// Precondition:
// - The phone must support the delivired security code.
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
//
[Test]
title MOD_0007.002_1_NokiaTSY_[HW DeliverCode]
create NTT_Security test

test DeliverCode 1234
allownextresult 0
waittestclass test

delete test
[Endtest]


// MOD_0007.004_1_NokiaTSY_[HW CheckSecurityCode(Cancel)]
//
// Verify that phone accepts the cancel request to ongoing check security code request.
//
// Precondition:
// - The phone must support the delivired security code.
// - The phone must support access to currently active SIM card.
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
// - CheckSecurityCode
//    1st parameter: code ID
//
[Test]
title MOD_0007.004_1_NokiaTSY_[HW CheckSecurityCode(Cancel)]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySecurityReadyIPC
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC ECustomCheckSecurityCodeCancelIPC
test SetExpectedCompleteIPC EMobilePhoneAbortSecurityCode
test SetExpectedCompleteIPC ECustomCheckSecurityCodeIPC

test RunIscTestCase 102
test SyncIscTestCase
allownextresult 0
waittestclass test  // EMmTsyBootNotifySecurityReadyIPC

test DeliverCode 1234
allownextresult 0
waittestclass test

test CheckSecurityCode KSecCodeSecurity
allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

test CheckSecurityCodeCancel KSecCodeSecurity
allownextresult 0
waittestclass test // ECustomCheckSecurityCodeCancelIPC

allownextresult 0
waittestclass test // EMobilePhoneAbortSecurityCode

allownextresult -3 // KErrCancel
waittestclass test // ECustomCheckSecurityCodeIPC

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.005_1_NokiaTSY_[HW SimGetICCType]
//
// Verify that phone identifies the SIM ICC type.
//
// Precondition:
// - The phone supports access to the SIM ICC.
//
[Test]
title MOD_0007.005_1_NokiaTSY_[HW SimGetICCType]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsySimGetICCType

test SimGetICCType
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.006_1_NokiaTSY_[HW BootGetRFStatus]
//
// Verify that client gets RF status in phone boot.
//
// Precondition:
// - RF status is unknown.
//
[Test]
title MOD_0007.006_1_NokiaTSY_[HW BootGetRFStatus]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootGetRFStatusIPC

test BootGetRFStatus
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.007_1_NokiaTSY_[HW PhoneGetPin1DisableSupported]
//
// Verify that when this capability is set the phone will get information
// of PIN1 disable support for a client.
//
// Precondition:
// - The phone supports access to the PIN 1 security code.
//
[Test]
title MOD_0007.007_1_NokiaTSY_[HW PhoneGetPin1DisableSupported]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyPhoneGetPin1DisableSupportedIPC

test PhoneGetPin1DisableSupported
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007_008_1_NokiaTSY_[HW SecurityGetSimActivePinState]
//
// Verify that the state of currently active PIN is requested.
//
// Precondition:
// - The phone have support access to currently active SIM card.
//
[Test]
title MOD_0007.008_1_NokiaTSY_[HW SecurityGetSimActivePinState]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsySecurityGetSimActivePinStateIPC

test SecurityGetSimActivePinState
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.011_1_NokiaTSY_[HW GetLockInfo]
//
// Verify that status and settings of the locks are properly retrieved.
//
// Precondition:
// - The phone have to support the lock type request.
//
// Script description:
// - GetLockInfo
//    1st parameter: lock information
//
[Test]
title MOD_0007.011_1_NokiaTSY_[HW GetLockInfo]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
//(for some 3G cards)
//test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
//test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
//(for USIM cadrs)
//test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
//test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test GetLockInfo ELockPhoneDevice
allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test GetLockInfo ELockICC
allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test GetLockInfo ELockPhoneToICC
allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

//(for some 3G cards)
//test GetLockInfo ELockUniversalPin
//allownextresult 0
//waittestclass test // EMobilePhoneGetLockInfo

//allownextresult 0
//waittestclass test // EMobilePhoneNotifyLockInfoChange

//(for USIM cadrs)
//test GetLockInfo ELockPin2
//allownextresult 0
//waittestclass test // EMobilePhoneGetLockInfo

//allownextresult 0
//waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.013_1_NokiaTSY_[HW SetLockSetting]
//
// Verify that the setting of the given lock have been changed.
//
// Precondition:
// - The phone have to support changing the settings for the lock.
// - Correct PIN code is entered into the test script (for example 1234)
//
// Script description:
// - DeliverCode
//    1st parameter: code to be delivered
// - SetLockSetting:
//    1st parameter: lock information
//      RMobilePhone::ELockPhoneDevice: == 0
//      RMobilePhone::ELockPhoneToICC: == 2
//      RMobilePhone::ELockICC: == 1
//      RMobilePhone::ELockPin2: == 5 // In case of 3G card
//      RMobilePhone::ELockUniversalPin: == 9 // In case of UPIN supported card
// - SetLockSetting:
//    2nd parameter: lock setting
//      RMobilePhone::ELockSetEnabled: == 1
//      RMobilePhone::ELockSetDisabled: == 2
//      RMobilePhone::ELockReplaced: == 3
//
[Test]
title MOD_0007.013_1_NokiaTSY_[HW SetLockSetting]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneSetLockSetting
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneSetLockSetting
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test DeliverCode 1234
allownextresult 0
waittestclass test

test SetLockSetting ELockICC ELockSetEnabled
allownextresult 0
waittestclass test // EMobilePhoneSetLockSetting

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test SetLockSetting ELockICC ELockSetDisabled
allownextresult 0
waittestclass test // EMobilePhoneSetLockSetting

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.014_1_NokiaTSY_[HW ChangeSecurityCode]
//
// Verify that the lock setting and security code have been changed.
//
// Precondition:
// - The phone have to support changing the settings for the lock.
// - The phone have to support changing the security code.
// - Correct lock code is entered into the test script (for example 12345)
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
// - SetLockSetting:
//    1st parameter: lock information
//      RMobilePhone::ELockPhoneDevice: == 0
//      RMobilePhone::ELockPhoneToICC: == 2
//      RMobilePhone::ELockICC: == 1
//      RMobilePhone::ELockPin2: == 5 // In case of 3G card
//      RMobilePhone::ELockUniversalPin: == 9 // In case of UPIN supported card
//    2nd parameter: lock setting
//      RMobilePhone::ELockSetEnabled: == 1
//      RMobilePhone::ELockSetDisabled: == 2
//      RMobilePhone::ELockReplaced: == 3
// - ChangeSecurityCode:
//    1st parameter: code type
//    2nd parameter: old code
//    3nd parameter: new code
//
[Test]
title MOD_0007.014_1_NokiaTSY_[HW ChangeSecurityCode]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneVerifySecurityCode
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneChangeSecurityCode

test DeliverCode 12345
allownextresult 0
waittestclass test

test VerifySecurityCode ESecurityCodePhonePassword 12345
allownextresult 0
waittestclass test // EMobilePhoneVerifySecurityCode

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

test ChangeSecurityCode ESecurityCodePhonePassword 12345 12345
allownextresult 0
waittestclass test // EMobilePhoneChangeSecurityCode

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.015_1_NokiaTSY_[HW VerifySecurityCode]
//
// Verify that the security code requering verification is properly sended
// to the phone.
//
// Precondition:
// - The phone have to support the get security code request.
// - Correct PIN code is entered into the test script (for example 1234)
//
// Script description:
// - VerifySecurityCode:
//    1st parameter: code type
//    2nd parameter: security code
//    3nd parameter: unblock code
//
[Test]
title MOD_0007.015_1_NokiaTSY_[HW VerifySecurityCode]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneVerifySecurityCode
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityCodeInfoChange

test VerifySecurityCode ESecurityCodePin1 1234 1234
allownextresult 0
waittestclass test // EMobilePhoneVerifySecurityCode

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityCodeInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.016_1_NokiaTSY_[HW AbortSecurityCode]
//
// Verify that phone is informed that the user has cancelled an outstanding
// verify security code request.
//
// Precondition:
// - The phone have to support cancel verify security code request.
// - Correct PIN code is entered into the test script (for example 1234)
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
// - CheckSecurityCode
//    1st parameter: code ID
// - AbortSecurityCode:
//    1st parameter: code type
//
[Test]
title MOD_0007.016_1_NokiaTSY_[HW AbortSecurityCode]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC ECustomCheckSecurityCodeCancelIPC
test SetExpectedCompleteIPC EMobilePhoneAbortSecurityCode
test SetExpectedCompleteIPC ECustomCheckSecurityCodeIPC

test DeliverCode 1234
allownextresult 0
waittestclass test

test CheckSecurityCode KSecCodePin
allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

test AbortSecurityCode ESecurityCodePin1
allownextresult 0
waittestclass test // ECustomCheckSecurityCodeCancelIPC

allownextresult 0
waittestclass test // EMobilePhoneAbortSecurityCode

allownextresult -39 // KErrAbort
waittestclass test // ECustomCheckSecurityCodeIPC

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.017_1_NokiaTSY_[HW Get and Set Fdn Status]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting).
//
// Precondition:
// - The SIM card supports FDN (Fixed Dialling Numbers).
// - The PIN2 code is available and not blocked.
// - Correct PIN2 code is entered into the test script (for example 5678)
//
// Note: Entering wrong PIN2 three times will block it
//       (PUK2 needed for unblocking)!
//
// Script description:
// - VerifySecurityCode:
//    1st parameter: code type
//    2nd parameter: security code
//    3nd parameter: unblock code
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_1_NokiaTSY_[HW Get and Set Fdn Status]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneVerifySecurityCode
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityCodeInfoChange
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus

// PIN2 needs to be verified, for example '5678'.
// Last parameter '9999' is a dummy, don't change.
test VerifySecurityCode ESecurityCodePin2 5678 9999
allownextresult 0
waittestclass test // EMobilePhoneVerifySecurityCode

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityCodeInfoChange

test SimGetFdnStatus
allownextresult 0
waittestclass test // EMobilePhoneGetFdnStatus

// switch ACTIVE
test SimSetFdnStatus 0
allownextresult 0
waittestclass test // EMobilePhoneSetFdnSetting

test SimGetFdnStatus
allownextresult 0
waittestclass test // EMobilePhoneGetFdnStatus

// switch DEACTIVE
test SimSetFdnStatus 1
allownextresult 0
waittestclass test // EMobilePhoneSetFdnSetting

test SimGetFdnStatus
allownextresult 0
waittestclass test // EMobilePhoneGetFdnStatus

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.018_1_NokiaTSY_[HW DisablePhoneLock]
//
// Verify that the phone lock is disabled.
//
// Precondition:
// - The phone have to support changing the settings for the lock.
// - Correct Lock code is entered into the test script (for example 12345)
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
// - DisablePhoneLock
//    1st parameter: security code
//
[Test]
title MOD_0007.018_1_NokiaTSY_[HW DisablePhoneLock]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomDisablePhoneLockIPC
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test DeliverCode 12345
allownextresult 0
waittestclass test

test DisablePhoneLock 12345
allownextresult 0
waittestclass test // ECustomDisablePhoneLockIPC

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.019_1_NokiaTSY_[HW SecurityInfo]
//
// Verify that the phone returns correct value of remaining attempts left
//
// Precondition:
// - The phone must support the delivired security code.
// - The phone must support access to currently active SIM card.
//
// Script description:
// - SecurityInfo
//      Type of securitycode:
//          - ESecurityCodePin1
//          - ESecurityCodePin2
//          - ESecurityCodePuk1
//          - ESecurityCodePuk2
//          - ESecurityUniversalPin
//          - ESecurityUniversalPuk
//
[Test]
title MOD_0007.019_1_NokiaTSY_[HW SecurityInfo]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetSecurityCodeInfo

test SecurityInfo ESecurityCodePin1
allownextresult 0
waittestclass test // EMobilePhoneGetSecurityCodeInfo

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007_120_1_NokiaTSY_[HW Get Current Active USIM Application]
//
// Precondition:
// - Use 3G SIM card
//
// Script description:
// - Get Current Active USIM Application
//
[Test]
title MOD_0007_120_1_NokiaTSY_[HW Get Current Active USIM Application]
create NTT_Security test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetCurrentActiveUSimApplication
test RunIscTestCase 120
test SyncIscTestCase
test GetCurrentActiveUSIMApplication
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]

// MOD_0007_121_1_NokiaTSY_[HW Get Current Active USIM Application 2G]
//
// Precondition:
// - Use 2G SIM card
//
// Script description:
// - Get Current Active USIM Application
//
[Test]
title MOD_0007_121_1_NokiaTSY_[HW Get Current Active USIM Application 2G]
create NTT_Security test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetCurrentActiveUSimApplication
test RunIscTestCase 120
test SyncIscTestCase
test GetCurrentActiveUSIMApplication
allownextresult -1
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// End of file
