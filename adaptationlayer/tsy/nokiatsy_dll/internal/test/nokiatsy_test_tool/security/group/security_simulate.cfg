//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  
//*


// MOD_0007.001_2_NokiaTSY_[XML IsBlocked]
//
// Verify that Security Code, PIN1 or PIN2 is not Blocked.
//
// Precondition:
// - N/A
//
// Script description:
// - IsBlocked:
//    1st parameter: code ID
//    2nd parameter: expected result
//
[Test]
title MOD_0007.001_2_NokiaTSY_[XML IsBlocked]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomIsBlockedIPC
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC ECustomIsBlockedIPC
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC ECustomIsBlockedIPC
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo

test RunIscTestCase 105
test SyncIscTestCase

test IsBlocked KSecCodeSecurity EFalse
allownextresult 0
waittestclass test // ECustomIsBlockedIPC

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

test IsBlocked KSecCodePin EFalse
allownextresult 0
waittestclass test // ECustomIsBlockedIPC

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

test IsBlocked KSecCodePin2 EFalse
allownextresult 0
waittestclass test // ECustomIsBlockedIPC

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.002_2_NokiaTSY_[XML DeliverCode]
//
// Verify that security code "1234" is properly delivered to the phone.
//
// Precondition:
// - N/A
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
//
[Test]
title MOD_0007.002_2_NokiaTSY_[XML DeliverCode]
create NTT_Security test

test RunIscTestCase 130 // Run dummy case to start NTSY
test SyncIscTestCase

test DeliverCode 1234
allownextresult 0
waittestclass test

delete test
[Endtest]


// MOD_0007.003_2_NokiaTSY_[XML CheckSecurityCode(PIN)]
//
// Verify that NokiaTSY sends PIN code "1234".
//
// Precondition:
// - N/A
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
// - RunIscTestCase:
//    1st parameter: test case ID
// - CheckSecurityCode
//    1st parameter: code ID
// - VerifySecurityCode
//    1st parameter: code type
//    2nd parameter: PIN code
//
[Test]
title MOD_0007.003_2_NokiaTSY_[XML CheckSecurityCode(PIN)]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneVerifySecurityCode
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC ECustomCheckSecurityCodeIPC
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityCodeInfoChange

test RunIscTestCase 130 // Run dummy case to start NTSY
test SyncIscTestCase

test DeliverCode 1234
allownextresult 0
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 104
test SyncIscTestCase

test CheckSecurityCode KSecCodePin
allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test VerifySecurityCode ESecurityCodePin1 1234
allownextresult 0
waittestclass test // EMobilePhoneVerifySecurityCode

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

allownextresult 0
waittestclass test // ECustomCheckSecurityCodeIPC

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityCodeInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.004_2_NokiaTSY_[XML CheckSecurityCode(Cancel)]
//
// Verify that phone accepts the cancel request to ongoing check security code request.
//
// Precondition:
// - N/A
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
// - CheckSecurityCode
//    1st parameter: code ID
//
[Test]
title MOD_0007.004_2_NokiaTSY_[XML CheckSecurityCode(Cancel)]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySecurityReadyIPC
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC ECustomCheckSecurityCodeCancelIPC
test SetExpectedCompleteIPC EMobilePhoneAbortSecurityCode
test SetExpectedCompleteIPC ECustomCheckSecurityCodeIPC

test RunIscTestCase 102
test SyncIscTestCase
allownextresult 0
waittestclass test  // EMmTsyBootNotifySecurityReadyIPC

test DeliverCode 1234
allownextresult 0
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 106
test SyncIscTestCase

test CheckSecurityCode KSecCodeSecurity
allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

test CheckSecurityCodeCancel KSecCodeSecurity
allownextresult 0
waittestclass test // ECustomCheckSecurityCodeCancelIPC

allownextresult 0
waittestclass test // EMobilePhoneAbortSecurityCode

allownextresult -3 // KErrCancel
waittestclass test // ECustomCheckSecurityCodeIPC

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.005_2_NokiaTSY_[XML SimGetICCType]
//
// Verify that phone identifies the SIM ICC type.
//
// Precondition:
// - N/A
//
[Test]
title MOD_0007.005_2_NokiaTSY_[XML SimGetICCType]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsySimGetICCType
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 107
test SyncIscTestCase

test SimGetICCType
allownextresult 0
waittestclass test // EMmTsySimGetICCType

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.006_2_NokiaTSY_[XML BootGetRFStatus]
//
// Verify that client gets RF status in phone boot.
//
// Precondition:
// - N/A
//
[Test]
title MOD_0007.006_2_NokiaTSY_[XML BootGetRFStatus]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootGetRFStatusIPC

test RunIscTestCase 108
test SyncIscTestCase

test BootGetRFStatus
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.007_2_NokiaTSY_[XML PhoneGetPin1DisableSupported]
//
// Verify that when this capability is set the phone will get information
// of PIN1 disable support for a client.
//
// Precondition:
// - N/A
//
[Test]
title MOD_0007.007_2_NokiaTSY_[XML PhoneGetPin1DisableSupported]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyPhoneGetPin1DisableSupportedIPC

test RunIscTestCase 109
test SyncIscTestCase

test PhoneGetPin1DisableSupported
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007_008_2_NokiaTSY_[XML SecurityGetSimActivePinState]
//
// Verify that the state of currently active PIN is requested.
//
// Precondition:
// - N/A
//
[Test]
title MOD_0007.008_2_NokiaTSY_[XML SecurityGetSimActivePinState]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsySecurityGetSimActivePinStateIPC
test SetExpectedCompleteIPC EMmTsyBootNotifySecurityReadyIPC
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 110
test SyncIscTestCase

test SecurityGetSimActivePinState
allownextresult 0
waittestclass test // EMmTsySecurityGetSimActivePinStateIPC

allownextresult 0
waittestclass test // EMmTsyBootNotifySecurityReadyIPC

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.009_2_NokiaTSY_[XML BootNotifyModemStatusReady]
//
// Verify that modem status ready notification for a client in
// phone boot is complete.
//
// Precondition:
// - N/A
//
// Script description:
// - RunIscTestCase
//    1st parameter: test case ID
//
[Test]
title MOD_0007.009_2_NokiaTSY_[XML BootNotifyModemStatusReady]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifyModemStatusReadyIPC

test BootNotifyModemStatusReady

test RunIscTestCase 101
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifyModemStatusReadyIPC

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.010_2_NokiaTSY_[XML BootNotifySecurityReady]
//
// Verify that security status ready notification for a client in
// phone boot is complete.
//
// Precondition:
// - N/A
//
// Script description:
// - RunIscTestCase
//    1st parameter: test case ID
//
[Test]
title MOD_0007.010_2_NokiaTSY_[XML BootNotifySecurityReady]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySecurityReadyIPC

test BootNotifySecurityReady
test RunIscTestCase 102
test SyncIscTestCase

allownextresult 0
waittestclass test // EMmTsyBootNotifySecurityReadyIPC

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.011_2_NokiaTSY_[XML GetLockInfo]
//
// Verify that status and settings of the locks are properly retrieved.
//
// Precondition:
// - N/A
//
// Script description:
// - GetLockInfo
//    1st parameter: lock information
//
[Test]
title MOD_0007.011_2_NokiaTSY_[XML GetLockInfo]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMmTsySimGetICCType
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 111
test SyncIscTestCase

test GetLockInfo ELockPhoneDevice
allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test GetLockInfo ELockICC
allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test GetLockInfo ELockPhoneToICC
allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

//(some 3G cards)
test GetLockInfo ELockUniversalPin
allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 107
test SyncIscTestCase

test SimGetICCType
allownextresult 0
waittestclass test // EMmTsySimGetICCType

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 112
test SyncIscTestCase

//( USIM cadrs )
test GetLockInfo ELockPin2
allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.012_2_NokiaTSY_[XML NotifyLockInfoChange]
//
// Verify that client is allowed to be notified when any part of
// the lock information changes.
//
// Precondition:
// - N/A
//
// Script description:
// - RunIscTestCase:
//    1st parameter: test case ID
//
[Test]
title MOD_0007.012_2_NokiaTSY_[XML NotifyLockInfoChange]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test NotifyLockInfoChange KSecCodePin

test RunIscTestCase 103
test SyncIscTestCase

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.013_2_NokiaTSY_[XML SetLockSetting]
//
// Verify that the setting of the given lock have been changed.
//
// Precondition:
// - N/A
//
// Script description:
// - DeliverCode
//    1st parameter: code to be delivered
// - SetLockSetting:
//    1st parameter: lock information
//      RMobilePhone::ELockPhoneDevice: == 0
//      RMobilePhone::ELockPhoneToICC: == 2
//      RMobilePhone::ELockICC: == 1
//      RMobilePhone::ELockPin2: == 5 // In case of 3G card
//      RMobilePhone::ELockUniversalPin: == 9 // In case of UPIN supported card
// - SetLockSetting:
//    2nd parameter: lock setting
//      RMobilePhone::ELockSetEnabled: == 1
//      RMobilePhone::ELockSetDisabled: == 2
//      RMobilePhone::ELockReplaced: == 3
//
[Test]
title MOD_0007.013_2_NokiaTSY_[XML SetLockSetting]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneSetLockSetting
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneSetLockSetting
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 130 // Run dummy case to start NTSY
test SyncIscTestCase

test DeliverCode 1234
allownextresult 0
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 113
test SyncIscTestCase

test SetLockSetting ELockICC ELockSetEnabled
allownextresult 0
waittestclass test // EMobilePhoneSetLockSetting

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test SetLockSetting ELockICC ELockSetDisabled
allownextresult 0
waittestclass test // EMobilePhoneSetLockSetting

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007.013_2_2_NokiaTSY_[XML SetLockSetting substitute UPIN]
//
// Verify that the setting of the given lock have been changed.
//
// Precondition:
// - N/A
//
// Script description:
// - DeliverCode
//    1st parameter: code to be delivered
// - SetLockSetting:
//    1st parameter: lock information
//      RMobilePhone::ELockPhoneDevice: == 0
//      RMobilePhone::ELockPhoneToICC: == 2
//      RMobilePhone::ELockICC: == 1
//      RMobilePhone::ELockPin2: == 5 // In case of 3G card
//      RMobilePhone::ELockUniversalPin: == 9 // In case of UPIN supported card
// - SetLockSetting:
//    2nd parameter: lock setting
//      RMobilePhone::ELockSetEnabled: == 1
//      RMobilePhone::ELockSetDisabled: == 2
//      RMobilePhone::ELockReplaced: == 3
//
[Test]
title MOD_0007.013_2_2_NokiaTSY_[XML SetLockSetting substitute UPIN]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneSetLockSetting
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 130 // Run dummy case to start NTSY
test SyncIscTestCase

test DeliverCode 1234
allownextresult 0
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 126
test SyncIscTestCase

test SetLockSetting ELockUniversalPin ELockReplaced
allownextresult 0
waittestclass test // EMobilePhoneSetLockSetting

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007.013_2_2_NokiaTSY_[XML SetLockSetting substitute PIN]
//
// Verify that the setting of the given lock have been changed.
//
// Precondition:
// - N/A
//
// Script description:
// - DeliverCode
//    1st parameter: code to be delivered
// - SetLockSetting:
//    1st parameter: lock information
//      RMobilePhone::ELockPhoneDevice: == 0
//      RMobilePhone::ELockPhoneToICC: == 2
//      RMobilePhone::ELockICC: == 1
//      RMobilePhone::ELockPin2: == 5 // In case of 3G card
//      RMobilePhone::ELockUniversalPin: == 9 // In case of UPIN supported card
// - SetLockSetting:
//    2nd parameter: lock setting
//      RMobilePhone::ELockSetEnabled: == 1
//      RMobilePhone::ELockSetDisabled: == 2
//      RMobilePhone::ELockReplaced: == 3
//
[Test]
title MOD_0007.013_3_2_NokiaTSY_[XML SetLockSetting substitute PIN]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneSetLockSetting
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 130 // Run dummy case to start NTSY
test SyncIscTestCase

test DeliverCode 1234
allownextresult 0
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 125
test SyncIscTestCase

test SetLockSetting ELockICC ELockReplaced

allownextresult 0
waittestclass test // EMobilePhoneSetLockSetting

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007.014_2_NokiaTSY_[XML ChangeSecurityCode]
//
// Verify that the lock setting and security code have been changed.
//
// Precondition:
// - N/A
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
// - SetLockSetting:
//    1st parameter: lock information
//      RMobilePhone::ELockPhoneDevice: == 0
//      RMobilePhone::ELockPhoneToICC: == 2
//      RMobilePhone::ELockICC: == 1
//      RMobilePhone::ELockPin2: == 5 // In case of 3G card
//      RMobilePhone::ELockUniversalPin: == 9 // In case of UPIN supported card
//    2nd parameter: lock setting
//      RMobilePhone::ELockSetEnabled: == 1
//      RMobilePhone::ELockSetDisabled: == 2
//      RMobilePhone::ELockReplaced: == 3
// - ChangeSecurityCode:
//    1st parameter: code type
//    2nd parameter: old code
//    3nd parameter: new code
//
[Test]
title MOD_0007.014_2_NokiaTSY_[XML ChangeSecurityCode]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneVerifySecurityCode
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneChangeSecurityCode

test RunIscTestCase 130 // Run dummy case to start NTSY
test SyncIscTestCase

test DeliverCode 1234
allownextresult 0
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 114
test SyncIscTestCase

test VerifySecurityCode ESecurityCodePhonePassword 12345
allownextresult 0
waittestclass test // EMobilePhoneVerifySecurityCode

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

test ChangeSecurityCode ESecurityCodePhonePassword 12345 12345
allownextresult 0
waittestclass test // EMobilePhoneChangeSecurityCode

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.015_2_NokiaTSY_[XML VerifySecurityCode]
//
// Verify that the security code requering verification is properly sended
// to the phone.
//
// Precondition:
// - N/A
//
// Script description:
// - VerifySecurityCode:
//    1st parameter: code type
//    2nd parameter: security code
//    3nd parameter: unblock code
//
[Test]
title MOD_0007.015_2_NokiaTSY_[XML VerifySecurityCode]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneVerifySecurityCode
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityCodeInfoChange
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 115
test SyncIscTestCase

test VerifySecurityCode ESecurityCodePin1 1234 1234
allownextresult 0
waittestclass test // EMobilePhoneVerifySecurityCode

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityCodeInfoChange

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.016_2_NokiaTSY_[XML AbortSecurityCode]
//
// Verify that phone is informed that the user has cancelled an outstanding
// verify security code request.
//
// Precondition:
// - N/A
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
// - CheckSecurityCode
//    1st parameter: code ID
// - AbortSecurityCode:
//    1st parameter: code type
//
[Test]
title MOD_0007.016_2_NokiaTSY_[XML AbortSecurityCode]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC ECustomCheckSecurityCodeCancelIPC
test SetExpectedCompleteIPC EMobilePhoneAbortSecurityCode
test SetExpectedCompleteIPC ECustomCheckSecurityCodeIPC

test RunIscTestCase 130 // Run dummy case to start NTSY
test SyncIscTestCase

test DeliverCode 1234
allownextresult 0
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 116
test SyncIscTestCase

test CheckSecurityCode KSecCodePin
allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

test AbortSecurityCode ESecurityCodePin1
allownextresult 0
waittestclass test // ECustomCheckSecurityCodeCancelIPC

allownextresult 0
waittestclass test // EMobilePhoneAbortSecurityCode

allownextresult -39 // KErrAbort
waittestclass test // ECustomCheckSecurityCodeIPC

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.017_2_NokiaTSY_[XML Get and Set Fdn Status]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting).
//
// Precondition:
// - N/A
//
// Script description:
// - VerifySecurityCode:
//    1st parameter: code type
//    2nd parameter: security code
//    3nd parameter: unblock code
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_2_NokiaTSY_[XML Get and Set Fdn Status]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus

test RunIscTestCase 117
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifySimStatusReadyIPC

// enable FDN
test SimSetFdnStatus 0
allownextresult 0
waittestclass test // EMobilePhoneSetFdnSetting

// disable FDN
test SimSetFdnStatus 1
allownextresult 0
waittestclass test // EMobilePhoneSetFdnSetting

test SimGetFdnStatus
allownextresult 0
waittestclass test // EMobilePhoneGetFdnStatus

test SimGetFdnStatus
allownextresult 0
waittestclass test // EMobilePhoneGetFdnStatus

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007.017_3_NokiaTSY_[XML Set Fdn Status when FDN state already correct in EFest]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting) when FDN state already correct in EFest
//
// Precondition:
// - N/A
//
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_3_NokiaTSY_[XML Set Fdn Status when FDN state already correct in EFest]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting

test RunIscTestCase 131
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifySimStatusReadyIPC

// enable FDN
test SimSetFdnStatus 0
allownextresult 0
waittestclass test // EMobilePhoneSetFdnSetting

// disable FDN
test SimSetFdnStatus 1
allownextresult 0
waittestclass test // EMobilePhoneSetFdnSetting

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.017_4_NokiaTSY_[XML Get and Set Fdn Status, EFest reading fails]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting) when EFest reading fails
//
// Precondition:
// - N/A
//
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_4_NokiaTSY_[XML Get and Set Fdn Status, EFest reading fails]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus

test RunIscTestCase 132
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifySimStatusReadyIPC

// enable FDN
test SimSetFdnStatus 0
allownextresult -2 // KErrGeneral
waittestclass test // EMobilePhoneSetFdnSetting

// disable FDN
test SimSetFdnStatus 1
allownextresult -2 // KErrGeneral
waittestclass test // EMobilePhoneSetFdnSetting

test SimGetFdnStatus
allownextresult -2 // KErrGeneral
waittestclass test // EMobilePhoneGetFdnStatus

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007.017_5_NokiaTSY_[XML Set Fdn Status, EFest update fails]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting) when EFest reading fails
//
// Precondition:
// - N/A
//
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_5_NokiaTSY_[XML Set Fdn Status, EFest update fails]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting

test RunIscTestCase 133
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifySimStatusReadyIPC

// enable FDN
test SimSetFdnStatus 0
allownextresult -2 // KErrGeneral
waittestclass test // EMobilePhoneSetFdnSetting

// disable FDN
test SimSetFdnStatus 1
allownextresult -2 // KErrGeneral
waittestclass test // EMobilePhoneSetFdnSetting

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.017_6_NokiaTSY_[XML Get and Set Fdn Status when FDN not supported in EFust]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting) when FDN not supported in EFust
//
// Precondition:
// - N/A
//
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_6_NokiaTSY_[XML Get and Set Fdn Status when FDN not supported in EFust]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus

test RunIscTestCase 139
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifySimStatusReadyIPC

// enable FDN
test SimSetFdnStatus 0
allownextresult -5 // KErrNotSupported
waittestclass test // EMobilePhoneSetFdnSetting

// disable FDN
test SimSetFdnStatus 1
allownextresult -5 // KErrNotSupported
waittestclass test // EMobilePhoneSetFdnSetting

test SimGetFdnStatus
allownextresult 0
waittestclass test // EMobilePhoneGetFdnStatus

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.017_7_NokiaTSY_[XML Get and Set Fdn Status in case of ICC card]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting) in case of ICC card
//
// Precondition:
// - N/A
//
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_7_NokiaTSY_[XML Get and Set Fdn Status in case of ICC card]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus

test RunIscTestCase 134
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifySimStatusReadyIPC

// enable FDN
test SimSetFdnStatus 0
allownextresult 0
waittestclass test // EMobilePhoneSetFdnSetting

// disable FDN
test SimSetFdnStatus 1
allownextresult 0
waittestclass test // EMobilePhoneSetFdnSetting

test SimGetFdnStatus
allownextresult 0
waittestclass test // EMobilePhoneGetFdnStatus

test SimGetFdnStatus
allownextresult 0
waittestclass test // EMobilePhoneGetFdnStatus

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007.017_8_NokiaTSY_[XML Set Fdn Status in case of ICC card, command fails]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting) in case of ICC card and command fails
//
// Precondition:
// - N/A
//
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_8_NokiaTSY_[XML Set Fdn Status in case of ICC card, command fails]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting

test RunIscTestCase 135
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifySimStatusReadyIPC

// enable FDN
test SimSetFdnStatus 0
allownextresult -21 // KerrAccessDenied
waittestclass test // EMobilePhoneSetFdnSetting

// disable FDN
test SimSetFdnStatus 1
allownextresult -2 // KErrGeneral
waittestclass test // EMobilePhoneSetFdnSetting

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007.017_9_NokiaTSY_[XML Get and Set Fdn Status in case of ICC card, FDN not supported in EFsst]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting) in case of ICC card
//
// Precondition:
// - N/A
//
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_9_NokiaTSY_[XML Get and Set Fdn Status in case of ICC card, FDN not supported in EFsst]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus

test RunIscTestCase 140
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifySimStatusReadyIPC

// enable FDN
test SimSetFdnStatus 0
allownextresult -5 // KErrNotSupported
waittestclass test // EMobilePhoneSetFdnSetting

// disable FDN
test SimSetFdnStatus 1
allownextresult -5 // KErrNotSupported
waittestclass test // EMobilePhoneSetFdnSetting

test SimGetFdnStatus
allownextresult 0
waittestclass test // EMobilePhoneGetFdnStatus

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.017_10_NokiaTSY_[XML Set Fdn Status in case of ICC card, state already correct]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting) in case of ICC card and state is already correct
//
// Precondition:
// - N/A
//
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_10_NokiaTSY_[XML Set Fdn Status in case of ICC card, state already correct]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting

test RunIscTestCase 136
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifySimStatusReadyIPC

// enable FDN
test SimSetFdnStatus 0
allownextresult 0
waittestclass test // EMobilePhoneSetFdnSetting

// disable FDN
test SimSetFdnStatus 1
allownextresult 0
waittestclass test // EMobilePhoneSetFdnSetting

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007.017_11_NokiaTSY_[XML Get and Set Fdn Status in case of ICC card, file info reading fails]
//
// Test reading and changing the FDN status ("FDN active"/"FDN not active")
// on the SIM card (Corresponds to IPCs EMobilePhoneGetFdnStatus and
// EMobilePhoneSetFdnSetting) in case of ICC card and file info reading fails
//
// Precondition:
// - N/A
//
// - SimSetFdnStatus:
//    1st parameter: fdn setting
//      0 = EFdnSetOn
//      1 = EFdnSetOff
//
[Test]
title MOD_0007.017_11_NokiaTSY_[XML Get and Set Fdn Status in case of ICC card, file info reading fails]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneSetFdnSetting
test SetExpectedCompleteIPC EMobilePhoneGetFdnStatus

test RunIscTestCase 137
test SyncIscTestCase
allownextresult 0
waittestclass test // EMmTsyBootNotifySimStatusReadyIPC

// enable FDN
test SimSetFdnStatus 0
allownextresult -5 // KErrNotSupported
waittestclass test // EMobilePhoneSetFdnSetting

// disable FDN
test SimSetFdnStatus 1
allownextresult -5 // KErrNotSupported
waittestclass test // EMobilePhoneSetFdnSetting

test SimGetFdnStatus
allownextresult -5 // KErrNotSupported
waittestclass test // EMobilePhoneGetFdnStatus

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.018_2_NokiaTSY_[XML DisablePhoneLock]
//
// Verify that the phone lock is disabled.
//
// Precondition:
// - N/A
//
// Script description:
// - DeliverCode:
//    1st parameter: code to be delivered
// - DisablePhoneLock
//    1st parameter: security code
//
[Test]
title MOD_0007.018_2_NokiaTSY_[XML DisablePhoneLock]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomDisablePhoneLockIPC
test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifySecurityEvent
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 130 // Run dummy case to start NTSY
test SyncIscTestCase

test DeliverCode 12345
allownextresult 0
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 118
test SyncIscTestCase

test DisablePhoneLock 12345
allownextresult 0
waittestclass test // ECustomDisablePhoneLockIPC

allownextresult 0
waittestclass test // EMobilePhoneGetLockInfo

allownextresult 0
waittestclass test // EMobilePhoneNotifySecurityEvent

allownextresult 0
waittestclass test // EMobilePhoneNotifyLockInfoChange

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0007.019_2_NokiaTSY_[XML SecurityInfo]
//
// Verify that the phone returns correct value of remaining attempts left
//
// Precondition:
// - N/A
//
// Script description:
// - SecurityInfo
//      Type of securitycode:
//          - ESecurityCodePin1
//          - ESecurityCodePin2
//          - ESecurityCodePuk1
//          - ESecurityCodePuk2
//          - ESecurityUniversalPin
//          - ESecurityUniversalPuk
//
[Test]
title MOD_0007.019_2_NokiaTSY_[XML SecurityInfo]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetSecurityCodeInfo

test RunIscTestCase 119
test SyncIscTestCase

test SecurityInfo ESecurityCodePin1
allownextresult 0
waittestclass test // EMobilePhoneGetSecurityCodeInfo

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007_120_2_NokiaTSY_[XML Get Current Active USIM Application]
//
// Precondition:
// - N/A
//
// Script description:
// - Get Current Active USIM Application
//
[Test]
title MOD_0007_120_2_NokiaTSY_[XML Get Current Active USIM Application]
create NTT_Security test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetCurrentActiveUSimApplication
test RunIscTestCase 121
test SyncIscTestCase
test GetCurrentActiveUSIMApplication 147377136
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]

// MOD_0007_121_2_NokiaTSY_[XML Get Current Active USIM Application 2G]
//
// Precondition:
// - N/A
//
// Script description:
// - Get Current Active USIM Application
//
[Test]
title MOD_0007_121_2_NokiaTSY_[XML Get Current Active USIM Application 2G]
create NTT_Security test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetCurrentActiveUSimApplication
test RunIscTestCase 122
test SyncIscTestCase
test GetCurrentActiveUSIMApplication
allownextresult -1
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]

// MOD_0007_122_2_NokiaTSY_[XML Get Current Active USIM Application - sb status not ok]
//
// Precondition:
// - N/A
//
// Script description:
// - Get Current Active USIM Application
//
[Test]
title MOD_0007_122_2_NokiaTSY_[XML Get Current Active USIM Application - sb status not ok]
create NTT_Security test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetCurrentActiveUSimApplication
test RunIscTestCase 123
test SyncIscTestCase
test GetCurrentActiveUSIMApplication
allownextresult -2
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]

// MOD_0007_123_2_NokiaTSY_[XML Get Current Active USIM Application - file not avail]
//
// Precondition:
// - N/A
//
// Script description:
// - Get Current Active USIM Application
//
[Test]
title MOD_0007_123_2_NokiaTSY_[XML Get Current Active USIM Application - file not avail]
create NTT_Security test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetCurrentActiveUSimApplication
test RunIscTestCase 124
test SyncIscTestCase
test GetCurrentActiveUSIMApplication
allownextresult -1
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]

// MOD_0007_200_2_NokiaTSY_[XML SIM lock disabled - original SIM]
//
// Precondition:
// - N/A
//
// Script description:
// - SEC_CODE_STATE_OK_RESP state is SEC_DISABLE
// - Reference: TSW Error EAJG-7EE9GN
//
[Test]
title MOD_0007_200_2_NokiaTSY_[XML SIM lock disabled - original SIM]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 127
test SyncIscTestCase
test GetLockInfo ELockPhoneToICC SIMLockDisabled Unlocked

// EMobilePhoneGetLockInfo
allownextresult 0
waittestclass test

// EMobilePhoneNotifyLockInfoChange
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007_201_2_NokiaTSY_[XML SIM lock enabled - original SIM]
//
// Precondition:
// - N/A
//
// Script description:
// - SEC_CODE_STATE_OK_RESP state is SEC_CODE_LEVEL_PHONE_ENABLE
//   and in this case SEC_STATE_REQ is sent.
// - SEC_STATE_RESP cardStatus is SEC_OWNER_CARD => lock status is unlocked.
// - Reference: TSW Error EAJG-7EE9GN
//
[Test]
title MOD_0007_201_2_NokiaTSY_[XML SIM lock enabled - original SIM]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 128
test SyncIscTestCase
test GetLockInfo ELockPhoneToICC SIMLockEnabled Unlocked

// EMobilePhoneGetLockInfo
allownextresult 0
waittestclass test

// EMobilePhoneNotifyLockInfoChange
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0007_202_2_NokiaTSY_[XML SIM lock enabled - SIM is changed]
//
// Precondition:
// - N/A
//
// Script description:
// - SEC_CODE_STATE_OK_RESP state is SEC_CODE_LEVEL_PHONE_ENABLE
//   and in this case SEC_STATE_REQ is sent.
// - SEC_STATE_RESP cardStatus is SEC_NOT_OWNER_CARD => lock status is locked.
// - Reference: TSW Error EAJG-7EE9GN
//
[Test]
title MOD_0007_202_2_NokiaTSY_[XML SIM lock enabled - SIM is changed]
create NTT_Security test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobilePhoneGetLockInfo
test SetExpectedCompleteIPC EMobilePhoneNotifyLockInfoChange

test RunIscTestCase 129
test SyncIscTestCase
test GetLockInfo ELockPhoneToICC SIMLockEnabled Locked

// EMobilePhoneGetLockInfo
allownextresult 0
waittestclass test

// EMobilePhoneNotifyLockInfoChange
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// End of file
