//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:  
//*


// MOD_0005_101_2_NokiaTSY_[XML GetServiceTable SIM]
//
// Precondition:
// - none
//
// Script description:
// - Get service table SIM
// - First parameter is service table
//
[Test]
title MOD_0005_101_2_NokiaTSY_[XML GetServiceTable SIM]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetServiceTable
test RunIscTestCase 111
test SyncIscTestCase
test GetServiceTable SIM
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_102_2_NokiaTSY_[XML GetServiceTable USIM]
//
// Precondition:
// - none
//
// Script description:
// - Get service table USIM
// - First parameter is service table
//
[Test]
title MOD_0005_102_2_NokiaTSY_[XML GetServiceTable USIM]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetServiceTable
test RunIscTestCase 112
test SyncIscTestCase
test GetServiceTable USIM
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_103_2_NokiaTSY_[XML GetServiceTable SIM and USIM]
//
// Precondition:
// - none
//
// Script description:
// - Get service table SIM and USIM
// - First parameter is service table
//
[Test]
title MOD_0005_103_2_NokiaTSY_[XML GetServiceTable SIM and USIM]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetServiceTable
test SetExpectedCompleteIPC EMobilePhoneGetServiceTable
test RunIscTestCase 111
test SyncIscTestCase
test GetServiceTable SIM
allownextresult 0
waittestclass test
// wait for ISC testcase completion signal
allownextresult 1
waittestclass test
test RunIscTestCase 112
test SyncIscTestCase
test GetServiceTable USIM
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_104_2_NokiaTSY_[XML GetServiceTable USIM and SIM]
//
// Precondition:
// - none
//
// Script description:
// - Get service table USIM and SIM
// - First parameter is service table
//
[Test]
title MOD_0005_104_2_NokiaTSY_[XML GetServiceTable USIM and SIM]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetServiceTable
test SetExpectedCompleteIPC EMobilePhoneGetServiceTable
test RunIscTestCase 112
test SyncIscTestCase
test GetServiceTable USIM
allownextresult 0
waittestclass test
// wait for ISC testcase completion signal
allownextresult 1
waittestclass test
test RunIscTestCase 111
test SyncIscTestCase
test GetServiceTable SIM
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_105_2_NokiaTSY_[XML GetALSLine]
//
// Precondition:
// - none
//
// Script description:
// - Get ALS line
// - parameter: ALS line (EAlternateLinePrimary = 0,
//   EAlternateLineAuxiliary = 1), for validity checking
//
[Test]
title MOD_0005_105_2_NokiaTSY_[XML GetALSLine]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetALSLine
test RunIscTestCase 500
test SyncIscTestCase
test GetALSLine 1
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005_106_2_NokiaTSY_[XML SetALSLine 0]
//
// Precondition:
// - none
//
// Script description:
// - Set ALS line
// - parameters:
//   0 = EAlternateLinePrimary,
//   1 = EAlternateLineAuxiliary,
//   2 = EAlternateLineUnknown,
//   3 = EAlternateLineNotAvailable
//
[Test]
title MOD_0005_106_2_NokiaTSY_[XML SetALSLine 0]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneSetALSLine
test RunIscTestCase 501
test SyncIscTestCase
test SetALSLine 0
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_107_2_NokiaTSY_[XML SetALSLine 1]
//
// Precondition:
// - none
//
// Script description:
// - Set ALS line
// - parameters:
//   0 = EAlternateLinePrimary,
//   1 = EAlternateLineAuxiliary,
//   2 = EAlternateLineUnknown,
//   3 = EAlternateLineNotAvailable
//
[Test]
title MOD_0005_107_2_NokiaTSY_[XML SetALSLine 1]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneSetALSLine
test RunIscTestCase 502
test SyncIscTestCase
test SetALSLine 1
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_108_2_NokiaTSY_[XML GetCustomerServiceProfile]
//
// Precondition:
// -none
//
// Script description:
// - GetCustomerServiceProfile
// - parameters (for validity checking)
// - CallOfferingServices: 240
// - CallRestrictionServices: 248
// - OtherSuppServices: 128
// - CallCompletionServices: 192
// - Teleservices: 222
// - CphsTeleservices: 128
// - CphsFeatures: 0
// - NumberIdentServices: 129
// - Phase2PlusServices: 0
// - ValueAddedServices: 132
//
[Test]
title MOD_0005_108_2_NokiaTSY_[XML GetCustomerServiceProfile]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetCustomerServiceProfile
test RunIscTestCase 503
test SyncIscTestCase
test GetCustomerServiceProfile 240 248 128 192 222 128 0 129 0 132
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005_109_2_NokiaTSY_[XML GetPin1DisableSupported]
//
// Precondition:
// - none
//
// Script description:
// - GetPin1DisableSupported
//
[Test]
title MOD_0005_109_2_NokiaTSY_[XML GetPin1DisableSupported]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyPhoneGetPin1DisableSupportedIPC
test RunIscTestCase 504
test SyncIscTestCase
test GetPin1DisableSupported
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_110_2_NokiaTSY_[XML SimRefreshRegister]
//
// Precondition:
// - none
//
// Script description:
// - SimRefreshRegister
// parameter:
//  KCacheSmsParams = 0x01
//  KCacheAdn = 0x02
//  KCacheFdn = 0x04
//  KCacheServiceTable = 0x08
//  KCacheALSline = 0x10
//
[Test]
title MOD_0005_110_2_NokiaTSY_[XML SimRefreshRegister]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsySimRefreshRegisterIPC
test RunIscTestCase 505
test SyncIscTestCase
test SimRefreshRegister 31
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_111_2_NokiaTSY_[XML SimRefreshDone ok]
//
// Precondition:
// - none
//
// Script description:
// - SimRefreshDone
// - parameter: error code
//
[Test]
title MOD_0005_111_2_NokiaTSY_[XML SimRefreshDone ok]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsySimRefreshNowIPC
test SetExpectedCompleteIPC EMmTsySimRefreshDoneIPC
test SendSIMRefreshNtf

test RunIscTestCase 101
test SyncIscTestCase

allownextresult 0
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 506
test SyncIscTestCase
test SimRefreshDone 0

allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_112_2_NokiaTSY_[XML SimRefreshDone fail]
//
// Precondition:
// - none
//
// Script description:
// - SimRefreshDone
// - parameter: error code
//
[Test]
title MOD_0005_112_2_NokiaTSY_[XML SimRefreshDone fail]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsySimRefreshNowIPC
test SetExpectedCompleteIPC EMmTsySimRefreshDoneIPC

test SendSIMRefreshNtf

test RunIscTestCase 101
test SyncIscTestCase

allownextresult 0
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 507
test SyncIscTestCase
test SimRefreshDone 1

allownextresult 0
waittestclass test
delete test
[Endtest]

// MOD_0005_112_1_2_NokiaTSY_[XML SimRefreshDone with caching and fail]
//
// Precondition:
// - none
//
// Script description:
// - SimRefreshDone
// - parameter: error code
//
[Test]
title MOD_0005_112_1_2_NokiaTSY_[XML SimRefreshDone with caching and fail]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsySimRefreshNowIPC
test SetExpectedCompleteIPC EMmTsySimRefreshDoneIPC

test SendSIMRefreshNtf

test RunIscTestCase 102
test SyncIscTestCase

allownextresult 0
pause 1000
waittestclass test

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 666
test SyncIscTestCase
test SimRefreshDone 1

allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_113_2_NokiaTSY_[XML GetSubscriberId]
//
// Precondition:
// - none
//
// Script description:
// - GetSubscriberId
// - parameter: IMSI (for validity checking)
//
[Test]
title MOD_0005_113_2_NokiaTSY_[XML GetSubscriberId]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetSubscriberId
test RunIscTestCase 508
test SyncIscTestCase
test GetSubscriberId 234334009813270
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005_114_2_NokiaTSY_[XML GetServiceProviderName]
//
// Precondition:
// - none
//
// Script description:
// - GetServiceProviderName
// - parameter: display request (1) for validity checking
//
[Test]
title MOD_0005_114_2_NokiaTSY_[XML GetServiceProviderName]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneGetServiceProviderName
test RunIscTestCase 509
test SyncIscTestCase
test GetServiceProviderName 1
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005_117_2_NokiaTSY_[XML ReadSimFile]
//
// Precondition:
// - none
//
// Script description:
// - Read Sim File
// - parameters:
//      master file     0x3F00
//      dedicated file  0x2FE2
//      dedicated file  0x0000
//      elementary file 0x0000
//      offset          0x0000
//      size            0x0000
//
[Test]
title MOD_0005_117_2_NokiaTSY_[XML ReadSimFile]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomReadSimFileIPC
test RunIscTestCase 510
test SyncIscTestCase
test ReadSimFile 16128 12258 0 0 0 0
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_118_2_NokiaTSY_[XML GetSimAuthenticationData SIM]
//
// Precondition:
// - none
//
// Script description:
// -Parameter SIM: gsm security context authentication 
//
[Test]
title MOD_0005_118_2_NokiaTSY_[XML GetSimAuthenticationData SIM]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
pause 1000

test RunIscTestCase 511
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData SIM
allownextresult 0
waittestclass test

delete test
[Endtest]


// MOD_0005_118_3_NokiaTSY_[XML GetSimAuthenticationData SIM invalid APDU]
//
// Precondition:
// - none
//
// Script description:
// -Parameter SIM: gsm security context authentication
//
[Test]
title MOD_0005_118_3_NokiaTSY_[XML GetSimAuthenticationData SIM invalid APDU]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 192
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData SIM
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test

delete test
[Endtest]


// MOD_0005_118_4_NokiaTSY_[XML GetSimAuthenticationData SIM invalid APDU part2]
//
// Precondition:
// - none
//
// Script description:
// -Parameter SIM: gsm security context authentication
//
[Test]
title MOD_0005_118_4_NokiaTSY_[XML GetSimAuthenticationData SIM invalid APDU part2]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 193
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData SIM
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test

delete test
[Endtest]


// MOD_0005_119_2_NokiaTSY_[XML GetSimAuthenticationData AKA]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: forces service type to SIM_ST_EAP_AKA_CONTEXT in
//  SIM_AUTHENTICATION_REQ message.
//
[Test]
title MOD_0005_119_2_NokiaTSY_[XML GetSimAuthenticationData AKA]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 512
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_119_3_NokiaTSY_[XML GetSimAuthenticationData AKA Synchronisation failure]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: forces 3G security contect APDU to be sent to the UICC. UICC
//  retuns with result "synchronisation failure"
//
[Test]
title MOD_0005_119_3_NokiaTSY_[XML GetSimAuthenticationData AKA Synchronisation failure]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 181
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult -3214 //KErrMMEtelSqnVerificationFailed
waittestclass test
delete test
[Endtest]


// MOD_0005_119_4_NokiaTSY_[XML GetSimAuthenticationData AKA Incorrect MAC]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: forces 3G security contect APDU to be sent to the UICC. UICC
//  retuns with result "incorrect MAC"
//
[Test]
title MOD_0005_119_4_NokiaTSY_[XML GetSimAuthenticationData AKA Incorrect MAC]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 182
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult -3213 //KErrMMEtelMacVerificationFailed
waittestclass test
delete test
[Endtest]


// MOD_0005_119_5_NokiaTSY_[XML GetSimAuthenticationData AKA unknown sw1 and sw2]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: forces 3G security contect APDU to be sent to the UICC. UICC
//  retuns with unknown sw1 and sw2
//
[Test]
title MOD_0005_119_5_NokiaTSY_[XML GetSimAuthenticationData AKA unknown sw1 and sw2]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 183
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
delete test
[Endtest]


// MOD_0005_119_6_NokiaTSY_[XML GetSimAuthenticationData AKA without parameter Kc]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: 3G security context authentication. UICC responds with successfull
//  apdu. Reponse doesn't contain parameter Kc
//
[Test]
title MOD_0005_119_6_NokiaTSY_[XML GetSimAuthenticationData AKA without parameter Kc]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 184
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_119_7_NokiaTSY_[XML GetSimAuthenticationData AKA UICC responds with error]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: 3G security context authentication. UICC responds with error
//
[Test]
title MOD_0005_119_7_NokiaTSY_[XML GetSimAuthenticationData AKA UICC responds with error]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 185
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
delete test
[Endtest]


// MOD_0005_119_8_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: 3G security context authentication. UICC responds with invalid
// APDU
//
[Test]
title MOD_0005_119_8_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 186
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
delete test
[Endtest]


// MOD_0005_119_9_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU part2]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: 3G security context authentication. UICC responds with invalid
// APDU part2
//
[Test]
title MOD_0005_119_9_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU part2]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 187
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
delete test
[Endtest]


// MOD_0005_119_10_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU part3]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: 3G security context authentication. UICC responds with invalid
// APDU part3
//
[Test]
title MOD_0005_119_10_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU part3]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 188
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
delete test
[Endtest]


// MOD_0005_119_11_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU part4]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: 3G security context authentication. UICC responds with invalid
// APDU part4
//
[Test]
title MOD_0005_119_11_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU part4]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 189
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
delete test
[Endtest]


// MOD_0005_119_12_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU part5]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: 3G security context authentication. UICC responds with invalid
// APDU part5
//
[Test]
title MOD_0005_119_12_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU part5]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 190
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
delete test
[Endtest]


// MOD_0005_119_13_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU part6]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: 3G security context authentication. UICC responds with invalid
// APDU part6
//
[Test]
title MOD_0005_119_13_NokiaTSY_[XML GetSimAuthenticationData AKA invalid APDU part6]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 191
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
delete test
[Endtest]


// MOD_0005_120_2_NokiaTSY_[XML GetNetworkProviderName]
//
// Precondition:
// - none
// Script description:
// - parameter: NW provider name ( for validity checking )
//
[Test]
title MOD_0005_120_2_NokiaTSY_[XML GetNetworkProviderName]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomGetNetworkProviderNameIPC
test RunIscTestCase 513
test SyncIscTestCase
test GetNetworkProviderName Orange
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005_121_2_NokiaTSY_[XML Authenticate IMS Data]
//
// Precondition:
// - none
//
// Script description:
// -Both input parameters must be 16 bytes length and contain only hexadecimals.
//  First is input for SIM_SB_RAND_PARAMS and second SIM_SB_UMTS_AUTN_PARAMS.
[Test]
title MOD_0005_121_2_NokiaTSY_[XML Authenticate IMS Data]
create NTT_SIM test
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneIMSAuthenticate

test RunIscTestCase 514
test SyncIscTestCase
allownextresult 0
waittestclass test
test AuthenticateIMSData 0101010101010101 1010101010101010
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_121_3_NokiaTSY_[XML Authenticate IMS Data, ISim application not found]
//
// Precondition:
// - none
//
// Script description:
// -Both input parameters must be 16 bytes length and contain only hexadecimals.
//  First is input for RAND params and second for AUTN params.
[Test]
title MOD_0005_121_3_NokiaTSY_[XML Authenticate IMS Data, ISim application not found]
create NTT_SIM test
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneIMSAuthenticate

test RunIscTestCase 200
test SyncIscTestCase
allownextresult 0
waittestclass test
test AuthenticateIMSData 0101010101010101 1010101010101010
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_121_4_NokiaTSY_[XML Authenticate IMS Data with ICC card]
//
// Precondition:
// - none
//
// Script description:
// -Both input parameters must be 16 bytes length and contain only hexadecimals.
//  First is input for RAND params and second for AUTN params.
[Test]
title MOD_0005_121_4_NokiaTSY_[XML Authenticate IMS Data with ICC card]
create NTT_SIM test
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneIMSAuthenticate

test RunIscTestCase 210
test SyncIscTestCase
allownextresult 0
waittestclass test
test AuthenticateIMSData 0101010101010101 1010101010101010
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_121_5_NokiaTSY_[XML Authenticate IMS Data, ISim application already activated]
//
// Precondition:
// - none
//
// Script description:
// -Both input parameters must be 16 bytes length and contain only hexadecimals.
//  First is input for RAND params and second for AUTN params.
[Test]
title MOD_0005_121_5_NokiaTSY_[XML Authenticate IMS Data, ISim application already activated]
create NTT_SIM test
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneIMSAuthenticate
test SetExpectedCompleteIPC EMobilePhoneIMSAuthenticate

test RunIscTestCase 211
test SyncIscTestCase
allownextresult 0
waittestclass test
test AuthenticateIMSData 0101010101010101 1010101010101010
allownextresult 0
waittestclass test
test AuthenticateIMSData 0101010101010101 1010101010101010
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_121_6_NokiaTSY_[XML Authenticate IMS Data, ISim application activation fails]
//
// Precondition:
// - none
//
// Script description:
// -Both input parameters must be 16 bytes length and contain only hexadecimals.
//  First is input for RAND params and second for AUTN params.
[Test]
title MOD_0005_121_6_NokiaTSY_[XML Authenticate IMS Data, ISim application activation fails]
create NTT_SIM test
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC EMobilePhoneIMSAuthenticate

test RunIscTestCase 212
test SyncIscTestCase
allownextresult 0
waittestclass test
test AuthenticateIMSData 0101010101010101 1010101010101010
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_122_2_NokiaTSY_[XML Get IMS Authorization Info]
//
// Precondition:
// -N/A
//
// Script description:
// -N/A
//
[Test]
title MOD_0005_122_2_NokiaTSY_[XML Get IMS Authorization Info]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobilePhoneAuthorizationInfoPhase1
test RunIscTestCase 515
test SyncIscTestCase
test GetIMSAuthorizationInfo
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_123_2_NokiaTSY_[XML Get ALS Blocked Status]
//
// Precondition:
// - none
//
// Script description:
// -Possible results: BlockStatusActive or BlockStatusInactive
//  or EBlockStatusNotSupported.
// -parameter: BlockStatusInactive = 2 (for validity checking )
//
[Test]
title MOD_0005_123_2_NokiaTSY_[XML Get ALS Blocked Status]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomGetAlsBlockedIPC
test RunIscTestCase 516
test SyncIscTestCase
test GetALSBlockedStatus 2
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005_124_2_NokiaTSY_[XML Set ALS Blocked Status Activate]
//
// Precondition:
// - none
// Script description:
// - Set ALS Blocked Status
//
[Test]
title MOD_0005_124_2_NokiaTSY_[XML Set ALS Blocked Status Activate]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomSetAlsBlockedIPC
test RunIscTestCase 517
test SyncIscTestCase
test SetALSBlockedStatus Activate
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_125_2_NokiaTSY_[XML Set ALS Blocked Status Deactivate]
//
// Precondition:
// - none
//
// Script description:
// - Set ALS blocked status
// - parameter: status
//
[Test]
title MOD_0005_125_2_NokiaTSY_[XML Set ALS Blocked Status Deactivate]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomSetAlsBlockedIPC
test RunIscTestCase 518
test SyncIscTestCase
test SetALSBlockedStatus Deactivate
allownextresult 0
waittestclass test
delete test
[Endtest]


// MOD_0005_126_2_NokiaTSY_[XML Check ALS Product Profile Support]
//
// Precondition:
// - none
//
// Script description:
// - Check ALS Product Profile Support
// - parameter: EAlsSupportOff( 1 ), for validity checking
//
[Test]
title MOD_0005_126_2_NokiaTSY_[XML Check ALS Product Profile Support]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomCheckAlsPpSupportIPC
test RunIscTestCase 519
test SyncIscTestCase
test CheckAlsPpSupport 1
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.130_2_NokiaTSY_[XML GBA Bootstrap, OK case]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter GBABOOT: service type for authentication
// -Parameter 1: GBA bootstrap OK case
// -Parameter 1234...: UMTS AUTN params used in request
// -Parameter 1122...: RAND params used in request
// -Parameter 72B1...: waited RES in response
[Test]
title MOD_0005.130_2_NokiaTSY_[XML GBA Bootstrap, OK case]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 130
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOT 1 12345678900009876543210011111112 11223344556677889900112233445566 72B153A772B153A7
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.130.1_2_NokiaTSY_[XML GBA Bootstrap, KErrMMEtelAuthenticateFailed]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter GBABOOT: service type for authentication
// -Parameter 2: GBA bootstrap, authentication fail
// -Parameter 1234...: UMTS AUTN params used in request
// -Parameter 1122...: RAND params used in request
[Test]
title MOD_0005.130.1_2_NokiaTSY_[XML GBA Bootstrap, KErrMMEtelAuthenticateFailed]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 131
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOT 2 12345678900009876543210011111112 11223344556677889900112233445566
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.130.2_2_NokiaTSY_[XML GBA Bootstrap, KErrMMEtelSqnVerificationFailed]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter GBABOOT: service type for authentication
// -Parameter 3 = GBA bootstrap, verification fail
// -Parameter 1234...: UMTS AUTN params used in request
// -Parameter 1122...: RAND params used in request
// -Parameter 0987...: waited AUTS params in response
[Test]
title MOD_0005.130.2_2_NokiaTSY_[XML GBA Bootstrap, KErrMMEtelSqnVerificationFailed]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 132
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOT 3 12345678900009876543210011111112 11223344556677889900112233445566 0987654321123456789009876543
allownextresult -3214 //KErrMMEtelSqnVerificationFailed
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.130.3_2_NokiaTSY_[XML GBA Bootstrap, error]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter GBABOOT: service type for authentication
// -Parameter 1: GBA bootstrap OK case
// -Parameter 1234...: UMTS AUTN params used in request
// -Parameter 1122...: RAND params used in request
[Test]
title MOD_0005.130.3_2_NokiaTSY_[XML GBA Bootstrap, error]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 139
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOT 8 12345678900009876543210011111112 11223344556677889900112233445566
allownextresult -2 // KErrGeneral
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.131_2_NokiaTSY_[XML GBA Bootstrap update, OK case]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter GBABOOTUPDATE: service type for authentication
// -Parameter 6 = GBA update, OK case
// -Parameter 1234...: BTID params used in request
// -Parameter 0011...: KeyLifetime params used in request
// -Parameter 1122...: waited RAND params in response
[Test]
title MOD_0005.131_2_NokiaTSY_[XML GBA Bootstrap update, OK case]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 133
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOTUPDATE 6 12345678900987654321 0011223344556677889900112233445566778899 11223344556677889900112233445566
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.131.1_2_NokiaTSY_[XML GBA Bootstrap update, errors]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter GBABOOTUPDATE: service type for authentication
// -Parameter 6 = GBA update, OK case
// -Parameter 1234...: BTID params used in request
// -Parameter 0011...: KeyLifetime params used in request
[Test]
title MOD_0005.131.1_2_NokiaTSY_[XML GBA Bootstrap update, errors]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 138
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOTUPDATE 7 1234567890098765432155 0011223344556677889900112233445566778899
allownextresult -6 //KErrArgument
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.132_2_NokiaTSY_[XML GBA NAF derivation, OK case]
//
// Precondition:
// -N/A
//
// Script description:
// Script description:
// -Parameter GBABOOTNAFDER: service type for authentication
// -Parameter 4 = GBA NAF derivation, ok case
// -Parameter 1234...: NAF ID used in request
// -Parameter 1111...: private user id used in request
// -Parameter 1122...: waited KsExtNaf in response
[Test]
title MOD_0005.132_2_NokiaTSY_[XML GBA NAF derivation, OK case]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 134
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOTNAFDER 4 12345678900987654321 1111222233330000333322221111 1234004321
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.132.1_2_NokiaTSY_[XML GBA NAF derivation, KErrMMEtelAuthenticateFailed]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter GBABOOTNAFDER: service type for authentication
// -Parameter 5 = GBA NAF derivation, authentication fail case
// -Parameter 1234...: NAF ID used in request
// -Parameter 1111...: private user id used in request
[Test]
title MOD_0005.132.1_2_NokiaTSY_[XML GBA NAF derivation, KErrMMEtelAuthenticateFailed]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 135
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOTNAFDER 5 12345678900987654321 1111222233330000333322221111
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.132.2_2_NokiaTSY_[XML GBA NAF derivation, error]
//
// Precondition:
// -N/A
//
// Script description:
// Script description:
// -Parameter GBABOOTNAFDER: service type for authentication
// -Parameter 9 = GBA NAF derivation, fail case
// -Parameter 1234...: NAF ID used in request
// -Parameter 1111...: private user id used in request
[Test]
title MOD_0005.132.2_2_NokiaTSY_[XML GBA NAF derivation, error]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 160
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOTNAFDER 9 12345678900987654321 1111222233330000333322221111
allownextresult -2 //KErrGeneral
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]

// MOD_0005.132.3_2_NokiaTSY_[XML GBA NAF derivation, KErrNotSupported]
//
// Precondition:
// -N/A
//
// Script description:
// Script description:
// -Parameter GBABOOTNAFDER: service type for authentication
// -Parameter 9 = GBA NAF derivation, fail case
// -Parameter 1234...: NAF ID used in request
// -Parameter 1111...: private user id used in request
[Test]
title MOD_0005.132.3_2_NokiaTSY_[XML GBA NAF derivation, KErrNotSupported]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 162
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOTNAFDER 9 12345678900987654321 1111222233330000333322221111
allownextresult -5 //KErrNotSupported
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.132.4_2_NokiaTSY_[XML GBA NAF derivation, invalid response APDU]
//
// Precondition:
// -N/A
//
// Script description:
// Script description:
// -Parameter GBABOOTNAFDER: service type for authentication
// -Parameter 9 = GBA NAF derivation, fail case
// -Parameter 1234...: NAF ID used in request
// -Parameter 1111...: private user id used in request
[Test]
title MOD_0005.132.4_2_NokiaTSY_[XML GBA NAF derivation, invalid response APDU]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 196
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData GBABOOTNAFDER 9 12345678900987654321 1111222233330000333322221111
allownextresult -2 //KErrGeneral
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.133_2_NokiaTSY_[XML Service support on USIM, available]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter 69: application number on USIM
//  68 = SIM_APP_GBA_AVAIL
//  69 = SIM_APP_MBMS_AVAIL
// -Parameter 1: availability, 0 false, 1 true
[Test]
title MOD_0005.133_2_NokiaTSY_[XML Service support on USIM, available]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomGetServiceTableSupportbyApplication
test RunIscTestCase 136
test SyncIscTestCase
test GetServiceSupport 69 1
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.133.1_2_NokiaTSY_[XML Service support on USIM, error]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter 69: application number on USIM
//  68 = SIM_APP_GBA_AVAIL
//  69 = SIM_APP_MBMS_AVAIL
// -Parameter 1: availability, 0 false, 1 true
[Test]
title MOD_0005.133.1_2_NokiaTSY_[XML Service support on USIM, error]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomGetServiceTableSupportbyApplication
test RunIscTestCase 161
test SyncIscTestCase
test GetServiceSupport 69 1
allownextresult -2 //KErrGeneral
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.134_2_NokiaTSY_[XML Service support on USIM, not available]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter 69: application number on USIM
//  68 = SIM_APP_GBA_AVAIL
//  69 = SIM_APP_MBMS_AVAIL
// -Parameter 0: availability, 0 false, 1 true
[Test]
title MOD_0005.134_2_NokiaTSY_[XML Service support on USIM, not available]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC ECustomGetServiceTableSupportbyApplication
test RunIscTestCase 137
test SyncIscTestCase
test GetServiceSupport 69 0
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.140_2_NokiaTSY_[XML MSK update, OK]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMSKUPDATE: service type for authentication
// -Parameter 11 = MGV, MSK update, ok case
// -Parameter 1234...: Mikey used in request
// -Parameter 0987...: wanted mikey in response
[Test]
title MOD_0005.140_2_NokiaTSY_[XML MSK update, OK]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 140
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMSKUPDATE 11 1234567890000987654321 0987654321001234567890
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.140.1_2_NokiaTSY_[XML MSK update, null Mikey]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMSKUPDATE: service type for authentication
// -Parameter 12 = MGV, MSK update, case when Mikey is null
// -Parameter 1234...: Mikey used in request
[Test]
title MOD_0005.140.1_2_NokiaTSY_[XML MSK update, null Mikey]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 141
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMSKUPDATE 12 1234567890000987654321
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.140.2_2_NokiaTSY_[XML MSK update, error]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMSKUPDATE: service type for authentication
// -Parameter 13 = MGV, MSK update, error case.
// -Parameter 1234...: Mikey used in request
[Test]
title MOD_0005.140.2_2_NokiaTSY_[XML MSK update, error]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 142
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMSKUPDATE 13 1234567890000987654321
allownextresult -8405 //KErrCustomSCNoMemSpaceAvailableAuthError, there is no enough memory on USIM
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.140.3_2_NokiaTSY_[XML MSK update, all failure cases]
//
// Precondition:
// -N/A
//
// Script description:
// - This test case simulates all possible error values received in
//   SIM_SB_AM_HANDLE_ID in case of MGV MSK update
//
[Test]
title MOD_0005.140.3_2_NokiaTSY_[XML MSK update, all failure cases]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
test RunIscTestCase 148
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMSKUPDATE 13 1234567890000987654321
allownextresult -8401 //KErrCustomSCCondOfuseNotSatisfied
waittestclass test
test GetSimAuthenticationData MGVMSKUPDATE 13 1234567890000987654321
allownextresult -8406 //KErrCustomSCNoMemSpaceAvailableMukAuthError
waittestclass test
test GetSimAuthenticationData MGVMSKUPDATE 13 1234567890000987654321
allownextresult -8405 //KErrCustomSCNoMemSpaceAvailableAuthError
waittestclass test
test GetSimAuthenticationData MGVMSKUPDATE 13 1234567890000987654321
allownextresult -8403 //KErrCustomSCIncorrectMACAuthError
waittestclass test
test GetSimAuthenticationData MGVMSKUPDATE 13 1234567890000987654321
allownextresult -8402 //KErrCustomSCRefDataNotFound
waittestclass test
test GetSimAuthenticationData MGVMSKUPDATE 13 1234567890000987654321
allownextresult -2 // KErrGeneral
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.140.4_2_NokiaTSY_[XML MSK update with OMA BCast extension]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMSKUPDATE: service type for authentication
// -Parameter 19 = MGV, MSK update with OMA BCast Extension, ok case
// -Parameter 1234...: Mikey used in request
// -Parameter 0987...: wanted mikey in response
// -Parameter 0D...  : wanted BCast management data in response
// -Parameter 1122...: wanted parental rating data in response
// -Parameter 55  ...: wanted Security Policy Ext data in response
[Test]
title MOD_0005.140.4_2_NokiaTSY_[XML MSK update with OMA BCast extension]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 173
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMSKUPDATE 19 1234567890000987654321 0987654321001234567890 0D 1122 55
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.141_2_NokiaTSY_[XML MTK generation, OK]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMTKGENERATION: service type for authentication
// -Parameter 14 = MGV, MTK generation, ok case
// -Parameter 1234...: Mikey used in request
// -Parameter 0987...: wanted MTK SALT in response
[Test]
title MOD_0005.141_2_NokiaTSY_[XML MTK generation, OK]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 143
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMTKGENERATION 14 1234567890000987654321 09876543210012345678900987654321001234567890
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.141.1_2_NokiaTSY_[XML MTK generation, errors]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMTKGENERATION: service type for authentication
// -Parameter 15 = MGV, MTK generation, error case
// -Parameter 1234...: Mikey used in request
[Test]
title MOD_0005.141.1_2_NokiaTSY_[XML MTK generation, errors]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 144
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMTKGENERATION 15 1234567890000987654321
allownextresult -8404 //KErrCustomSCKeyRefreshFail
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.141.2_2_NokiaTSY_[XML MTK generation, all failure cases]
//
// Precondition:
// -N/A
//
// Script description:
// - This test case simulates all possible error values received in
//   SIM_SB_AM_HANDLE_ID in case of MGV MSK generation
//
[Test]
title MOD_0005.141.2_2_NokiaTSY_[XML MTK generation, all failure cases]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 149
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMTKGENERATION 15 1234567890000987654321
allownextresult -8401 //KErrCustomSCCondOfuseNotSatisfied
waittestclass test
test GetSimAuthenticationData MGVMTKGENERATION 15 1234567890000987654321
allownextresult -8404 //KErrCustomSCKeyRefreshFail
waittestclass test
test GetSimAuthenticationData MGVMTKGENERATION 15 1234567890000987654321
allownextresult -8403 //KErrCustomSCIncorrectMACAuthError
waittestclass test
test GetSimAuthenticationData MGVMTKGENERATION 15 1234567890000987654321
allownextresult -8402 //KErrCustomSCRefDataNotFound
waittestclass test
test GetSimAuthenticationData MGVMTKGENERATION 15 1234567890000987654321
allownextresult -2 // KErrGeneral
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.141.3_2_NokiaTSY_[XML MTK generation with OMA BCast extension (BCast management)]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMTKGENERATION: service type for authentication
// -Parameter 20 = MGV, MTK generation with OMA BCast extension, BCast management data operation, ok case
// -Parameter 1234...: Mikey used in request
// -Parameter 00     : wanted BCasb management data
// -Parameter 1122...: wanted TEK data
// -Parameter 4433...: wanted SALT data
//
//
[Test]
title MOD_0005.141.3_2_NokiaTSY_[XML MTK generation with OMA BCast extension (BCast management)]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 174
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMTKGENERATION 20 1234567890000987654321 00 11223344556677889900112233 4433221100998877665544332211
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.141.4_2_NokiaTSY_[XML MTK generation with OMA BCast extension (parental control operation)]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMTKGENERATION: service type for authentication
// -Parameter 21 = MGV, MTK generation with OMA BCast extension, parental control operation, ok case
// -Parameter 1234...: Mikey used in request
// -Parameter 00     : wanted BCasb management data
// -Parameter 1122...: wanted parental control data
//
//
[Test]
title MOD_0005.141.4_2_NokiaTSY_[XML MTK generation with OMA BCast extension (parental control operation)]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 197
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMTKGENERATION 21 1234567890000987654321 07 223344
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.142_2_NokiaTSY_[XML MSK deletion, ok]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMSKDELETION: service type for authentication
// -Parameter 16 = MGV, MSK deletion, OK case
// -Parameter 110011: domain id used in request
// -Parameter 1234: group id used in request
[Test]
title MOD_0005.142_2_NokiaTSY_[XML MSK deletion, ok]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 145
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMSKDELETION 16 110011 1234
allownextresult 0
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.142.1_2_NokiaTSY_[XML MSK deletion, error]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMSKDELETION: service type for authentication
// -Parameter 17 = MGV, MSK deletion, error case
// -Parameter 110011: domain id used in request
// -Parameter 1234: group id used in request
[Test]
title MOD_0005.142.1_2_NokiaTSY_[XML MSK deletion, error]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 146
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMSKDELETION 17 110011 1234
allownextresult -8402 //KErrCustomSCRefDataNotFound
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.142.2_2_NokiaTSY_[XML MSK deletion, authentication fail]
//
// Precondition:
// -N/A
//
// Script description:
// -Parameter MGVMSKDELETION: service type for authentication
// -Parameter 18 = MGV, MSK deletion, authentication fail
// -Parameter 110011: domain id used in request
// -Parameter 1234: group id used in request
[Test]
title MOD_0005.142.2_2_NokiaTSY_[XML MSK deletion, authentication fail]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 147
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData MGVMSKDELETION 18 110011 1234
allownextresult -3215 // KErrMMEtelAuthenticateFailed
waittestclass test
test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.150_2_NokiaTSY_[XML Read HomeZone Param]
//
// Precondition:
// -N/A
//
// Script description:
// - EReadViagHomeZoneParamsIPC is requested from NTSY
// - NTSY sends SIM_VIAG_HOME_ZONE_REQ(READ_PARAM) to CellMo
// - CellMo responds with SIM_VIAG_HOME_ZONE_RESP(READ_PARAM)
//   response contents
//      {
//      smsc=my_SMSC_number\0,
//      scp=my_SCP_number\0\0,
//      zonever=EA,
//      viagelem[0]=
//          {
//          x=AABBCC01,
//          y=AABBCC10,
//          r2=AABBCC11,
//          id=01,
//          hz=00(Inactive),
//          tag=homezone_A\0\DEAD\BEEF
//          }
//      viagelem[1]=
//          {
//          x=AABBCC02,
//          y=AABBCC20,
//          r2=AABBCC22,
//          id=02,
//          hz=01(HZACtive),
//          tag=homezone_B\0\DEAD\BEEF
//          }
//      viagelem[2]=
//          {
//          x=AABBCC03,
//          y=AABBCC30,
//          r2=AABBCC33,
//          id=03,
//          hz=02(Inactive),
//          tag=homezone_C\0\DEAD\BEEF
//          }
//      viagelem[3]=
//          {
//          x=AABBCC04,
//          y=AABBCC40,
//          r2=AABBCC44,
//          id=04,
//          hz=03(CZActive),
//          tag=homezone_D\0\DEAD\BEEF
//          }
//      }
[Test]
title MOD_0005.150_2_NokiaTSY_[XML Read HomeZone Param]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EReadViagHomeZoneParamsIPC

test RunIscTestCase 164
test SyncIscTestCase

test ViagHomeZoneReadParam my_SMSC_number my_SCP_number EA AABBCC01 AABBCC10 AABBCC11 1 Inactive homezone_A AABBCC02 AABBCC20 AABBCC22 2 HZActive homezone_B AABBCC03 AABBCC30 AABBCC33 3 Inactive homezone_C AABBCC04 AABBCC40 AABBCC44 4 CZActive homezone_D

allownextresult 0 // KErrNone
waittestclass test // EReadViagHomeZoneParamsIPC

test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.151_2_NokiaTSY_[XML Read HomeZone Cache]
//
// Precondition:
// -N/A
//
// Script description:
// - EReadViagHomeZoneCacheIPC is requested from NTSY
// - NTSY sends SIM_VIAG_HOME_ZONE_REQ(READ_CACHE) to CellMo
//   request contents
//      {
//      cacheid=04
//      recnum=06
//      }
// - CellMo responds with SIM_VIAG_HOME_ZONE_RESP(READ_CACHE)
//   response contents
//      {
//      lac=AABB,
//      cellid=CCDD
//      }
[Test]
title MOD_0005.151_2_NokiaTSY_[XML Read HomeZone Cache]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EReadViagHomeZoneCacheIPC

test RunIscTestCase 165
test SyncIscTestCase

test ViagHomeZoneReadCache 04 06 AABB CCDD

allownextresult 0 // KErrNone
waittestclass test // EReadViagHomeZoneCacheIPC

test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.152_2_NokiaTSY_[XML Write HomeZone Settings]
//
// Precondition:
// -N/A
//
// Script description:
// - EWriteViagHomeZoneUHZIUESettingsIPC is requested from NTSY
// - NTSY sends SIM_VIAG_HOME_ZONE_REQ(SIM_ST_WRITE_UHZIUE_SETTINGS) to CellMo
//   request contents
//      {
//      set=CE,
//      ver=05
//      }
// - CellMo responds with SIM_VIAG_HOME_ZONE_RESP(SIM_ST_WRITE_UHZIUE_SETTINGS)
[Test]
title MOD_0005.152_2_NokiaTSY_[XML Write HomeZone Settings]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EWriteViagHomeZoneUHZIUESettingsIPC

test RunIscTestCase 166
test SyncIscTestCase

test ViagHomeZoneWriteSettings CE 05

allownextresult 0 // KErrNone
waittestclass test // EWriteViagHomeZoneUHZIUESettingsIPC

test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.153_2_NokiaTSY_[XML Write HomeZone Cache]
//
// Precondition:
// -N/A
//
// Script description:
// - EWriteViagHomeZoneCacheIPC is requested from NTSY
// - NTSY sends SIM_VIAG_HOME_ZONE_REQ(WRITE_CACHE) to CellMo
//   request contents
//      {
//      cacheid=04,
//      recnum=09,
//      lac=BBAA,
//      cellid=CCDD
//      }
// - CellMo responds with SIM_VIAG_HOME_ZONE_RESP(WRITE_CACHE)
[Test]
title MOD_0005.153_2_NokiaTSY_[XML Write HomeZone Cache]
create NTT_SIM test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EWriteViagHomeZoneCacheIPC

test RunIscTestCase 167
test SyncIscTestCase

test ViagHomeZoneWriteCache 04 09 BBAA CCDD

allownextresult 0 // KErrNone
waittestclass test // EWriteViagHomeZoneCacheIPC

test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0005.154_2_NokiaTSY_[XML SimRefresh OPL, PNN and ONS records success case]
//
// Precondition:
// - none
//
// Script description:
//
[Test]
title MOD_0005.154_2_NokiaTSY_[XML SimRefresh OPL, PNN and ONS records success case]
create NTT_SIM test

test SetOperInfoAPAC OperInfoLATIN

test RunIscTestCaseStartNTSYAfterTestToolStart 169
test SyncIscTestCaseStartNTSYAfterTestToolStart

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 170
test SyncIscTestCase

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 171
test SyncIscTestCase

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

delete test
[Endtest]


// MOD_0005.155_2_NokiaTSY_[XML SimRefresh OPL, PNN and ONS records fail case]
//
// Precondition:
// - none
//
// Script description:
//
[Test]
title MOD_0005.155_2_NokiaTSY_[XML SimRefresh OPL, PNN and ONS records fail case]
create NTT_SIM test

test SetOperInfoAPAC OperInfoLATIN

test RunIscTestCaseStartNTSYAfterTestToolStart 169
test SyncIscTestCaseStartNTSYAfterTestToolStart

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 170
test SyncIscTestCase

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 172
test SyncIscTestCase

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

delete test
[Endtest]


// MOD_0005_160_2_NokiaTSY_[XML GetSimAuthenticationData SIM with ICC card]
//
// Precondition:
// - none
//
// Script description:
// -Parameter SIM: gsm security context authentication 
//
[Test]
title MOD_0005_160_2_NokiaTSY_[XML GetSimAuthenticationData SIM with ICC card]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 198
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData SIM
allownextresult 0
waittestclass test

delete test
[Endtest]


// MOD_0005_161_2_NokiaTSY_[XML GetSimAuthenticationData AKA with ICC card]
//
// Precondition:
// - none
//
// Script description:
// -Parameter AKA: forces service type to SIM_ST_EAP_AKA_CONTEXT in
//  SIM_AUTHENTICATION_REQ message.
//
[Test]
title MOD_0005_161_2_NokiaTSY_[XML GetSimAuthenticationData AKA with ICC card]
create NTT_SIM test
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMmTsyBootNotifySimStatusReadyIPC
test SetExpectedCompleteIPC ECustomGetSimAuthenticationDataIPC

test RunIscTestCase 199
test SyncIscTestCase
allownextresult 0
waittestclass test
test GetSimAuthenticationData AKA
allownextresult 0
waittestclass test
delete test
[Endtest]
