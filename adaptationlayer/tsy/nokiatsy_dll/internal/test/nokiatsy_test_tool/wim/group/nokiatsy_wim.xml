<?xml version="1.0" encoding="utf-8" ?>
<isc-test-control id="1">



  <!-- Channels that are opened during startup and closed when test environment exits -->
  <channels>
  </channels>

  <!-- Test inputs are declared here -->
  <inputs>

    <input id="1000">
      <name>APDU_RESP APDU_ST_POWER_ON</name>
      <direction>sos</direction>
      <message>1E,10,00,48,00,06,00,00,06,BF,04,3D</message>
    </input>

    <input id="1001">
      <name>APDU_RESP APDU_ST_POWER_OFF</name>
      <direction>sos</direction>
      <message>1E,10,00,48,00,06,00,00,06,BF,03,3D</message>
    </input>

    <input id="1002">
      <name>APDU_RESP APDU_ST_WARM_RESET</name>
      <direction>sos</direction>
      <message>1E,10,00,48,00,06,00,00,06,BF,06,3D</message>
    </input>

    <input id="1003">
      <name>APDU_RESP APDU_ST_GET_ATR</name>
      <direction>sos</direction>
      <message>1E,10,00,48,00,12,00,00,06,BF,50,3D,00,00,00,05,4E,4F,4B,49,41,00,00,00</message>
    </input>

    <input id="1004">
      <name>APDU_RESP APDU_ST_GET_LIST</name>
      <direction>sos</direction>
      <message>1E,10,00,48,00,12,00,00,06,BF,51,3D,00,00,00,08,00,01,02,03,04,05,06,07</message>
    </input>

    <input id="1005">
      <name>APDU_RESP APDU_ST_SEND_APDU</name>
      <direction>sos</direction>
      <message>1E,10,00,48,00,12,00,00,06,BF,4F,3D,00,07,A0,A4,01,00,02,6F,7E,00,00,00</message>
    </input>

    <input id="1006">
      <name>APDU_RESP APDU_ST_SEND_APDU</name>
      <direction>sos</direction>
      <message>1E,10,00,48,00,12,00,00,07,BF,4F,3D,00,07,A0,A4,01,00,02,6F,7E,00,00,00</message>
    </input>

  </inputs>


  <!-- Test outputs are declared here -->
  <outputs>

   <output id="3000">
     <name>APDU_REQ APDU_ST_POWER_ON</name>
     <direction>dos</direction>
     <message>00,00,00,48,00,06,00,00,06,BE,04,00</message>
        <mask>00,00,00,00,00,00,00,00,ff,ff,ff,ff</mask>
   </output>

   <output id="3001">
     <name>APDU_REQ APDU_ST_POWER_OFF</name>
     <direction>dos</direction>
     <message>00,00,00,48,00,06,00,00,06,BE,03,00</message>
        <mask>00,00,00,00,00,00,00,00,ff,ff,ff,ff</mask>
   </output>

   <output id="3002">
     <name>APDU_REQ APDU_ST_WARM_RESET</name>
     <direction>dos</direction>
     <message>00,00,00,48,00,06,00,00,06,BE,06,00</message>
        <mask>00,00,00,00,00,00,00,00,ff,ff,ff,ff</mask>
   </output>

   <output id="3003">
     <name>APDU_REQ APDU_ST_GET_ATR</name>
     <direction>dos</direction>
     <message>00,00,00,48,00,06,00,00,06,BE,50,00</message>
        <mask>00,00,00,00,00,00,00,00,ff,ff,ff,ff</mask>
   </output>

   <output id="3004">
     <name>APDU_REQ APDU_ST_GET_LIST</name>
     <direction>dos</direction>
     <message>00,00,00,48,00,06,00,00,06,BE,51,00</message>
        <mask>00,00,00,00,00,00,00,00,ff,ff,ff,ff</mask>
   </output>

   <output id="3005">
     <name>APDU_REQ APDU_ST_SEND_APDU</name>
     <direction>dos</direction>
     <message>00,00,00,48,00,11,00,00,06,BE,4F,01,01,00,00,07,A0,A4,01,00,02,6F,7E</message>
        <mask>00,00,00,00,00,00,00,00,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff</mask>
   </output>

   <output id="3006">
     <name>APDU_REQ APDU_ST_SEND_APDU</name>
     <direction>dos</direction>
     <message>00,00,00,09,00,11,00,00,07,BE,4F,00,01,00,00,07,A0,A4,01,00,02,6F,7E</message>
        <mask>00,00,00,00,00,00,00,00,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff</mask>
   </output>

  </outputs>


  <!-- Test filters are declared here -->
  <filters>
  </filters>


  <!-- Test steps are declared here -->
  <steps>


    <!-- Open channel steps are used to attach the ISC test controller to an existing ISC channel -->
    <step id="2001" type="open-channel">
      <name>Open TSY channel</name>
      <channel id="0x07"/>
    </step>

    <!-- Close channel steps are used to detach the ISC test controller from an existing ISC channel -->
    <step id="2002" type="close-channel">
      <name>Close TSY channel</name>
      <channel id="0x07"/>
    </step>

    <!-- Synchronization step is used to synchronize with -->
    <!-- the test cases of the adaptation test environment -->
    <step id="2003" type="sync">
      <name>Sync ( ignore messages )</name>
      <flags>1</flags>
    </step>

    <step id="11000" type="simulate">
      <name>APDU_RESP APDU_ST_POWER_ON</name>
      <channel id="0x07"/>
      <input-ref id="1000"/>
    </step>

    <step id="11001" type="simulate">
      <name>APDU_RESP APDU_ST_POWER_OFF</name>
      <channel id="0x07"/>
      <input-ref id="1001"/>
    </step>

    <step id="11002" type="simulate">
      <name>APDU_RESP APDU_ST_WARM_RESET</name>
      <channel id="0x07"/>
      <input-ref id="1002"/>
    </step>

    <step id="11003" type="simulate">
      <name>APDU_RESP APDU_ST_GET_ATR</name>
      <channel id="0x07"/>
      <input-ref id="1003"/>
    </step>

    <step id="11004" type="simulate">
      <name>APDU_RESP APDU_ST_GET_LIST</name>
      <channel id="0x07"/>
      <input-ref id="1004"/>
    </step>

    <step id="11005" type="simulate">
      <name>APDU_RESP APDU_ST_SEND_APDU</name>
      <channel id="0x07"/>
      <input-ref id="1005"/>
    </step>

    <step id="11006" type="simulate">
      <name>APDU_RESP APDU_ST_SEND_APDU</name>
      <channel id="0x07"/>
      <input-ref id="1006"/>
    </step>

    <step id="13000" type="intercept">
      <name>APDU_REQ APDU_ST_POWER_ON</name>
      <channel id="0x07"/>
      <output-ref id="3000"/>
    </step>

     <step id="13001" type="intercept">
      <name>APDU_REQ APDU_ST_POWER_OFF</name>
      <channel id="0x07"/>
      <output-ref id="3001"/>
    </step>

     <step id="13002" type="intercept">
      <name>APDU_REQ APDU_ST_WARM_RESET</name>
      <channel id="0x07"/>
      <output-ref id="3002"/>
    </step>

     <step id="13003" type="intercept">
      <name>APDU_REQ APDU_ST_GET_ATR</name>
      <channel id="0x07"/>
      <output-ref id="3003"/>
    </step>

     <step id="13004" type="intercept">
      <name>APDU_REQ APDU_ST_GET_LIST</name>
      <channel id="0x07"/>
      <output-ref id="3004"/>
    </step>

     <step id="13005" type="intercept">
      <name>APDU_REQ APDU_ST_SEND_APDU</name>
      <channel id="0x07"/>
      <output-ref id="3005"/>
    </step>

     <step id="13006" type="intercept">
      <name>APDU_REQ APDU_ST_SEND_APDU</name>
      <channel id="0x07"/>
      <output-ref id="3006"/>
    </step>

  </steps>


  <!-- Test step groups are declared here. Step groups must not have same ID's as steps -->

  <!-- Intercept steps can be grouped to receive messages in undetermined order. -->
  <groups>
  </groups>

  <!-- Test cases are declared here -->

  <!-- step-ref elements are used to reference the test steps of the test case -->
  <cases>

    <case id="101">
      <name>PoweringSimOn 101</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="13000"/> <!-- APDU_REQ APDU_ST_POWER_ON intercept -->
        <step-ref id="11000"/> <!-- APDU_RESP APDU_ST_POWER_ON -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

    <case id="102">
      <name>PoweringSimOff 102</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="13001"/> <!-- APDU_REQ APDU_ST_POWER_OFF intercept -->
        <step-ref id="11001"/> <!-- APDU_RESP APDU_ST_POWER_OFF -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

    <case id="103">
      <name>SIMWarmReset 103</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="13002"/> <!-- APDU_REQ APDU_ST_WARM_RESET intercept -->
        <step-ref id="11002"/> <!-- APDU_RESP APDU_ST_WARM_RESET -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

    <case id="104">
      <name>GetAnswerToResetStatus 104</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="13003"/> <!-- APDU_REQ APDU_ST_GET_ATR intercept -->
        <step-ref id="11003"/> <!-- APDU_RESP APDU_ST_GET_ATR -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

    <case id="105">
      <name>GetSIMCardReaderStatus 105</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="13004"/> <!-- APDU_REQ APDU_ST_GET_LIST intercept -->
        <step-ref id="11004"/> <!-- APDU_RESP APDU_ST_GET_LIST -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

    <case id="106">
      <name>SendAPDU 106</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="13005"/> <!-- APDU_REQ APDU_ST_SEND_APDU intercept -->
        <step-ref id="11005"/> <!-- APDU_RESP APDU_ST_SEND_APDU -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

    <case id="107">
      <name>SendAPDURequest 107</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="13006"/> <!-- APDU_REQ APDU_ST_SEND_APDU intercept -->
        <step-ref id="11006"/> <!-- APDU_RESP APDU_ST_SEND_APDU -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

  </cases>

</isc-test-control>
