//* Copyright (c) 2009 Nokia Corporation and/or its subsidiary(-ies).
//* All rights reserved.
//* This component and the accompanying materials are made available
//* under the terms of the License "Eclipse Public License v1.0"
//* which accompanies this distribution, and is available
//* at the URL "http://www.eclipse.org/legal/epl-v10.html".
//*
//* Initial Contributors:
//* Nokia Corporation - initial contribution.
//*
//* Contributors:
//*
//* Description:
//*



// MOD_0003_001_2_NokiaTSY_[XML MO call connects - terminated by local user with valid values]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_001_2_NokiaTSY_[XML MO call connects - terminated by local user with valid values]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo release

test RunIscTestCase 114
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0504804405

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

print Answer the call --->

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

test CallHangUp 1 //CallId

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

allownextresult -8071 //KErrGsmReleaseByUser
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_002_2_NokiaTSY_[XML MO call connects (EDontSendMyId) - terminated by local user with valid values]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 2=EDontSendMyId
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_002_2_NokiaTSY_[XML MO call connects (EDontSendMyId) - terminated by local user with valid values]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomTerminateCallIPC

test RunIscTestCase 115
test SyncIscTestCase

test CallDial 1 0 0 1 0 2 1 0000 0 1 1 0504804405

//EMobileCallNotifyMobileCallStatusChange create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange mo alerting
allownextresult 0
waittestclass test

print Answer the call --->

test CallHangUp 1 //CallId

//ECustomTerminateCallIPC
allownextresult -8071 //KErrGsmReleaseByUser
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0003_002_2_2_NokiaTSY_[XML MO call connects (ESendMyId) - terminated by local user with valid values]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 1=ESendMyId
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_002_2_2_NokiaTSY_[XML MO call connects (ESendMyId) - terminated by local user with valid values]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomTerminateCallIPC

test RunIscTestCase 132
test SyncIscTestCase

test CallDial 1 0 0 1 0 1 1 0000 0 1 1 0504804405

//EMobileCallNotifyMobileCallStatusChange create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange mo alerting
allownextresult 0
waittestclass test

print Answer the call --->

test CallHangUp 1 //CallId

//ECustomTerminateCallIPC
allownextresult -8071 //KErrGsmReleaseByUser
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_003_2_NokiaTSY_[XML MO call connects - remote party rejects call]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_003_2_NokiaTSY_[XML MO call connects - remote party rejects call]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mt release
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //idle

test RunIscTestCase 116
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0504804405

//EMobileCallNotifyMobileCallStatusChange create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

print Answer the call --->

//EMobileCallNotifyMobileCallStatusChange active
allownextresult 0
waittestclass test

print Reject the call

test RemotePartyHangUp

//EMobileCallNotifyMobileCallStatusChange mt release
allownextresult -280887298 //Symbian OS error
waittestclass test

//EMobileCallNotifyMobileCallStatusChange idle
allownextresult -280887298 //Symbian OS error
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0003_004_2_NokiaTSY_[XML MO call - Send DTMF tones]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_004_2_NokiaTSY_[XML MO call - Send DTMF tones]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EMobilePhoneNotifyDTMFEvent // active
test SetExpectedCompleteIPC EMobilePhoneSendDTMFTones
test SetExpectedCompleteIPC EMobilePhoneNotifyDTMFEvent // idle

test RunIscTestCase 117
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0504804405

//EMobileCallNotifyMobileCallStatusChange create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

print Answer the call --->
//EMobileCallNotifyMobileCallStatusChange active
allownextresult 0
waittestclass test

print Sending DTMF tones
test SendDTMFTones 1212121254

print DTMF sending ongoing...
//EMobilePhoneNotifyDTMFEvent active
allownextresult 0
waittestclass test

//EMobilePhoneSendDTMFTones
allownextresult 0
waittestclass test

print DTMF sending stopped
//EMobilePhoneNotifyDTMFEvent idle
allownextresult 0
waittestclass test

print HangUp ongoing call
test CallHangUp 1 //CallId

test HandleSpecifiedRequests NO
delete test
[Endtest]


// MOD_0003_005_2_NokiaTSY_[XML Incoming call while there are no other calls]
// Make incoming call to the test phone
//
// Precondition:
// - n/a
//
// Script description:
// - n/a
//
[Test]
title MOD_0003_005_2_NokiaTSY_[XML Incoming call while there are no other calls]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mt alerting

test RunIscTestCase 118
test SyncIscTestCase

test TestIncomingCall
//EMobileCallNotifyMobileCallStatusChange mt alerting

allownextresult 0
waittestclass test
test CallHangUp 1 //CallId

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_006_2_NokiaTSY_[XML Holding a voice call]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_006_2_NokiaTSY_[XML Holding a voice call]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //hold

test RunIscTestCase 119
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 +358504804405

//EMobileCallNotifyMobileCallStatusChange //create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //active
allownextresult 0
waittestclass test

test TestHoldCall 1 //callId

//EMobileCallNotifyMobileCallStatusChange //hold
allownextresult 0
waittestclass test

test CallHangUp 1 //CallId

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0003_007_2_NokiaTSY_[XML Resuming a call]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_007_2_NokiaTSY_[XML Resuming a call]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //hold
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active

test RunIscTestCase 120
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 +358504804405

//EMobileCallNotifyMobileCallStatusChange //create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //active
allownextresult 0
waittestclass test

test TestHoldCall 1 //callId

//EMobileCallNotifyMobileCallStatusChange //hold
allownextresult 0
waittestclass test

test TestResumeCall 1 //callId

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //active
allownextresult 0
waittestclass test

test CallHangUp 1 //CallId

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_008_2_NokiaTSY_[XML Swapping active and held voice calls]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_008_2_NokiaTSY_[XML Swapping active and held voice calls]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //hold
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //hold

test RunIscTestCase 121
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0504804405

//EMobileCallNotifyMobileCallStatusChange //create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //active
allownextresult 0
waittestclass test

test TestHoldCall 1 //callId

//EMobileCallNotifyMobileCallStatusChange //hold
allownextresult 0
waittestclass test

test CallDial 2 0 0 1 0 0 1 0000 0 1 1 04544186407

//EMobileCallNotifyMobileCallStatusChange //create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //active
allownextresult 0
waittestclass test

test TestSwapCalls 1 //callId

//EMobileCallNotifyMobileCallStatusChange //hold
allownextresult 0
waittestclass test

test CallHangUp 1 //CallId
test CallHangUp 2 //CallId

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_009_2_NokiaTSY_[XML Call Transfering]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
//  Also supply a second phone number for call 2
//
[Test]
title MOD_0003_009_2_NokiaTSY_[XML Call Transfering]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //hold
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mt release

test RunIscTestCase 122
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0504804405

//EMobileCallNotifyMobileCallStatusChange //create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //active
allownextresult 0
waittestclass test

test TestHoldCall 1 //callId

//EMobileCallNotifyMobileCallStatusChange //hold
allownextresult 0
waittestclass test

test CallDial 2 0 0 1 0 0 1 0000 0 1 1 04544186407

//EMobileCallNotifyMobileCallStatusChange //create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //active
allownextresult 0
waittestclass test

test TestCallTransfer 1 //callId

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //mt release
allownextresult -280887298
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_010_2_NokiaTSY_[XML Blacklist clearing]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_010_2_NokiaTSY_[XML Blacklist clearing]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC ECustomClearCallBlackListIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active

test RunIscTestCase 123
test SyncIscTestCase

test ClearBlacklist

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0504804405

//ECustomClearCallBlackListIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //active
allownextresult 0
waittestclass test

test CallHangUp 1 //CallId

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_011_2_NokiaTSY_[XML Verify Remote Alerting Tone Status Change, Call goes active]
//
// Precondition:
// - 2 Phones needed
//
// Script description:
// - VerifyRemoteAlertingToneStatus
//   Params:
//    Additional condition to verify
//      Connecting
//      None
//      LocalTone
//      RemoteTone
//
// - CallHangUp
//   Params:
//    call id
//
//
[Test]
title MOD_0003_011_2_NokiaTSY_[XML Verify Remote Alerting Tone Status Change, Call goes active]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange // create
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange // mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange // active
test SetExpectedCompleteIPC ECustomTerminateCallIPC

test RunIscTestCase 112
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0101111111

test VerifyRemoteAlertingToneStatus Connecting

// EMobileCallNotifyMobileCallStatusChange / create
allownextresult 0
waittestclass test

// ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

test VerifyRemoteAlertingToneStatus None

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 113
test SyncIscTestCase

// EMobileCallNotifyMobileCallStatusChange / mo alerting
allownextresult 0
waittestclass test

// ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

// EMobileCallNotifyMobileCallStatusChange / active
allownextresult 0
waittestclass test

test CallHangUp 1 //CallId

// ECustomTerminateCallIPC
allownextresult -8071 //KErrGsmReleaseByUser
waittestclass test

test HandleSpecifiedRequests NO

delete test

[Endtest]


// MOD_0003_012_2_NokiaTSY_[XML Emergency Call, no other calls]
//
// Precondition:
// - NCP_COMMON_HSDPA_EMERGCALL_WORKAROUND defined
// - XML case
// - Make sure that phone is not attached
//   because otherwise emergency call may be actually made
//
// Script description:
// - DialEmergencyCall
// - Contexts are cleared by sending GPDS_CONTEXTS_CLEAR_REQ
//   Params:
//      Destination_address
//
[Test]
title MOD_0003_012_2_NokiaTSY_[XML Emergency Call, no other calls]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange

test RunIscTestCase 101
test SyncIscTestCase

//emergency number
test DialEmergencyCall 112

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_013_2_NokiaTSY_[XML Emergency Call, other calls]
//
// Precondition:
// - NCP_COMMON_HSDPA_EMERGCALL_WORKAROUND defined
// - XML case
// - Make sure that phone is not attached
//   because otherwise emergency call may be actually made
//
// Script description:
// - DialEmergencyCall
// - Contexts are cleared by sending GPDS_CONTEXTS_CLEAR_REQ
// - Indications of termination of the other calls are received
//
//   Params:
//      Destination_address
//
[Test]
title MOD_0003_013_2_NokiaTSY_[XML Emergency Call, other calls]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange

test RunIscTestCase 102
test SyncIscTestCase

//emergency number
test DialEmergencyCall 112

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_014_2_NokiaTSY_[XML Emergency Call, no other calls, timeout when waiting for GPDS_CONTEXTS_CLEAR_RESP]
//
// Precondition:
// - NCP_COMMON_HSDPA_EMERGCALL_WORKAROUND defined
// - XML case
// - Make sure that phone is not attached
//   because otherwise emergency call may be actually made
//
// Script description:
// - DialEmergencyCall.
// - Contexts are cleared by sending GPDS_CONTEXTS_CLEAR_REQ, answer message
//   GPDS_CONTEXTS_CLEAR_RESP is late and timer elapses in Nokia TSY
// - Emergency call is established succesfully.
//
//   Params:
//      Destination_address
//
[Test]
title MOD_0003_014_2_NokiaTSY_[XML Emergency Call, no other calls, timeout when waiting for GPDS_CONTEXTS_CLEAR_RESP]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange

test RunIscTestCase 103
test SyncIscTestCase

//emergency number
test DialEmergencyCall 112

// Test control is now waiting for CALL_MODEM_CREATE_REQ which will be issued
// after timer expires

// Establish emergency call normally

// EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

// EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

// ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

// EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_015_2_NokiaTSY_[XML Emergency Call, no other calls, HSDPA Disabled In Product Profile]
//
// Precondition:
// - XML case
// - Make sure that phone is not attached
//   because otherwise emergency call may be actually made
//
// Script description:
// - HSDPA is disabled in the product profile. That information is taken from the response
//   INFO_PP_DATA_READ_RESP (request has been sent in CMmCallMessHandler::ConstructL())
// - DialEmergencyCall
// - Context
//
//   Params:
//      Destination_address
//
[Test]
title MOD_0003_015_2_NokiaTSY_[XML Emergency Call, no other calls, HSDPA Disabled In Product Profile]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active

// INFO_PP_DATA_READ_REQ / INFO_PP_DATA_READ_RESP
// INFO_PP_DATA_READ_REQ is intercepted from boot.
test RunIscTestCaseStartNTSYAfterTestToolStart 104
test SyncIscTestCaseStartNTSYAfterTestToolStart

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

test RunIscTestCase 105
test SyncIscTestCase

//emergency number
test DialEmergencyCall 112

// EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

// EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

// ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

// EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0003_016_2_NokiaTSY_[XML Emergency Call, other calls, incoming call and termination of it]
//
// Precondition:
// - NCP_COMMON_HSDPA_EMERGCALL_WORKAROUND defined
// - XML case
// - Make sure that phone is not attached
//   because otherwise emergency call may be actually made
//
// Script description:
// - DialEmergencyCall
// - Contexts are cleared by sending GPDS_CONTEXTS_CLEAR_REQ
// - Indications of termination of the other calls are received
//
//   Params:
//      Destination_address
//
[Test]
title MOD_0003_016_2_NokiaTSY_[XML Emergency Call, other calls, incoming call and termination of it]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC MUST_BE_NEXT_IPC // This IPC MUST be this in this case.
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange

test RunIscTestCase 106
test SyncIscTestCase

//emergency number
test DialEmergencyCall 112

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0003_017_2_NokiaTSY_[XML MO call - with Local Ring Back Tone and Call Ring Tone, case1]
//
// Precondition:
// - n/a
//
// Script description:
// - VerifyRemoteAlertingToneStatus
//   Params:
//    Additional condition to verify
//      Connecting
//      None
//      LocalTone
//      RemoteTone
//
// - CallDial
//   Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0101111111=TelNum
//
[Test]
title MOD_0003_017_2_NokiaTSY_[XML MO call - with Local Ring Back Tone and Call Ring Tone, case1]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

//CALL_STATUS_IND
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //call_status_create
//CALL_MO_ALERT_IND
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC   //remote alerting tone locally
//CALL_STATUS_IND
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //call_status_mo_alerting
//CALL_GSM_NOTIFICATION_IND
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC   //remote alerting tone network
//CALL_STATUS_IND
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //call_status_active
//CALL_STATUS_IND
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //call_status_mo_release

test RunIscTestCase 130
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0101111111

test VerifyRemoteAlertingToneStatus LocalTone

//EMobileCallNotifyMobileCallStatusChange //call_status_create
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC //remote alerting tone locally
allownextresult 0
waittestclass test

test VerifyRemoteAlertingToneStatus RemoteTone

// Synchronize test case
test SyncIscTestCase

//EMobileCallNotifyMobileCallStatusChange //call_status_mo_alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC //remote alerting tone network
allownextresult 0
waittestclass test

test VerifyRemoteAlertingToneStatus None

// Synchronize test case
test SyncIscTestCase

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //call_status_active
allownextresult 0
waittestclass test

test CallHangUp 1 //CallId

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //call_status_mo_release
allownextresult -8071 //KErrGsmReleaseByUser
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_018_2_NokiaTSY_[XML MO call - with Local Ring Back Tone and Call Ring Tone, case2]
//
// Precondition:
// - n/a
//
// Script description:
// - VerifyRemoteAlertingToneStatus
//   Params:
//    Additional condition to verify
//      Connecting
//      None
//      LocalTone
//      RemoteTone
//
// - CallDial
//   Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0101111111=TelNum
//
[Test]
title MOD_0003_018_2_NokiaTSY_[XML MO call - with Local Ring Back Tone and Call Ring Tone, case2]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

//CALL_STATUS_IND
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //call_status_create
//CALL_MO_ALERT_IND
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC   //remote alerting tone network
//CALL_STATUS_IND
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //call_status_mo_alerting
//CALL_GSM_NOTIFICATION_IND
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC   //remote alerting tone locally
//CALL_STATUS_IND
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //call_status_active
//CALL_STATUS_IND
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //call_status_mo_release

test RunIscTestCase 131
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0101111111

test VerifyRemoteAlertingToneStatus RemoteTone

//EMobileCallNotifyMobileCallStatusChange //call_status_create
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC //remote alerting tone network
allownextresult 0
waittestclass test

test VerifyRemoteAlertingToneStatus LocalTone

// Synchronize test case
test SyncIscTestCase

//EMobileCallNotifyMobileCallStatusChange //call_status_mo_alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC //remote alerting tone locally
allownextresult 0
waittestclass test

test VerifyRemoteAlertingToneStatus None

// Synchronize test case
test SyncIscTestCase

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //call_status_active
allownextresult 0
waittestclass test

test CallHangUp 1 //CallId

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange //call_status_mo_release
allownextresult -8071 //KErrGsmReleaseByUser
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_030_2_NokiaTSY_[XML MO call with UUS]
//
// Precondition:
// - Pure XML case
// - Make sure that phone is not attached
//   because otherwise call may be actually made
//
// Script description:
// - Test tries first to activate UUS with given data. If activation
//   success, test calls to given number with given parameters. Call
//   is simulated with XML.
//
//   Params:
//      ActivateUUS: 1 - UUS type - KUUS1Implicit, only supported
//                   ABCD - UUS data, this must be same than defined in XML
//      CallDial: just same than in MOD_0003_001_NokiaTSY, don't change these.
//
[Test]
title MOD_0003_030_2_NokiaTSY_[XML MO call with UUS]
create NTT_Voice test
test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create

test RunIscTestCase 110
test SyncIscTestCase

test ActivateUUS 1 ABCD

// DO NOT CHANGE following parameters
test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0123456789

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_031_2_NokiaTSY_[XML MT call with UUS]
//
// Precondition:
// - Pure XML case
// - Make sure that phone is not attached
//
// Script description:
// - Test simulates incoming (MT) call with UUS information. Call is simulated
//   from CALL_STATUS_IDLE to CALL_STATUS_MT_ALERTING. After that call establishment
//   continues just as without UUS information.
//
//   Params: none
//
[Test]
title MOD_0003_031_2_NokiaTSY_[XML MT call with UUS]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EEtelLineNotifyIncomingCall
test SetExpectedCompleteIPC EMobileCallReceiveUUI
test SetExpectedCompleteIPC EMobileCallGetMobileCallInfo
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange

test RunIscTestCase 111
test SyncIscTestCase

test IncomingCallWithUUS ABCD

//EEtelLineNotifyIncomingCall
allownextresult 0
waittestclass test

// EMobileCallReceiveUUI
allownextresult 0
waittestclass test

// EMobileCallGetMobileCallInfo
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]


// MOD_0003_032_2_NokiaTSY_[XML Call terminated, barred network (DSAC)]
//
// Precondition:
// - The feature under test (DCM DSAC) is flagged in NTSY, because it is supported only
//   in cellmo version ICPR71. This test case cannot be run in MCL before DSAC support is
//   added to current cellmo version and flagging is removed from NTSY codes.
//   If this test case is needed to be run anyway, flagging
//   'NCP_COMMON_CELLMO_BRANCH_SUPPORT == NCP_COMMON_CELLMO_BRANCH_0711' must be removed from
//   cmmcallmesshandler.cpp and DSAC definition must be added to callisi.h:
//   #define CALL_DSAC_RESTRICTION_CS                           0x01
//   #define CALL_DSAC_INFO                                     0x38
//   #define CALL_DSAC_INFO_OFFSET_SUBBLOCKID                   0 //size 1 byte(s)
//   #define CALL_DSAC_INFO_OFFSET_SUBBLOCKLEN                  1 //size 1 byte(s)
//   #define CALL_DSAC_INFO_OFFSET_DSACRESTR                    2 //size 1 byte(s)
//   #define CALL_DSAC_INFO_OFFSET_FILLERBYTE1                  3 //size 1 byte(s)
//   #define SIZE_CALL_DSAC_INFO                                4
//
// Script description:
//
// - This test case is created for SUB 417-1807: NokiaTSY: UI needed for DCM DSAC.
//   Test case simulates the situation, where call is terminated
//   because of barred CS network (Domain Specific Access Control)
//
[Test]
title MOD_0003_032_2_NokiaTSY_[XML Call terminated, barred network (DSAC)]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallGetMobileCallInfo
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange

// Set parameter check ON and test case number
test SetVoiceParameterCheck ON 32
// Reference parameters to be checked:
// call ID, call mode ( 1 = voice ), call status ( 1 = idle )
test SetVoiceReferenceParameters 0 1 1

test RunIscTestCase 231
test SyncIscTestCase

allownextresult 0 // KErrNone
waittestclass test

allownextresult -542048258 // KErrGeneral/KErrGsmCSConnectionBarred
waittestclass test

test HandleSpecifiedRequests NO
// Set parameter check OFF and test case number ( 0 = undefined )
test SetVoiceParameterCheck OFF 0

delete test
[Endtest]


// MOD_0003_033_2_NokiaTSY_[XML Call not allowed because of FDN]
//
// Precondition:
// - N/A
//
// Script description:
//
// - This test case is created for TSW error KVAN-7L2DCY:
//   Wrong error code in dial() when FDN is set on
//   Test case simulates the situation, where call is created but
//   it is not allowed because of active FDN
//
[Test]
title MOD_0003_033_2_NokiaTSY_[XML Call not allowed because of FDN]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallGetMobileCallInfo
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange

// Set parameter check ON and test case number
test SetVoiceParameterCheck ON 33
// Reference parameters to be checked:
// call ID, call mode ( 1 = voice ), call status ( 1 = idle )
test SetVoiceReferenceParameters 1 1 1

test RunIscTestCase 232
test SyncIscTestCase

test CallDial 0 0 0 1 0 0 1 0000 0 1 1 +3582722990

allownextresult 0 // KErrNone
waittestclass test

allownextresult -528482325 // KErrAccessDenied/KErrGsmInvalidFdn
waittestclass test

test HandleSpecifiedRequests NO
// Set parameter check OFF and test case number ( 0 = undefined )
test SetVoiceParameterCheck OFF 0

delete test
[Endtest]

// MOD_0003_040_2_NokiaTSY_[XML Call Life Timer query and update]
//
// Precondition:
// - N/A
//
// Script description:
//
// - Call timer is read from PMM during boot and read with ECustomGetLifeTimeIPC,
//   updated with EIPCUpdateNewLifeTimerValue and read again.
//
// Reference:SUB 417-232 NokiaTSY: Changing the life timer functionality
//

[Test]
title MOD_0003_040_2_NokiaTSY_[XML Call Life Timer query and update]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC ECustomGetLifeTimeIPC
test SetExpectedCompleteIPC EMmTsyUpdateLifeTimeIPC
test SetExpectedCompleteIPC ECustomGetLifeTimeIPC

test RunIscTestCaseStartNTSYAfterTestToolStart 233
test SyncIscTestCaseStartNTSYAfterTestToolStart

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

//  The currect time got during boot from PMM is 23356 hours 14 minutes
test GetLifeTimer 23356 13

// ECustomGetLifeTimeIPC
allownextresult 0
waittestclass test

test RunIscTestCase 240
test SyncIscTestCase

// Update timer 25 seconds
test UpdateLifeTimer 25

// EMmTsyUpdateLifeTimeIPC
allownextresult 0
waittestclass test

test GetLifeTimer 23356 14

// ECustomGetLifeTimeIPC
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test

[Endtest]

// MOD_0003_041_2_NokiaTSY_[XML Call Life Timer - Repeat read during boot - Try write - Try get timer value]
//
// Precondition:
// - N/A
//
// Script description:
//
// - Call timer is read from PMM during boot 3 times and reading is not
//   successful. Then timer value is tried to be written and read.
//
// Reference:SUB 417-232 NokiaTSY: Changing the life timer functionality
//
//
[Test]
title MOD_0003_041_2_NokiaTSY_[XML Call Life Timer - Repeat read during boot - Try write - Try get timer value]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC ECustomGetLifeTimeIPC

test RunIscTestCaseStartNTSYAfterTestToolStart 234
test SyncIscTestCaseStartNTSYAfterTestToolStart

// wait for ISC testcase completion signal
allownextresult 1
waittestclass test

// Try to update timer 25 seconds
test UpdateLifeTimer 25

// EMmTsyUpdateLifeTimeIPC / KErrNotReady returned
allownextresult -18
waittestclass test

// No values given, because there is nothing to be read.
test GetLifeTimer

// ECustomGetLifeTimeIPC / KErrNotReady returned
allownextresult -18
waittestclass test

test HandleSpecifiedRequests NO

delete test

[Endtest]

// MOD_0003_042_2_NokiaTSY_[XML Call Life Timer - Error occurred during writing to PMM]
//
// Precondition:
// - N/A
//
// Script description:
//
// - Call timer has been read from PMM succesfully, but PMM Server indicates
//   incorrect status when it sends response for write request.
//
// Reference:SUB 417-232 NokiaTSY: Changing the life timer functionality
//
//
[Test]
title MOD_0003_042_2_NokiaTSY_[XML Call Life Timer - Error occurred during writing to PMM]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMmTsyUpdateLifeTimeIPC

test RunIscTestCaseStartNTSYAfterTestToolStart 235
test SyncIscTestCaseStartNTSYAfterTestToolStart

// Pause is needed to receive 1st response (PMM Read Response, because it's
// request has been send during boot and that request is not able to be
// intercepted by isc test case.
pause 2000

// Try to update timer 25 seconds
test UpdateLifeTimer 25

// EMmTsyUpdateLifeTimeIPC / KErrNotReady returned
allownextresult -18
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0003_050_2_NokiaTSY_[XML MO call - Send DTMF string containing 'w' character]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_050_2_NokiaTSY_[XML MO call - Send DTMF string containing 'w' character]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EMobilePhoneNotifyDTMFEvent // active
test SetExpectedCompleteIPC EMobilePhoneNotifyStopInDTMFString
test SetExpectedCompleteIPC EMobilePhoneNotifyDTMFEvent // Idle
test SetExpectedCompleteIPC EMobilePhoneNotifyDTMFEvent // active
test SetExpectedCompleteIPC EMobilePhoneSendDTMFTones
test SetExpectedCompleteIPC EMobilePhoneNotifyDTMFEvent // idle

test SetVoiceParameterCheck ON 50
// Reference parameters to be checked:
// DTMF string after 'w' character
test SetVoiceReferenceParameters 21254

test RunIscTestCase 236
test SyncIscTestCase

test CallDial 1 0 0 1 0 0 1 0000 0 1 1 0504804405

//EMobileCallNotifyMobileCallStatusChange create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

print Answer the call --->
//EMobileCallNotifyMobileCallStatusChange active
allownextresult 0
waittestclass test

print Sending DTMF tones
test SendDTMFTones 1212w21254

print DTMF sending ongoing...
//EMobilePhoneNotifyDTMFEvent active
allownextresult 0
waittestclass test

//EMobilePhoneNotifyStopInDTMFString
allownextresult 0
waittestclass test

print DTMF sending stopped for 'w' character
//EMobilePhoneNotifyDTMFEvent idle
allownextresult 0
waittestclass test

print Sending DTMF tones after 'w' character
test ContinueSendDTMFTones 21254

print Continue DTMF sending...
//EMobilePhoneNotifyDTMFEvent active
allownextresult 0
waittestclass test

//EMobilePhoneSendDTMFTones
allownextresult 0
waittestclass test

print DTMF sending done
//EMobilePhoneNotifyDTMFEvent idle
allownextresult 0
waittestclass test

print HangUp ongoing call
test CallHangUp 1 //CallId

test HandleSpecifiedRequests NO
test SetVoiceParameterCheck OFF 0
delete test
[Endtest]

// MOD_0003_060_2_NokiaTSY_[XML MO Video call connects - terminated by local user with valid values]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0504804405=TelNum
//
[Test]
title MOD_0003_060_2_NokiaTSY_[XML MO Video call connects - terminated by local user with valid values]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EEtelCallDial                           // connected
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo release
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //idle

test RunIscTestCase 237
test SyncIscTestCase

test VideoCallDial 1 0 0 1 0 0 1 0000 0 1 1 0504804405

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

print Answer the call --->

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange
allownextresult 0
waittestclass test

//EEtelCallDial
allownextresult 0
waittestclass test

test VideoCallHangUp 1 //CallId

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

allownextresult -8071 //KErrGsmReleaseByUser
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0003_061_2_NokiaTSY_[XML MO video call connects - remote party rejects call]
//
// Precondition:
// - n/a
//
// Script description:
// - Parameters for the case:
// 1. 1=CallID
// 2. 0=EMonitorSpeakerControlAlwaysOff,
// 3. 0=EMonitorSpeakerVolumeOff
// 4. 1=0x01(interval)
// 5. 0=EDialToneWait
// 6. 0=EIdRestrictDefault
// 7. 1=true(ExplicitInvoke)
// 8. 0000=0x0000(CugIndex)
// 9. 0=false(SuppressOA)
// 10. 1=true(SuppressPrefCug)
// 11. 1=true(AutoRedial)
// 12. 0501122334=TelNum
//
[Test]
title MOD_0003_061_2_NokiaTSY_[XML MO video call connects - remote party rejects call]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //create
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo alerting
test SetExpectedCompleteIPC ECustomGetRemoteAlertingToneStatusIPC
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EEtelCallDial                           // connected
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mt release
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //idle

test RunIscTestCase 238
test SyncIscTestCase

test VideoCallDial 1 0 0 1 0 0 1 0000 0 1 1 0504804405

//EMobileCallNotifyMobileCallStatusChange create
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange mo alerting
allownextresult 0
waittestclass test

//ECustomGetRemoteAlertingToneStatusIPC
allownextresult 0
waittestclass test

print Answer the call --->

//EMobileCallNotifyMobileCallStatusChange active
allownextresult 0
waittestclass test

//EEtelCallDial
allownextresult 0
waittestclass test

print Reject the call

test RemotePartyHangUp

//EMobileCallNotifyMobileCallStatusChange mt release
allownextresult -280887298 //Symbian OS error
waittestclass test

//EMobileCallNotifyMobileCallStatusChange idle
allownextresult -280887298 //Symbian OS error
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0003_062_2_NokiaTSY_[XML MT Video call connects - terminated by local user with valid values]
// Make incoming Video call to the test phone
//
// Precondition:
// - n/a
//
// Script description:
// - n/a
//
[Test]
title MOD_0003_062_2_NokiaTSY_[XML Incoming video call while there are no other calls]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mt alerting
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //active
test SetExpectedCompleteIPC EEtelCallAnswer                         // answered
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mo release
test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //idle

test RunIscTestCase 239
test SyncIscTestCase

test TestIncomingCall 1

//EMobileCallNotifyMobileCallStatusChange mt alerting
allownextresult 0
waittestclass test

//EMobileCallNotifyMobileCallStatusChange active
allownextresult 0
waittestclass test

//EEtelCallAnswer
allownextresult 0
waittestclass test

test VideoCallHangUp 1 //CallId

//EMobileCallNotifyMobileCallStatusChange mo release
allownextresult -8071 //KErrGsmReleaseByUser
waittestclass test

//EMobileCallNotifyMobileCallStatusChange idle
allownextresult -280887298
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]

// MOD_0003_063_2_NokiaTSY_[XML MT Video call alerts]
// Check EMobileCallNotifyMobileCallStatusChange is completed when MT video call
// starts to alert
//
// Precondition:
// - n/a
//
// Script description:
// - n/a
//
[Test]
title MOD_0003_063_2_NokiaTSY_[XML MT Video call alerts]
create NTT_Voice test

test HandleSpecifiedRequests YES
test InitializeIPCRequestTable

test SetExpectedCompleteIPC EMobileCallNotifyMobileCallStatusChange //mt alerting

test RunIscTestCase 241
test SyncIscTestCase

//EMobileCallNotifyMobileCallStatusChange mt alerting
allownextresult 0
waittestclass test

test HandleSpecifiedRequests NO

delete test
[Endtest]
