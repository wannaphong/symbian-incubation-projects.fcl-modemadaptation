<?xml version="1.0" encoding="utf-8" ?>
<isc-test-control id="1">



  <!-- Channels that are opened during startup and closed when test environment exits -->
  <channels>
  </channels>

  <!-- Test inputs are declared here -->
  <inputs>

     <input id="4001">
      <name>SMS_CB_ROUTING_RESP (activate)</name>
      <direction>sos</direction>
      <message>00,00,00,02,06,00,00,00,01,35,01,00,01,00,00,00</message>
    </input>

     <input id="4002">
      <name>SMS_CB_ROUTING_RESP (deactivate)</name>
      <direction>sos</direction>
      <message>00,00,00,02,06,00,00,00,02,35,01,00,00,00,00,00</message>
    </input>

    <input id="4010">
      <name>SMS_CB_ROUTING_IND(GSM CB message)</name>
      <direction>sos</direction>
      <message>00,00,00,02,62,00,77,3F,01,36,00,01,00,0E,00,60,40,00,00,65,01,2A,FF,68,3A,1D,AE,7B,BD,EE,F7,BB,CB,FD,5E,A7,C3,AE,F1,BB,DD,50,80,40,20,10,08,04,02,81,40,20,10,08,04,02,81,40,20,10,08,04,02,81,40,20,10,08,04,02,81,40,20,10,08,04,02,81,40,20,10,08,04,02,81,40,20,10,08,04,02,81,40,20,10,08,04,02,81,40,20,10,08,04,02,00,00,00</message>
    </input>

    <input id="4011">
      <name>SMS_CB_ROUTING_IND(UMTS CB message)</name>
      <direction>sos</direction>
      <message>00,00,00,02,62,00,77,3F,01,36,00,01,00,0E,00,60,40,00,00,22,00,11,21,C3,32,9B,0D,12,CA,DF,61,F2,38,3C,A7,83,40,F4,F2,9C,0E,6A,97,E7,F3,F0,B9,0C,A2,BE,E1,E9,31,68,46,6B,34,1A,8D,46,A3,D1,68,34,1A,8D,46,A3,D1,68,34,1A,8D,46,A3,D1,68,34,1A,8D,46,A3,D1,68,34,1A,8D,46,A3,D1,68,34,1A,8D,46,A3,D1,68,34,1A,8D,46,A3,
      D1,00,00,00,00</message>
    </input>

    <input id="4021">
      <name>Send SIM_GSM_DIR_REQ.UPDATE_CB_MSGIDS to CellMo</name>
      <direction>dos</direction>
      <message>1e,00,10,09,00,24,00,01,00,3f,69,00,00,7b,01,c8,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff</message>
    </input>

    <input id="4252">
      <name>SIM_DATA_SIZES_RESP.READ_CB_MSG_ID_CNT</name>
      <direction>sos</direction>
      <message>1E,10,00,09,00,07,08,34,00,24,25,01,0A</message>
    </input>

   <input id="4254">
      <name>SIM_GSM_DIR_RESP.READ_CB_MSG_IDS (123, 456)</name>
      <direction>sos</direction>
      <message>1E,10,00,09,00,24,08,34,00,40,48,01,00,7B,01,C8,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,00,00,00,00,00,00,00,00,00,00</message>
    </input>

   <input id="4256">
      <name>SIM_GSM_DIR_RESP.READ_CB_MSG_IDS (456)</name>
      <direction>sos</direction>
      <message>1E,10,00,09,00,24,08,34,00,40,48,01,01,C8,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,00,00,00,00,00,00,00,00,00,00</message>
    </input>

    <input id="4258">
      <name>SIM_DATA_SIZES_RESP.READ_CB_MSG_ID_CNT</name>
      <direction>sos</direction>
      <message>1E,10,00,09,00,07,08,34,01,24,25,01,0A</message>
    </input>

   <input id="4260">
      <name>SIM_GSM_DIR_RESP.READ_CB_MSG_IDS (123, 456)</name>
      <direction>sos</direction>
      <message>1E,10,00,09,00,24,08,34,01,40,48,01,00,7B,01,C8,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,00,00,00,00,00,00,00,00,00,00</message>
    </input>

   <input id="4262">
      <name>UPDATE_CB_MSGIDS</name>
      <direction>sos</direction>
      <message>1E,10,00,09,00,06,08,34,01,40,69,01</message>
    </input>


 </inputs>


  <!-- Test outputs are declared here -->

  <outputs>

   <output id="4501">
     <name>SMS_CB_ROUTING_REQ (activate)</name>
     <direction>dos</direction>
     <message>00,00,00,02,00,0a,00,00,01,34,01,00,00,00,00,00</message>
     <mask   >00,00,00,ff,00,00,00,00,ff,ff,ff,ff,ff,ff,ff,ff</mask>
   </output>

   <output id="4502">
     <name>SMS_CB_ROUTING_REQ (deactivate)</name>
     <direction>dos</direction>
     <message>00,00,00,02,00,0a,00,00,02,34,00,00,00,00,00,00</message>
     <mask   >00,00,00,ff,00,00,00,00,ff,ff,ff,ff,ff,ff,ff,ff</mask>
   </output>

   <output id="4251">
     <name>SIM_DATA_SIZES_REQ.READ_CB_MSG_ID_CNT</name>
     <direction>dos</direction>
     <message>00,00,00,09,00,05,00,00,00,23,25</message>
     <mask   >00,00,00,ff,00,00,00,00,ff,ff,ff</mask>
   </output>

   <output id="4253">
     <name>SIM_GSM_DIR_REQ.READ_CB_MSG_IDS</name>
     <direction>dos</direction>
     <message>00,00,00,09,00,06,00,00,00,3F,48,00</message>
     <mask   >00,00,00,ff,00,00,00,00,ff,ff,ff,ff</mask>
   </output>

   <output id="4257">
     <name>SIM_DATA_SIZES_REQ.READ_CB_MSG_ID_CNT (delete)</name>
     <direction>dos</direction>
     <message>00,00,00,09,00,05,00,00,01,23,25</message>
     <mask   >00,00,00,ff,00,00,00,00,ff,ff,ff</mask>
   </output>

   <output id="4259">
     <name>SIM_GSM_DIR_REQ.READ_CB_MSG_IDS (delete)</name>
     <direction>dos</direction>
     <message>00,00,00,09,00,06,00,00,01,3F,48,00</message>
     <mask   >00,00,00,ff,00,00,00,00,ff,ff,ff,ff</mask>
   </output>

   <output id="4261">
     <name>SIM_GSM_DIR_REQ.UPDATE_CB_MSGIDS (delete)</name>
     <direction>dos</direction>
     <message>00,00,00,09,00,24,00,00,01,3F,69,14,01,C8,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF,FF</message>
     <mask   >00,00,00,ff,00,00,00,00,ff,ff,ff,ff,ff,ff,ff,ff,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00</mask>
   </output>

  </outputs>


  <!-- Test filters are declared here -->
  <filters>
  </filters>


  <!-- Test steps are declared here -->
  <steps>

    <step id="40501" type="intercept">
     <name>Verify SMS_CB_ROUTING_REQ (activate)</name>
      <channel id="0x07"/>
      <output-ref id="4501"/>
    </step>

    <step id="40502" type="intercept">
     <name>Verify SMS_CB_ROUTING_REQ (deactivate)</name>
      <channel id="0x07"/>
      <output-ref id="4502"/>
    </step>

    <step id="40001" type="simulate">
      <name>Simulate SMS_CB_ROUTING_RESP (activate)</name>
      <channel id="0x07"/>
      <input-ref id="4001"/>
    </step>

    <step id="40002" type="simulate">
      <name>Simulate SMS_CB_ROUTING_RESP (deactivate)</name>
      <channel id="0x07"/>
      <input-ref id="4002"/>
    </step>

   <step id="40010" type="simulate">
      <name>Simulate SMS_CB_ROUTING_IND (GSM CBS message)</name>
      <channel id="0x07"/>
      <input-ref id="4010"/>
    </step>

   <step id="40011" type="simulate">
      <name>Simulate SMS_CB_ROUTING_IND (UMTS CBS message)</name>
      <channel id="0x07"/>
      <input-ref id="4011"/>
    </step>

   <step id="40021" type="simulate">
      <name>Send SIM_GSM_DIR_REQ.UPDATE_CB_MSGIDS to CellMo</name>
      <channel id="0x07"/>
      <input-ref id="4021"/>
    </step>


    <step id="40251" type="intercept">
     <name>Verify SIM_DATA_SIZES_REQ.READ_CB_MSG_ID_CNT</name>
      <channel id="0x07"/>
      <output-ref id="4251"/>
    </step>

    <step id="40252" type="simulate">
      <name>Simulate SIM_DATA_SIZES_RESP.READ_CB_MSG_ID_CNT</name>
      <channel id="0x07"/>
      <input-ref id="4252"/>
    </step>

    <step id="40253" type="intercept">
     <name>Verify SIM_GSM_DIR_REQ.READ_CB_MSG_IDS</name>
      <channel id="0x07"/>
      <output-ref id="4253"/>
    </step>

    <step id="40254" type="simulate">
      <name>Simulate SIM_GSM_DIR_RESP.READ_CB_MSG_IDS (123, 456)</name>
      <channel id="0x07"/>
      <input-ref id="4254"/>
    </step>

    <!-- 40255 == 40253 -->

    <step id="40256" type="simulate">
      <name>Simulate SIM_GSM_DIR_RESP.READ_CB_MSG_IDS (456)</name>
      <channel id="0x07"/>
      <input-ref id="4256"/>
    </step>

    <step id="40257" type="intercept">
     <name>Verify SIM_DATA_SIZES_REQ.READ_CB_MSG_ID_CNT (delete)</name>
      <channel id="0x07"/>
      <output-ref id="4257"/>
    </step>

    <step id="40258" type="simulate">
      <name>Simulate SIM_DATA_SIZES_RESP.READ_CB_MSG_ID_CNT (delete)</name>
      <channel id="0x07"/>
      <input-ref id="4258"/>
    </step>

    <step id="40259" type="intercept">
     <name>Verify SIM_GSM_DIR_REQ.READ_CB_MSG_IDS (delete)</name>
      <channel id="0x07"/>
      <output-ref id="4259"/>
    </step>

    <step id="40260" type="simulate">
      <name>Simulate SIM_GSM_DIR_RESP.READ_CB_MSG_IDS (123, 456, delete)</name>
      <channel id="0x07"/>
      <input-ref id="4260"/>
    </step>

    <step id="40261" type="intercept">
     <name>Verify SIM_GSM_DIR_REQ.UPDATE_CB_MSGIDS (456)</name>
      <channel id="0x07"/>
      <output-ref id="4261"/>
    </step>

    <step id="40262" type="simulate">
      <name>Simulate SIM_GSM_DIR_RESP.UPDATE_CB_MSGIDS</name>
      <channel id="0x07"/>
      <input-ref id="4262"/>
    </step>

    <!-- Open channel steps are used to attach the ISC test controller to an existing ISC channel -->
    <step id="2001" type="open-channel">
      <name>Open TSY channel</name>
      <channel id="0x07"/>
    </step>

    <!-- Close channel steps are used to detach the ISC test controller from an existing ISC channel -->
    <step id="2002" type="close-channel">
      <name>Close TSY channel</name>
      <channel id="0x07"/>
    </step>

    <!-- Synchronization step is used to synchronize with -->
    <!-- the test cases of the adaptation test environment -->
    <step id="2003" type="sync">
      <name>Sync ( ignore messages )</name>
      <flags>1</flags>
    </step>

  </steps>


  <!-- Test step groups are declared here. Step groups must not have same ID's as steps -->

  <!-- Intercept steps can be grouped to receive messages in undetermined order. -->
  <groups>
  </groups>

  <!-- Test cases are declared here -->

  <!-- step-ref elements are used to reference the test steps of the test case -->
  <cases>

      <case id="401">
      <name>-- Activate CBS routing CBS TEST CASE 401 --"</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="40501"/> <!-- Verify SMS_CB_ROUTING_REQ (activate) -->
        <step-ref id="40001"/> <!-- Send SMS_CB_ROUTING_RESP -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

      <case id="402">
      <name>-- Deactivate CBS routing CBS TEST CASE 402 --"</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="40502"/> <!-- Verify SMS_CB_ROUTING_REQ (deactivate) -->
        <step-ref id="40002"/> <!-- Send SMS_CB_ROUTING_RESP -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>


    <case id="410">
      <name>--Receive GSM CBS Message CBS TEST CASE 410 --"</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="40010"/> <!-- SMS_CB_ROUTING_IND (GSM CBS message) -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

    <case id="411">
      <name>--Receive UMTS CBS Message CBS TEST CASE 411 --"</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="40011"/> <!-- SMS_CB_ROUTING_IND (UMTS CBS message) -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

    <case id="421">
      <name>-- Writes two cbmi entries to SIM. Not a real test case, just handy for preparing others. --"</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="40021"/> <!-- Send SIM_GSM_DIR_REQ.UPDATE_CB_MSGIDS -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>


    <case id="425">
      <name>-- Read CBMI, find "123" and "456" --</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="40251"/> <!-- Verify SIM_DATA_SIZES_REQ.READ_CB_MSG_ID_CNT -->
        <step-ref id="40252"/> <!-- Send SIM_DATA_SIZES_RESP.READ_CB_MSG_ID_CNT  -->
        <step-ref id="40253"/> <!-- Verify SIM_GSM_DIR_REQ.READ_CB_MSG_IDS -->
        <step-ref id="40254"/> <!-- Send SIM_GSM_DIR_RESP.READ_CB_MSG_IDS (123, 456) -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

    <case id="426">
      <name>-- Read CBMI, find "456" --</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="40251"/> <!-- Verify SIM_DATA_SIZES_REQ.READ_CB_MSG_ID_CNT -->
        <step-ref id="40252"/> <!-- Send SIM_DATA_SIZES_RESP.READ_CB_MSG_ID_CNT  -->
        <step-ref id="40253"/> <!-- Verify SIM_GSM_DIR_REQ.READ_CB_MSG_IDS -->
        <step-ref id="40256"/> <!-- Send SIM_GSM_DIR_RESP.READ_CB_MSG_IDS (456) -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

    <case id="427">
      <name>-- Delete CBMI "123", "456" remains --</name>
      <timeout>100</timeout>
      <test-steps>
        <step-ref id="2001"/>  <!-- attach to TSY channel -->
        <step-ref id="2003"/>  <!-- sync -->
        <step-ref id="40257"/> <!-- Verify SIM_DATA_SIZES_REQ.READ_CB_MSG_ID_CNT -->
        <step-ref id="40258"/> <!-- Send SIM_DATA_SIZES_RESP.READ_CB_MSG_ID_CNT  -->
        <step-ref id="40259"/> <!-- Verify SIM_GSM_DIR_REQ.READ_CB_MSG_IDS -->
        <step-ref id="40260"/> <!-- Send SIM_GSM_DIR_RESP.READ_CB_MSG_IDS (123, 456) -->
        <step-ref id="40261"/> <!-- Verify SIM_GSM_DIR_REQ.UPDATE_CB_MSGIDS (123) -->
        <step-ref id="40262"/> <!-- Send SIM_GSM_DIR_RESP.UPDATE_CB_MSGIDS -->
        <step-ref id="2002"/>  <!-- Detach from TSY channel -->
      </test-steps>
    </case>

  </cases>

</isc-test-control>
